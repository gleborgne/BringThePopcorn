{"version":3,"sources":["../scripts/winjscontrib/js/winjscontrib.core.js","../scripts/winjscontrib/js/winjscontrib.ui.webcomponents.js","../scripts/winjscontrib/js/winjscontrib.winrt.core.js","../scripts/winjscontrib/js/winjscontrib.winrt.upnp.js","../scripts/winjscontrib/js/winjscontrib.bindings.js","../scripts/winjscontrib/js/winjscontrib.date.utils.js","../scripts/winjscontrib/js/winjscontrib.ui.navigator.js","../scripts/winjscontrib/js/winjscontrib.ui.animation.js","../scripts/winjscontrib/js/winjscontrib.ui.elasticbutton.js","../scripts/winjscontrib/js/winjscontrib.ui.fowrapper.js"],"names":["_global","this","setImmediate","callback","args","_i","arguments","length","setTimeout","toStaticHTML","text","msapp","MSApp","execUnsafeLocalFunction","c","Object","map","obj","mapping","mapped","key","val","keys","forEach","transmuted","apply","String","prototype","format","replace","match","number","padLeft","leadingChar","undefined","WinJSContrib","Promise","waterfall","dataArray","promiseCallback","resultPromise","WinJS","wrap","results","dataPromise","as","then","items","queueP","p","item","r","push","i","l","getItem","parallel","promises","join","batch","batchSize","batcheditems","hasErrors","queueBatch","concat","errors","wrapError","Utils","extend","hasOwnProperty","startsWith","str","strToMatch","asyncForEach","array","batchsize","j","endsWith","queryStringFrom","encodeURIComponent","rawValue","value","hasValue","triggerEvent","element","eventName","bubbles","cancellable","eventToTrigger","document","createEvent","initEvent","dispatchEvent","triggerCustomEvent","data","initCustomEvent","getobject","prop","baseValue","idx","indexOf","end","substr","parseInt","setobject","setProperty","intval","readProperty","source","properties","getProperty","propValue","split","parent","previousDescriptor","descriptor","PropertyDescriptor","writeProperty","randomFromInterval","from","to","Math","random","alphabeticSort","a","b","distinctArray","property","ignorecase","sFind","sMatchedItems","foundCounter","newArray","toLowerCase","getDistinctPropertyValues","removeAccents","s","RegExp","removePageFromHistory","pageLoc","history","Navigation","backStack","page","location","pad2","ellipsisizeString","maxSize","useWordBoundary","toLong","text_","lastIndexOf","guid","d","Date","getTime","uuid","floor","toString","inherit","parentElement","current","winControl","moveChilds","target","childs","childNodes","elt","appendChild","getParent","parentNode","getParentControlByClass","className","classList","contains","getParentPage","getScopeControl","msParentSelectorScope","scope","scopeControl","getTemplate","template","templatetype","Binding","Template","href","render","res","resolveMethod","resolveValue","readValue","context","name","parser","ValueParsers","applyValue","targetPath","tmp","mcnMustResolve","formatXHRError","xhr","status","statusText","responseText","unwrapJoinError","errorCallback","errorArray","unwrappedError","tentativeError","inject","k","parentDescriptor","keyProp","ensureParent","defineProperty","get","set","enumerable","configurable","navpage","control","UI","Application","navigator","pageControl","parentControl","method","bind","ctrl","select","selector","querySelector","optionsParser","window","Utilities","markSupportedForProcessing","prom","list","List","dataSource","global","templ","Templates","event","eventTracker","addEvent","addEventListener","uri","cache","interactive","makeInteractive","message","itemPromise","rendered","tap","n","arg","click","onclick","offsetFrom","xPosition","yPosition","w","clientWidth","h","clientHeight","offsetLeft","scrollLeft","clientLeft","offsetTop","scrollTop","clientTop","offsetParent","x","y","width","height","appbarsOpen","querySelectorAll","e","show","appbarsClose","hide","appbarsDisable","disabled","appbarsEnable","elements","el","elementLoaded","url","complete","error","onerror","onload","onreadystatechange","naturalWidth","src","loadImage","imgUrl","image","path","Image","listElementsAfterMe","passed","children","removeElementAnimation","remainings","anim","Animation","createDeleteFromListAnimation","style","position","opacity","execute","done","bindAction","add","actionName","dataset","pageAction","getAttribute","action","options","pageActionOptions","exception","eltarg","actionArgs","pageActionArgs","bindPageActions","bindLink","applink","pageLink","parentNavigator","nav","navigate","bindPageLinks","mcnNavigator","bindMember","memberName","pageMember","id","bindMembers","bindActions","registerNavigationEvents","cancelNavigation","detail","setPromise","cancel","registration","registeredNavigationStack","backhandler","handled","Windows","Phone","Input","HardwareButtons","keypress","body","addLock","removeLock","splice","removeEventListener","untap","mcnTapTracking","dispose","untapAll","taps","ptDown","currentTarget","tracking","button","allowRickClickTap","lock","pointerId","setPointerCapture","stopPropagation","preventDefault","addClass","pointerdown","changedTouches","clientX","clientY","animDown","tapOnDown","ptOut","removeClass","releasePointerCapture","console","disableAnimation","animUp","ptUp","resolveTap","dX","abs","dY","stopImmediatePropagation","is","awaitAnim","opt","EventTracker","pointerDown","pointerUp","pointerModel","onpointerdown","Touch","noWebkitTouch","cancelMouse","afterTransition","timeout","timeOutRef","onaftertransition","srcElement","close","clearTimeout","disableAutoResources","events","handler","capture","tracker","unregister","addBinding","unbind","MediaTrigger","linkedControl","queries","query","registerMediaEvent","q","mq","matchMedia","internalQuery","f","matches","_mediaEvent","addListener","removeListener","setOptions","check","type","listener","useCapture","eventProperties","Class","mix","eventMixin","FluentDOM","nodeType","parentElt","createElement","fragment","createDocumentFragment","classname","display","visibility","textContent","html","innerHTML","attr","setAttribute","styles","st","appendTo","append","child","createChild","ctor","__global","profiler","msWriteProfilerMark","Pages","broadcast","before","after","index","childctrl","pageLifeCycle","steps","layout","promise","__checkLayout","renderFragment","container","preparePageControl","elementCtrl","injectToPage","navigationState","state","oncreate","oninit","init","attach","enterPageAnimation","enterPage","_enterAnimation","elts","getAnimationElements","onrender","process","Resources","processAll","closeOldPagePromise","ready","onready","fragmentCompleted","fragmentError","getComputedStyle","direction","fragmentPromise","parented","pageConstructor","defaultFragmentMixins","$","_element","qAll","slice","call","_promises","cancelPromises","addPromise","_eventTracker","PageLifeCycleStep","stepName","_this","queue","isDone","_resolvePromise","_rejectPromise","resolve","closeStep","step","reject","_Pages","_Global","_Base","_CorePages","_BaseUtils","_ElementUtilities","_WriteProfilerMark","Fragments","ControlProcessor","selfhost","injectMixin","base","mixin","mergeJavaScriptClass","baseCtor","classDef","addMembers","members","_attachedConstructor","that","parentedPromise","initialDisplay","profilerMarkIdentifier","_getProfilerMarkIdentifier","WebComponents","observer","watch","load","loadResult","realControl","dismissed","renderCalled","initResult","result","elementReady","renderComplete","processed","callComplete","layoutComplete","getBoundingClientRect","pageLayout","readyComplete","ended","delta","created","log","err","_value","updateLayoutArgs","updateLayout","getPageConstructor","refUri","viewMap","define","stop","disconnect","_disposed","msSourceLocation","parentedComplete","_mixinBase","DOMEventMixin","Pages_define","_viewMap","_corePages","Ctor","remove","clearCache","disposeSubTree","renderCopy","_remove","pageOverride","Namespace","_moduleDefine","HtmlControl","inspect","node","customElement","ctrlName","nodeName","attributes","registered","toUpperCase","mcnComponent","observeMutations","polyfill","MutationObserver","mutations","mutation","addedNodes","observe","childList","subtree","definition","getControlInstance","constructor","mcnWebComponent","ctx","applyAttribute","winOptions","getWinJSOptions","optionsCallback","applyAll","applyMapping","tagname","contextData","attrcontext","attrvalue","attribute","controls","ctKey","controlDefinition","mapKey","controlmap","registerElement","register","override","existing","proto","create","HTMLElement","createdCallback","attachedCallback","attributeChangedCallback","attrName","oldValue","newValue","AppBar","AutoSuggestBox","BackButton","ContentDialog","DatePicker","FlipView","Flyout","Hub","HubSection","ItemContainer","ListView","Menu","Pivot","PivotItem","Rating","Repeater","SearchBox","SemanticZoom","SplitView","TimePicker","ToggleSwitch","ToolBar","Tooltip","ViewBox","WinRT","readProtocol","kind","ApplicationModel","Activation","ActivationKind","protocol","navArgs","protocolArgs","queryargs","decodeURIComponent","host","isConnected","nlvl","Networking","Connectivity","NetworkConnectivityLevel","profile","NetworkInformation","getInternetConnectionProfile","level","getNetworkConnectivityLevel","constrainedInternetAccess","internetAccess","hasInternetAccess","onInternetStatusChanged","network","Alerts","messageBox","md","Popups","MessageDialog","content","title","commands","command","cmd","UICommand","label","invoked","isDefault","defaultCommandIndex","showAsync","notification","confirm","yes","no","toastNotification","notifications","Notifications","picture","ToastTemplateType","toastImageAndText01","toastText01","toastXml","ToastNotificationManager","getTemplateContent","toastTextElements","getElementsByTagName","toastImageElements","launch","toastElements","JSON","stringify","createTextNode","text2","text3","toast","ToastNotification","toastNotifier","createToastNotifier","UPnP","search","xmlToJson","xml","nodeValue","hasChildNodes","colonIdx","clearNode","old","trim","parseXML","DOMParser","parseFromString","toHex","start","digit","hextab","pad","len","ntos","unescape","htoa","nextchar","charAt","atoh","charCodeAt","expandExponential","z","Array","deviceTypes","ContentDirectory1","ContentDirectory2","ContentDirectory3","ContentDirectory4","MediaRenderer1","MediaRenderer2","MediaRenderer3","MediaRenderer4","MediaServer1","MediaServer2","MediaServer3","MediaServer4","AVTransport1","AVTransport2","ConnectionManager1","ConnectionManager2","ConnectionManager3","devicesDiscovery","filter","exists","devices","deviceDescriptionUrl","discover","onsuccess","clientSocket","ex","Sockets","DatagramSocket","onmessagereceived","reader","getDataReader","count","unconsumedBufferLength","readString","completed","rawdevice","responseXML","device","root","rootUrl","UPnPDevice","getOutputStreamAsync","hostName","outputStream","writer","Storage","Streams","DataWriter","unicodeEncoding","UnicodeEncoding","Utf8","writeString","storeAsync","discovery","hasError","HostName","getContentType","extension","lowerUrl","deviceObj","getService","serviceType","service","serviceList","deviceList","childdevice","childService","controlURL","getAVTransport","UPnPAVTransport","getContentDirectory","UPnPContentDirectory","getConnectionManager","UPnPConnectionManager","UPnPService","serviceObj","opts","debug","svc","svcType","svcUrl","self","upnpAction","upnpParameters","promiseComplete","promiseError","response","svcMsg","createRequest","sendRequest","xmlResponse","handleResponse","upnpResponse","requestTemplate","types","i1","allowedValues","toNative","i8","Int8Array","checkAllowedValues","i2","i16","Int16Array","i4","i32","Int32Array","ui1","ui8","Uint8Array","ui2","ui16","Uint16Array","ui4","ui32","Uint32Array","int","isNaN","r4","f32","Float32Array","r8","f64","Float64Array","fixed_14_4","float","_float","parseFloat","char","string","xmlObj","currentPos","date","dateTime","parseDate","toISOString","dateTime_tz","time","time_tz","boolean","bin_base64","atob","btoa","bin_hex","decodeURI","_name","upnpServiceType","upnpActionName","parameters","formatParameters","debugLog","encodeXML","svcInParams","svcInParams_xml","svcParam","typeCheck","upnpEndpointURL","upnpRequestXML","onUPnPResponse","soapaction","httpClient","Web","Http","HttpClient","Foundation","Uri","request","HttpRequestMessage","HttpMethod","post","headers","HttpStringContent","utf8","sendRequestAsync","readAsStringAsync","UPnPError","upnpResponseXML","onUPnPResolved","svcOutParams","responseJSON","responseContainer","responseVars","varName","varVal","firstChild","decodeXML","formatParameter","parameter","param","processParam","allowedValueList","matchFound","msg","description","b64chars","b64tab","bin","t","cb_encode","ccc","padlen","ord","chars","cb_decode","cccc","fromCharCode","hexChars","timestamp","struct","minutesOffset","numericKeys","exec","UTC","parse","NaN","allowedContentDirectoryTypes","urn:schemas-upnp-org:service:ContentDirectory:1","urn:schemas-upnp-org:service:ContentDirectory:2","urn:schemas-upnp-org:service:ContentDirectory:3","urn:schemas-upnp-org:service:ContentDirectory:4","upnpType","getSystemUpdateId","Id","getSearchCapabilities","SearchCaps","getSortCapabilities","SortCaps","browse","objectId","browseFlag","startingIndex","requestedCount","sortCriteria","ObjectID","BrowseFlag","Filter","StartingIndex","RequestedCount","SortCriteria","Result","NumberReturned","TotalMatches","UpdateID","allowedConnectionManagerTypes","urn:schemas-upnp-org:service:ConnectionManager:1","urn:schemas-upnp-org:service:ConnectionManager:2","urn:schemas-upnp-org:service:ConnectionManager:3","getCurrentConnectionIDs","ConnectionIDs","getCurrentConnectionInfo","connectionId","ConnectionID","RcsID","AVTransportID","ProtocolInfo","PeerConnectionManager","PeerConnectionID","Direction","Status","getProtocolInfo","Source","Sink","allowedAVTransportTypes","urn:schemas-upnp-org:service:AVTransport:1","urn:schemas-upnp-org:service:AVTransport:2","getDeviceCapabilities","instanceId","InstanceID","PlayMedia","RecMedia","RecQualityModes","getMediaInfo","NrTracks","MediaDuration","CurrentURI","CurrentURIMetaData","NextURI","NextURIMetaData","PlayMedium","RecordMedium","WriteStatus","getPositionInfo","Track","TrackDuration","TrackMetaData","TrackURI","RelTime","AbsTime","RelCount","AbsCount","getTransportInfo","CurrentTransportState","CurrentTransportStatus","CurrentSpeed","getTransportSettings","PlayMode","RecQualityMode","setAVTransportURI","currentURI","currentURIMetaData","play","speed","Speed","pause","next","previous","seek","unit","Unit","Target","allowedRenderingControlTypes","urn:schemas-upnp-org:service:RenderingControl:1","urn:schemas-upnp-org:service:RenderingControl:2","urn:schemas-upnp-org:service:RenderingControl:3","UPnPRenderingControl","listPresets","InstanceId","CurrentPresetNameList","selectPreset","presetName","PresetName","getBrightness","CurrentBrightness","setBrightness","desiredBrightness","DesiredBrightness","getContrast","CurrentContrast","setContrast","desiredContrast","DesiredContrast","getSharpness","CurrentSharpness","setSharpness","desiredSharpness","DesiredSharpness","getRedVideoGain","CurrentRedVideoGain","setRedVideoGain","desiredRedVideoGain","DesiredRedVideoGain","getGreenVideoGain","CurrentGreenVideoGain","setGreenVideoGain","desiredGreenVideoGain","DesiredGreenVideoGain","getBlueVideoGain","CurrentBlueVideoGain","setBlueVideoGain","desiredBlueVideoGain","DesiredBlueVideoGain","getRedVideoBlackLevel","CurrentRedVideoBlackLevel","setRedVideoBlackLevel","desiredRedVideoBlackLevel","DesiredRedVideoBlackLevel","getGreenVideoBlackLevel","CurrentGreenVideoBlackLevel","setGreenVideoBlackLevel","desiredGreenVideoBlackLevel","DesiredGreenVideoBlackLevel","getBlueVideoBlackLevel","CurrentBlueVideoBlackLevel","setBlueVideoBlackLevel","desiredBlueVideoBlackLevel","DesiredBlueVideoBlackLevel","getColorTemperature","CurrentColorTemperature","setColorTemperature","desiredColorTemperature","DesiredColorTemperature","getHorizontalKeystone","CurrentHorizontalKeystone","setHorizontalKeystone","desiredHorizontalKeystone","DesiredHorizontalKeystone","getVerticalKeystone","CurrentVerticalKeystone","setVerticalKeystone","desiredVerticalKeystone","DesiredVerticalKeystone","getMute","channel","Channel","CurrentMute","setMute","desiredMute","DesiredMute","getVolume","CurrentVolume","setVolume","desiredVolume","DesiredVolume","getVolumeDB","setVolumeDB","getVolumeDBRange","MinValue","MaxValue","getLoudness","CurrentLoudness","setLoudness","desiredLoudness","DesiredLoudness","getStateVariables","stateVariableList","StateVariableList","StateVariableValuePairs","setStateVariables","renderingControlUDN","serviceId","stateVariableValuePairs","RenderingControlUDN","ServiceType","ServiceId","getAllowedTransforms","CurrentAllowedTransformSettings","getTransforms","CurrentTransformValues","setTransforms","desiredTransformValues","DesiredTransformValues","getAllAvailableTransforms","AllAllowedTransformSettings","getAllowedDefaultTransforms","AllowedDefaultTransformSettings","getDefaultTransforms","CurrentDefaultTransformSettings","setDefaultTransforms","desiredDefaultTransformSettings","DesiredDefaultTransformSettings","Bindings","_setPic","dest","backgroundImage","pictureUnavailable","bindingArguments","argname","_optionsParser","winBindArgs","removeHTML","initializer","sourceProperty","destProperty","oneTime","innerText","removeHTMLAndEllipsisize","textRes","size","staticHTML","dataAttr","setClass","newval","oldval","bindingDesc","asClass","toBgImage","setImage","ToRealDate","toLocaleDateString","toSmartBgImage","showIf","setVisibility","hideIfNot","hideIfNotDefined","hideIf","showIfNot","showIfNotDefined","enableIf","disableIfNot","disableIf","enableIfNot","toWidth","setWidth","ellipsisize","sourcedata","toEllipsisized","emptyIfNull","twoWayOnChange","setVal","getVal","cleanUpBindingList","bindingList","unwrappedItem","unwrap","daysSince","m","myDate","yourDate","secondsInADay","diff","formatDate","setDate","moment","calendar","daysSinceDate","getMonth","getDate","getFullYear","fromdate","humanizeDate","addSuffix","duration","humanize","appView","ViewManagement","ApplicationView","defaultExitPageAnimation","exitPage","defaultEnterPageAnimation","PageControlNavigator","delay","disableHistory","animationWaitForPreviousPageClose","animations","locks","exitPageAnimation","home","_lastViewstate","onkeyup","_keyupHandler","onkeypress","_keypressHandler","onmspointerup","_mspointerupHandler","_beforeNavigate","_navigated","systemNavigationManager","enableSystemBackButton","Core","SystemNavigationManager","getForCurrentView","canGoBack","back","navigationEvents","addNavigationEvents","_history","backstack","resizeHandler","cancelAnimationFrame","requestAnimationFrame","_resized","_lastNavigationPromise","pageElement","_pageElement","lastElementChild","_createPageElement","removeNavigationEvents","_checkBackNavigation","currentPage","canClose","_getAnimationElements","isExit","altKey","forward","initialState","skipHistory","isback","pagePromise","clearHistory","closeAllPages","pages","removeChild","clear","open","pick","navigateStacked","distance","pageindex","previousPage","openStacked","stackNavigation","completeCallback","triggerPageExit","mcnNavigationDetails","exitPagePromise","hidepage","exitPageResult","layoutCtrls","progress","closePage","pageElementToClose","oldElement","oldPageExitPromise","youpla","stackedOn","stackedBy","unload","appViewBackButtonVisibility","AppViewBackButtonVisibility","visible","collapsed","pagecontainer","oldPage","currentPageDetails","openNewPagePromise","mcnPage","clearNavigationHistory","_updateBackButton","layoutProcess","vw","_handleBack","backButtons","clearNav","btn","ENTERPAGEANIMATION","EXITPAGEANIMATION","getOpt","fadeOut","staggerDelay","itemdelay","maxdelay","timing","easing","executeTransition","fadeIn","initialDelay","extraDelay","delayFactor","delayCap","ret","min","pageExit","stagger","animationParams","keyframe","equivalents","transform","cssName","promise1","executeAnimation","promise2","slideAnim","keyframeName","isIn","Easings","easeInQuad","easeOutQuad","transitionParams","slideFromBottom","slideFromTop","slideFromLeft","slideFromRight","slideToBottom","slideToTop","slideToLeft","slideToRight","tabExitPage","tabEnterPage","exitGrow","exagerated","dur","easeInQuint","exitShrink","shrinkAndFall","enterShrink","easeOutQuint","enterGrow","easeInCubic","easeInQuart","easeInSine","easeInExpo","easeInCirc","easeInBack","easeOutCubic","easeOutQuart","easeOutSine","easeOutExpo","easeOutCirc","easeOutBack","easeInOutQuad","easeInOutCubic","easeInOutQuart","easeInOutQuint","easeInOutSine","easeInOutExpo","easeInOutCirc","easeInOutBack","_browserStyleEquivalents","elasticbuttonkinds","rectangle","morphpath","svg","roundedrectangle","round","ElasticButton","behavior","reset","active","mina","elastic","easein","_kind","contentCreated","contentElement","bgElement","currentKind","snap","Snap","pathEl","paths","_ptdown","_ptup","animate","createEventProperties","FOWrapper","someProperty","_someProperty","blurFilter","sblurFilter","blurTo","blur","stdDeviation","easeout"],"mappings":"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","file":"winjscontrib-custom.js","sourcesContent":["/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n(function (_global) {\n    //polyfill setimmediate\n    if (!this.setImmediate) {\n        this.setImmediate = function (callback) {\n            var args = [];\n            for (var _i = 1; _i < arguments.length; _i++) {\n                args[_i - 1] = arguments[_i];\n            }\n            setTimeout(callback, 0);\n            return 0;\n        };\n    }\n    //Windows 10 doesn't have it anymore, polyfill for backward compat\n    if (!this.toStaticHTML) {\n        this.toStaticHTML = function (text) {\n            return text;\n        };\n    }\n    var msapp = _global.MSApp;\n    if (msapp && !msapp.execUnsafeLocalFunction) {\n        msapp.execUnsafeLocalFunction = function (c) { c(); };\n    }\n})(this);\nif (!Object.map) {\n    Object.map = function (obj, mapping) {\n        var mapped = {};\n        if (typeof obj !== 'object') {\n            return mapped;\n        }\n        if (typeof mapping !== 'function') {\n            // We could just return obj but that wouldn't be\n            // consistent with the rest of the interface which always returns\n            // a new object.\n            mapping = function (key, val) {\n                return [key, val];\n            };\n        }\n        Object.keys(obj).forEach(function (key) {\n            var transmuted = mapping.apply(obj, [key, obj[key]]);\n            if (transmuted && transmuted.length) {\n                mapped[transmuted[0] || key] = transmuted[1];\n            }\n        });\n        return mapped;\n    };\n}\nif (!String.prototype.format) {\n    String.prototype.format = function () {\n        var args = arguments;\n        return this.replace(/{(\\d+)}/g, function (match, number) {\n            return typeof args[number] !== 'undefined' ? args[number] : match;\n        });\n    };\n}\nif (!String.prototype.padLeft) {\n    String.prototype.padLeft = function padLeft(length, leadingChar) {\n        if (leadingChar === undefined) {\n            leadingChar = \"0\";\n        }\n        return this.length < length ? (leadingChar + this).padLeft(length, leadingChar) : this;\n    };\n}\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Promise;\n    (function (Promise) {\n        /**\n         * apply callback for each item in the array in waterfall\n         * @function WinJSContrib.Promise.waterfall\n         * @param {Array} dataArray items to process with async tasks\n         * @param {function} promiseCallback function applyed to each item (could return a promise for item callback completion)\n         * @returns {WinJS.Promise}\n         */\n        function waterfall(dataArray, promiseCallback) {\n            var resultPromise = WinJS.Promise.wrap();\n            var results = [];\n            if (!dataArray) {\n                return WinJS.Promise.wrap([]);\n            }\n            var dataPromise = WinJS.Promise.as(dataArray);\n            return dataPromise.then(function (items) {\n                var queueP = function (p, item) {\n                    return p.then(function (r) {\n                        return WinJS.Promise.as(promiseCallback(item)).then(function (r) {\n                            results.push(r);\n                        });\n                    });\n                };\n                for (var i = 0, l = items.length; i < l; i++) {\n                    var item = items[i];\n                    if (!item && items.getItem) {\n                        item = items.getItem(i);\n                    }\n                    resultPromise = queueP(resultPromise, item);\n                }\n                return resultPromise.then(function (r) {\n                    return results;\n                });\n            });\n        }\n        Promise.waterfall = waterfall;\n        function promises(dataArray, promiseCallback) {\n            if (!dataArray) {\n                return WinJS.Promise.wrap([]);\n            }\n            var dataPromise = WinJS.Promise.as(dataArray);\n            return dataPromise.then(function (items) {\n                var promises = [];\n                for (var i = 0, l = items.length; i < l; i++) {\n                    var item = items[i];\n                    if (!item && items.getItem) {\n                        item = items.getItem(i);\n                    }\n                    promises.push(WinJS.Promise.as(promiseCallback(item)));\n                }\n                return promises;\n            });\n        }\n        /**\n         * apply callback for each item in the array in parallel (equivalent to WinJS.Promise.join)\n         * @function WinJSContrib.Promise.parallel\n         * @param {Array} dataArray items to process with async tasks\n         * @param {function} promiseCallback function applyed to each item (could return a promise for item callback completion)\n         * @returns {WinJS.Promise}\n         */\n        function parallel(dataArray, promiseCallback) {\n            if (!dataArray) {\n                return WinJS.Promise.wrap([]);\n            }\n            var dataPromise = WinJS.Promise.as(dataArray);\n            return dataPromise.then(function (items) {\n                var promises = [];\n                for (var i = 0, l = items.length; i < l; i++) {\n                    var item = items[i];\n                    if (!item && items.getItem) {\n                        item = items.getItem(i);\n                    }\n                    promises.push(WinJS.Promise.as(promiseCallback(item)));\n                }\n                return WinJS.Promise.join(promises);\n            });\n        }\n        Promise.parallel = parallel;\n        /**\n         * apply callback for each item in the array in batch of X parallel items\n         * @function WinJSContrib.Promise.batch\n         * @param {Array} dataArray items to process with async tasks\n         * @param {number} batchSize number of items to batch\n         * @param {function} promiseCallback function applyed to each item (could return a promise for item callback completion)\n         * @returns {WinJS.Promise}\n         */\n        function batch(dataArray, batchSize, promiseCallback) {\n            if (!dataArray) {\n                return WinJS.Promise.wrap([]);\n            }\n            var dataPromise = WinJS.Promise.as(dataArray);\n            return dataPromise.then(function (items) {\n                var resultPromise = WinJS.Promise.wrap();\n                var batcheditems = [];\n                var results = [];\n                var hasErrors = false;\n                var queueBatch = function (p, items) {\n                    //var batchresults = [];\n                    return p.then(function (r) {\n                        return WinJS.Promise.join(items.map(function (item) { return WinJS.Promise.as(promiseCallback(item)); })).then(function (results) {\n                            results = results.concat(results);\n                        }, function (errors) {\n                            results = results.concat(errors);\n                            hasErrors = true;\n                        });\n                    });\n                };\n                for (var i = 0, l = items.length; i < l; i++) {\n                    var item = items[i];\n                    if (!item && items.getItem) {\n                        item = items.getItem(i);\n                    }\n                    batcheditems.push(item);\n                    if (i > 0 && i % batchSize === 0) {\n                        resultPromise = queueBatch(resultPromise, batcheditems);\n                        batcheditems = [];\n                    }\n                }\n                if (batcheditems.length) {\n                    resultPromise = queueBatch(resultPromise, batcheditems);\n                }\n                return resultPromise.then(function () {\n                    if (hasErrors)\n                        return WinJS.Promise.wrapError(results);\n                    return results;\n                });\n            });\n        }\n        Promise.batch = batch;\n    })(Promise = WinJSContrib.Promise || (WinJSContrib.Promise = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Utils;\n    (function (Utils) {\n        /**\n         * extend an object with properties from subsequent objects\n         * @function WinJSContrib.Utils.extend\n         * @returns {Object} composite object\n         */\n        function extend() {\n            for (var i = 1; i < arguments.length; i++)\n                for (var key in arguments[i])\n                    if (arguments[i].hasOwnProperty(key))\n                        arguments[0][key] = arguments[i][key];\n            return arguments[0];\n        }\n        Utils.extend = extend;\n        /** indicate if string starts with featured characters\n         * @function WinJSContrib.Utils.startsWith\n         * @param {string} str string to search within\n         * @param {string} strToMatch match string\n         * @returns {boolean} true if string starts with strToMatch\n         */\n        function startsWith(str, strToMatch) {\n            if (!strToMatch) {\n                return false;\n            }\n            var match = (str.match(\"^\" + strToMatch) == strToMatch);\n            return match;\n        }\n        Utils.startsWith = startsWith;\n        if (!String.prototype.startsWith) {\n            String.prototype.startsWith = function (str) {\n                return WinJSContrib.Utils.startsWith(this, str);\n            };\n        }\n        function asyncForEach(array, callback, batchsize) {\n            if (batchsize === void 0) { batchsize = 1; }\n            var i = 0;\n            while (i < array.length) {\n                setImmediate(function () {\n                    for (var j = 0; j < batchsize && i < array.length; j++) {\n                        i++;\n                        callback(array[i]);\n                    }\n                });\n            }\n        }\n        Utils.asyncForEach = asyncForEach;\n        /** indicate if string ends with featured characters\n         * @function WinJSContrib.Utils.endsWith\n         * @param {string} str string to search within\n         * @param {string} strToMatch match string\n         * @returns {boolean} true if string starts with strToMatch\n         */\n        function endsWith(str, strToMatch) {\n            if (!strToMatch) {\n                return false;\n            }\n            return (str.match(strToMatch + \"$\") == strToMatch);\n        }\n        Utils.endsWith = endsWith;\n        if (!String.prototype.endsWith) {\n            String.prototype.endsWith = function (str) {\n                return WinJSContrib.Utils.endsWith(this, str);\n            };\n        }\n        /**\n         * generate a string formatted as a query string from object properties\n         * @function WinJSContrib.Utils.queryStringFrom\n         * @param {Object} obj object to format\n         * @returns {string}\n         */\n        function queryStringFrom(obj) {\n            var str = [];\n            for (var p in obj)\n                if (obj.hasOwnProperty(p)) {\n                    var key = encodeURIComponent(p);\n                    var rawValue = obj[p];\n                    var value = WinJSContrib.Utils.hasValue(rawValue) ? encodeURIComponent(rawValue) : \"\";\n                    str.push(key + \"=\" + value);\n                }\n            return str.join(\"&\");\n        }\n        Utils.queryStringFrom = queryStringFrom;\n        /**\n         * trigger an event on a DOM node\n         * @function WinJSContrib.Utils.triggerEvent\n         * @param {HTMLElement} element receiving the event\n         * @param {string} eventName name of the event\n         * @param {boolean} bubbles indicate if event should bubble\n         * @param {boolean} cancellable indicate if event can be cancelled\n         */\n        function triggerEvent(element, eventName, bubbles, cancellable) {\n            var eventToTrigger = document.createEvent(\"Event\");\n            eventToTrigger.initEvent(eventName, bubbles, cancellable);\n            element.dispatchEvent(eventToTrigger);\n        }\n        Utils.triggerEvent = triggerEvent;\n        /**\n         * @function WinJSContrib.Utils.triggerCustomEvent\n         * @param {HTMLElement} element receiving the event\n         * @param {string} eventName name of the event\n         * @param {boolean} bubbles indicate if event should bubble\n         * @param {boolean} cancellable indicate if event can be cancelled\n         */\n        function triggerCustomEvent(element, eventName, bubbles, cancellable, data) {\n            var eventToTrigger = document.createEvent(\"CustomEvent\");\n            eventToTrigger.initCustomEvent(eventName, bubbles, cancellable, data);\n            element.dispatchEvent(eventToTrigger);\n        }\n        Utils.triggerCustomEvent = triggerCustomEvent;\n        /*\n        Core object properties features\n        */\n        //return object value based on property name. Property name is a string containing the name of the property, \n        //or the name of the property with an indexer, ex: myproperty[2] (to get item in a array)\n        function getobject(obj, prop) {\n            if (!obj)\n                return;\n            if (prop === 'this')\n                return obj;\n            var baseValue = obj[prop];\n            if (typeof baseValue !== \"undefined\")\n                return baseValue;\n            var idx = prop.indexOf('[');\n            if (idx < 0)\n                return;\n            var end = prop.indexOf(']', idx);\n            if (end < 0)\n                return;\n            var val = prop.substr(idx + 1, end - idx);\n            val = parseInt(val);\n            return obj[val];\n        }\n        //set object property value based on property name. Property name is a string containing the name of the property, \n        //or the name of the property with an indexer, ex: myproperty[2] (to get item in a array)\n        function setobject(obj, prop, data) {\n            if (!obj)\n                return;\n            if (WinJSContrib.Utils.hasValue(prop)) {\n                if (obj.setProperty) {\n                    obj.setProperty(prop, data);\n                    return;\n                }\n                obj[prop] = data;\n                return;\n            }\n            if (typeof prop === \"string\") {\n                var idx = prop.indexOf('[');\n                if (idx < 0)\n                    return;\n                var end = prop.indexOf(']', idx);\n                if (end < 0)\n                    return;\n                var val = prop.substr(idx + 1, end - idx);\n                var intval = parseInt(val);\n                obj[intval] = data;\n            }\n        }\n        /** Read property value on an object based on expression\n        * @function WinJSContrib.Utils.readProperty\n        * @param {Object} source the object containing data\n        * @param {Object} properties property descriptor. could be a string in js notation ex: 'myProp.myChildProp,\n        * or an array of strings ['myProp', 'myChildProp']. String notation can contain indexers\n        * @returns {Object} property value\n        */\n        function readProperty(source, properties) {\n            if (typeof properties == 'string' && source[properties])\n                return source[properties];\n            if (!properties || !properties.length)\n                return source;\n            var prop = WinJSContrib.Utils.getProperty(source, properties);\n            if (prop) {\n                return prop.propValue;\n            }\n        }\n        Utils.readProperty = readProperty;\n        var PropertyDescriptor = (function () {\n            function PropertyDescriptor(parent, parentDescriptor, keyProp) {\n                this.parent = parent;\n                this.parentDescriptor = parentDescriptor;\n                this.keyProp = keyProp;\n            }\n            PropertyDescriptor.prototype.ensureParent = function () {\n                if (parent) {\n                    return parent;\n                }\n                else {\n                    if (this.parentDescriptor) {\n                        this.parentDescriptor.ensureParent();\n                        if (!this.parentDescriptor.parent[this.parentDescriptor.keyProp]) {\n                            this.parentDescriptor.parent[this.parentDescriptor.keyProp] = {};\n                            this.parent = this.parentDescriptor.parent[this.parentDescriptor.keyProp];\n                        }\n                    }\n                }\n            };\n            Object.defineProperty(PropertyDescriptor.prototype, \"propValue\", {\n                get: function () {\n                    return getobject(this.parent, this.keyProp);\n                },\n                set: function (val) {\n                    this.ensureParent();\n                    setobject(this.parent, this.keyProp, val);\n                },\n                enumerable: true,\n                configurable: true\n            });\n            return PropertyDescriptor;\n        })();\n        Utils.PropertyDescriptor = PropertyDescriptor;\n        /**\n         * return a propery descriptor for an object based on expression\n         * @function WinJSContrib.Utils.getProperty\n         * @param {Object} source the object containing data\n         * @param {string[]} properties property descriptor. could be a string in js notation ex: 'myProp.myChildProp,\n         * or an array of strings ['myProp', 'myChildProp']. String notation can contain indexers\n         * @returns {Object} property descriptor\n         */\n        function getProperty(source, properties) {\n            if (typeof properties == 'string') {\n                properties = properties.split('.');\n            }\n            if (!properties || !properties.length) {\n                properties = ['this'];\n            }\n            var parent = source;\n            var previousDescriptor = null;\n            for (var i = 0; i < properties.length; i++) {\n                var descriptor = new PropertyDescriptor(parent, previousDescriptor, properties[i]);\n                previousDescriptor = descriptor;\n                if (i == properties.length - 1) {\n                    return descriptor;\n                }\n                parent = getobject(parent, properties[i]);\n            }\n            return;\n        }\n        Utils.getProperty = getProperty;\n        /**\n         * Write property value on an object based on expression\n         * @function WinJSContrib.Utils.writeProperty\n         * @param {Object} source the object containing data\n         * @param {string[]} properties property descriptor. could be a string in js notation ex: 'myProp.myChildProp,\n         * or an array of strings ['myProp', 'myChildProp']. String notation can contain indexers\n         * @param {Object} data data to feed to the property\n         */\n        function writeProperty(source, properties, data) {\n            var prop = WinJSContrib.Utils.getProperty(source, properties);\n            if (prop) {\n                prop.propValue = data;\n            }\n        }\n        Utils.writeProperty = writeProperty;\n        /** generate a random value between two numbers\n         * @function WinJSContrib.Utils.randomFromInterval\n         * @param {number} from lower limit\n         * @param {number} to upper limit\n         * @returns {number}\n         */\n        function randomFromInterval(from, to) {\n            return (Math.random() * (to - from + 1) + from) << 0;\n        }\n        Utils.randomFromInterval = randomFromInterval;\n        /**\n         * function to use as a callback for Array.sort when you want the array to be sorted alphabetically\n         * @function WinJSContrib.Utils.alphabeticSort\n         * @param {string} a\n         * @param {string} b\n         * @returns {number}\n         */\n        function alphabeticSort(a, b) {\n            if (a > b)\n                return 1;\n            if (a < b)\n                return -1;\n            return 0;\n        }\n        Utils.alphabeticSort = alphabeticSort;\n        /**\n         * generate an array with only distinct elements\n         * @function WinJSContrib.Utils.distinctArray\n         * @param {Array} array\n         * @param {string} path to array's item property used for checking items\n         * @param {boolean} ignorecase indicate if comparison should ignore case when using string\n         * @returns {Array}\n         */\n        function distinctArray(array, property, ignorecase) {\n            if (array === null || array.length === 0)\n                return array;\n            if (typeof ignorecase == \"undefined\")\n                ignorecase = false;\n            var sMatchedItems = \"\";\n            var foundCounter = 0;\n            var newArray = [];\n            var sFind;\n            var i;\n            if (ignorecase) {\n                for (i = 0; i < array.length; i++) {\n                    if (property) {\n                        var data = WinJSContrib.Utils.readProperty(array[i], property.split('.'));\n                        sFind = data;\n                        if (!data)\n                            sFind = data;\n                        if (data && data.toLowerCase)\n                            sFind = data.toLowerCase();\n                    }\n                    else {\n                        sFind = array[i];\n                    }\n                    if (sMatchedItems.indexOf(\"|\" + sFind + \"|\") < 0) {\n                        sMatchedItems += \"|\" + sFind + \"|\";\n                        newArray[foundCounter++] = array[i];\n                    }\n                }\n            }\n            else {\n                for (i = 0; i < array.length; i++) {\n                    if (property) {\n                        sFind = WinJSContrib.Utils.readProperty(array[i], property.split('.'));\n                    }\n                    else {\n                        sFind = array[i];\n                    }\n                    if (sMatchedItems.indexOf(\"|\" + sFind + \"|\") < 0) {\n                        sMatchedItems += \"|\" + sFind + \"|\";\n                        newArray[foundCounter++] = array[i];\n                    }\n                }\n            }\n            return newArray;\n        }\n        Utils.distinctArray = distinctArray;\n        /**\n         * get distinct values from an array of items\n         * @function WinJSContrib.Utils.getDistinctPropertyValues\n         * @param {Array} array items array\n         * @param {string} property property path for values\n         * @param {boolean} ignorecase ignore case for comparisons\n         */\n        function getDistinctPropertyValues(array, property, ignorecase) {\n            return Utils.distinctArray(array, property, ignorecase).map(function (item) {\n                return WinJSContrib.Utils.readProperty(item, property.split('.'));\n            });\n        }\n        Utils.getDistinctPropertyValues = getDistinctPropertyValues;\n        /**\n         * Remove all accented characters from a string and replace them with their non-accented counterpart for ex: replace \"\" with \"e\"\n         * @function WinJSContrib.Utils.removeAccents\n         * @param {string} s\n         * @returns {string}\n         */\n        function removeAccents(s) {\n            var r = s.toLowerCase();\n            r = r.replace(new RegExp(\"[]\", 'g'), \"a\");\n            r = r.replace(new RegExp(\"\", 'g'), \"ae\");\n            r = r.replace(new RegExp(\"\", 'g'), \"c\");\n            r = r.replace(new RegExp(\"[]\", 'g'), \"e\");\n            r = r.replace(new RegExp(\"[]\", 'g'), \"i\");\n            r = r.replace(new RegExp(\"\", 'g'), \"n\");\n            r = r.replace(new RegExp(\"[]\", 'g'), \"o\");\n            r = r.replace(new RegExp(\"\", 'g'), \"oe\");\n            r = r.replace(new RegExp(\"[]\", 'g'), \"u\");\n            r = r.replace(new RegExp(\"[]\", 'g'), \"y\");\n            return r;\n        }\n        Utils.removeAccents = removeAccents;\n        /**\n         * remove a page from navigation history\n         * @function WinJSContrib.Utils.removePageFromHistory\n         * @param {string} pageLocation page url\n         */\n        function removePageFromHistory(pageLoc) {\n            var history = [];\n            if (WinJS.Navigation.history && WinJS.Navigation.history.backStack && WinJS.Navigation.history.backStack.length) {\n                WinJS.Navigation.history.backStack.forEach(function (page) {\n                    if (page.location !== pageLoc) {\n                        history.push(page);\n                    }\n                });\n            }\n            WinJS.Navigation.history.backStack = history;\n        }\n        Utils.removePageFromHistory = removePageFromHistory;\n        /**\n         * format a number on 2 digits\n         * @function WinJSContrib.Utils.pad2\n         * @param {number} number\n         */\n        function pad2(number) {\n            return (number < 10 ? '0' : '') + number;\n        }\n        Utils.pad2 = pad2;\n        /**\n         * truncate a string and add ellipse if text if greater than certain size\n         * @function WinJSContrib.Utils.ellipsisizeString\n         * @param {string} text text to truncate\n         * @param {number} maxSize maximum size for text\n         * @param {boolean} useWordBoundary indicate if truncate should happen on the closest word boundary (like space)\n         */\n        function ellipsisizeString(text, maxSize, useWordBoundary) {\n            if (!text) {\n                return '';\n            }\n            var toLong = text.length > maxSize, text_ = toLong ? text.substr(0, maxSize - 1) : text;\n            text_ = useWordBoundary && toLong ? text_.substr(0, text_.lastIndexOf(' ')) : text_;\n            return toLong ? text_ + '...' : text_;\n        }\n        Utils.ellipsisizeString = ellipsisizeString;\n        /**\n         * generate a new Guid\n         * @function WinJSContrib.Utils.guid\n         * @returns {string}\n         */\n        function guid() {\n            var d = new Date().getTime();\n            var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n                var r = (d + Math.random() * 16) % 16 | 0;\n                d = Math.floor(d / 16);\n                return (c == 'x' ? r : (r & 0x7 | 0x8)).toString(16);\n            });\n            return uuid;\n        }\n        Utils.guid = guid;\n        /**\n         * inherit property from parent WinJS controls\n         * @function WinJSContrib.Utils.inherit\n         * @param {HTMLElement} element\n         * @param {string} property property name\n         */\n        function inherit(element, property) {\n            if (element && element.parentElement) {\n                var current = element.parentElement;\n                while (current) {\n                    if (current.winControl) {\n                        if (current.winControl[property] !== undefined) {\n                            return current.winControl[property];\n                        }\n                    }\n                    current = current.parentElement;\n                }\n            }\n        }\n        Utils.inherit = inherit;\n        /**\n         * move DOM childrens form one node to the other\n         * @function WinJSContrib.Utils.moveChilds\n         * @param {HTMLElement} source source node containing elements to move\n         * @param {HTMLElement} target target node for moved elements\n         */\n        function moveChilds(source, target) {\n            if (!source || !target)\n                return;\n            var childs = [];\n            for (var i = 0; i < source.childNodes.length; i++) {\n                childs.push(source.childNodes[i]);\n            }\n            childs.forEach(function (elt) {\n                target.appendChild(elt);\n            });\n        }\n        Utils.moveChilds = moveChilds;\n        /**\n         * get parent control identifyed by a property attached on DOM element\n         * @function WinJSContrib.Utils.getParent\n         * @param {string} property property attached to control's DOM element, for ex: msParentSelectorScope\n         * @param {HTMLElement} element DOM element to scan\n         * @returns {Object} WinJS control\n         */\n        function getParent(property, element) {\n            if (!element)\n                return;\n            var current = element.parentNode;\n            while (current) {\n                if (current[property] && current.winControl) {\n                    return current.winControl;\n                }\n                current = current.parentNode;\n            }\n        }\n        Utils.getParent = getParent;\n        /**\n         * get parent control identifyed by a css class\n         * @function WinJSContrib.Utils.getParentControlByClass\n         * @param {string} className css class name\n         * @param {HTMLElement} element DOM element to scan\n         * @returns {Object} WinJS control\n         */\n        function getParentControlByClass(className, element) {\n            if (!element)\n                return;\n            var current = element.parentNode;\n            while (current) {\n                if (current.classList && current.classList.contains(className) && current.winControl) {\n                    return current.winControl;\n                }\n                current = current.parentNode;\n            }\n        }\n        Utils.getParentControlByClass = getParentControlByClass;\n        /**\n         * get parent page control (work only with WinJSContrib.UI.PageControlNavigator\n         * @function WinJSContrib.Utils.getParentPage\n         * @param {HTMLElement} element DOM element to scan\n         * @returns {Object} WinJS control\n         */\n        function getParentPage(element) {\n            return WinJSContrib.Utils.getParent('mcnPage', element);\n        }\n        Utils.getParentPage = getParentPage;\n        /**\n         * get parent scope control (based on msParentSelectorScope)\n         * @function WinJSContrib.Utils.getScopeControl\n         * @param {HTMLElement} element DOM element to scan\n         * @returns {Object} WinJS control\n         */\n        function getScopeControl(element) {\n            var current = element.parentNode;\n            while (current) {\n                if (current.msParentSelectorScope) {\n                    var scope = current.parentNode;\n                    if (scope) {\n                        var scopeControl = scope.winControl;\n                        if (scopeControl) {\n                            return scopeControl;\n                        }\n                    }\n                }\n                current = current.parentNode;\n            }\n        }\n        Utils.getScopeControl = getScopeControl;\n        /**\n         * get WinJS.Binding.Template like control from a path, a control, a function or a DOM element\n         * @function WinJSContrib.Utils.getTemplate\n         * @param {Object} template template input\n         * @returns {Object} WinJS.Binding.Template or template-like object (object with a render function)\n         */\n        function getTemplate(template) {\n            if (template) {\n                var templatetype = typeof template;\n                if (templatetype == 'string') {\n                    return new WinJS.Binding.Template(null, { href: template });\n                }\n                if (templatetype == 'function') {\n                    return {\n                        render: function (data, elt) {\n                            var res = template(data, elt);\n                            return WinJS.Promise.as(res);\n                        }\n                    };\n                }\n                else if (template.winControl) {\n                    return template.winControl;\n                }\n                else if (template.render) {\n                    return template;\n                }\n            }\n        }\n        Utils.getTemplate = getTemplate;\n        /**\n         * get a function from an expression, for example 'page:myAction' will return the myAction function from the parent page.\n         * The returned function will be bound to it's owner. This function relies on {link WinJSContrib.Utils.resolveValue}, see this for details about how data are crawled\n         * @function WinJSContrib.Utils.resolveMethod\n         * @param {HTMLElement} element DOM element to look\n         * @param {string} text expression like 'page:something' or 'ctrl:something' or 'something'\n         * @returns {function}\n         */\n        function resolveMethod(element, text) {\n            var res = WinJSContrib.Utils.resolveValue(element, text);\n            if (res && typeof res == 'function')\n                return res;\n            return undefined;\n        }\n        Utils.resolveMethod = resolveMethod;\n        function readValue(element, text) {\n            var res = WinJSContrib.Utils.resolveValue(element, text);\n            if (res) {\n                if (typeof res == 'function')\n                    return res(element);\n                else\n                    return res;\n            }\n            return undefined;\n        }\n        Utils.readValue = readValue;\n        /**\n         * Utility functions used by WinJSContrib.Utils.resolveValue and WinJSContrib.Utils.applyValue\n         * @namespace WinJSContrib.Utils.ValueParsers\n         */\n        Utils.ValueParsers = {\n            /**\n             * Get value from current page in parent navigator\n             * @function WinJSContrib.Utils.ValueParsers.navpage\n             */\n            \"navpage\": function (element, text, context) {\n                var control = (context && context.data) ? context.data.navpage : null;\n                if (!control) {\n                    if (WinJSContrib.Utils.getParentPage) {\n                        control = WinJSContrib.Utils.getParentPage(element);\n                        if (context && context.data)\n                            context.data.navpage = control;\n                    }\n                    if (!control && WinJSContrib.UI.Application.navigator) {\n                        control = WinJSContrib.UI.Application.navigator.pageControl;\n                        if (context && context.data)\n                            context.data.navpage = control;\n                    }\n                }\n                if (!control)\n                    return;\n                if (context)\n                    context.parentControl = control;\n                var method = WinJSContrib.Utils.readProperty(control, text);\n                if (method && typeof method === 'function')\n                    return method.bind(control);\n                else\n                    return method;\n            },\n            /**\n             * Get value from parent element with 'pagecontrol' class\n             * @function WinJSContrib.Utils.ValueParsers.page\n             */\n            \"page\": function (element, text, context) {\n                var control = (context && context.data) ? context.data.page : null;\n                if (!control) {\n                    control = WinJSContrib.Utils.getParentControlByClass('pagecontrol', element);\n                    if (context && context.data)\n                        context.data.page = control;\n                }\n                if (!control)\n                    return;\n                if (context)\n                    context.parentControl = control;\n                var method = WinJSContrib.Utils.readProperty(control, text);\n                if (method && typeof method === 'function')\n                    return method.bind(control);\n                else\n                    return method;\n            },\n            /**\n             * Get value from parent scope\n             * @function WinJSContrib.Utils.ValueParsers.ctrl\n             */\n            \"ctrl\": function (element, text, context) {\n                var control = (context && context.data) ? context.data.scope : null;\n                if (!control) {\n                    control = WinJSContrib.Utils.getScopeControl(element);\n                    if (context && context.data)\n                        context.data.scope = control;\n                }\n                if (!control)\n                    return;\n                if (context)\n                    context.parentControl = control;\n                var method = WinJSContrib.Utils.readProperty(control, text);\n                if (method && typeof method === 'function')\n                    return method.bind(control);\n                else\n                    return method;\n            },\n            /**\n             * select a node from DOM\n             * @function WinJSContrib.Utils.ValueParsers.select\n             */\n            \"select\": function (element, text, context) {\n                var control = (context && context.data) ? context.data.scope : null;\n                if (!control) {\n                    control = WinJSContrib.Utils.getScopeControl(element);\n                    if (context && context.data)\n                        context.data.scope = control;\n                }\n                var element = null;\n                var items = text.split('|');\n                var selector = items[0];\n                if (control) {\n                    element = control.element.querySelector(selector);\n                }\n                if (!element)\n                    element = document.querySelector(selector);\n                if (items.length == 1) {\n                    return element;\n                }\n                else if (items.length > 1) {\n                    var val = readProperty(element, text.substr(items[0].length + 1));\n                    return val;\n                }\n            },\n            /**\n             * get an object formatted as JSON\n             * @function WinJSContrib.Utils.ValueParsers.obj\n             */\n            \"obj\": function (element, text, context) {\n                return WinJS.UI.optionsParser(text, window, {\n                    select: WinJS.Utilities.markSupportedForProcessing(function (text) {\n                        var parent = WinJSContrib.Utils.getScopeControl(element);\n                        if (parent) {\n                            return parent.element.querySelector(text);\n                        }\n                        else {\n                            return document.querySelector(text);\n                        }\n                    })\n                });\n            },\n            /**\n             * mark a promise for resolution (if used in applyValue, the promise will get resolved and the promise's result will be affected)\n             * @function WinJSContrib.Utils.ValueParsers.prom\n             */\n            \"prom\": function (element, text, context) {\n                var res = resolveValue(element, text, context);\n                if (res.then) {\n                    res = res.then(null, null);\n                    res.mcnMustResolve = true;\n                }\n                return res;\n            },\n            /**\n             * wrap result in WinJS.Binding.List().dataSource\n             * usefull for ListViews\n             * @function WinJSContrib.Utils.ValueParsers.list\n             */\n            \"list\": function (element, text, context) {\n                var res = resolveValue(element, text, context);\n                if (res) {\n                    if (res.then) {\n                        var p = res.then(function (data) {\n                            return new WinJS.Binding.List(data).dataSource;\n                        });\n                        p.mcnMustResolve = true;\n                        return p;\n                    }\n                    return new WinJS.Binding.List(res).dataSource;\n                }\n            },\n            /**\n             * get value from global scope\n             * @function WinJSContrib.Utils.ValueParsers.global\n             */\n            \"global\": function (element, text, context) {\n                return WinJSContrib.Utils.readProperty(window, text);\n            },\n            /**\n             * get a template from uri\n             * @function WinJSContrib.Utils.ValueParsers.templ\n             */\n            \"templ\": function (element, text, context) {\n                return WinJSContrib.Templates.get(text);\n            },\n            /**\n             * return element property\n             * @function WinJSContrib.Utils.ValueParsers.element\n             */\n            \"element\": function (element, text, context) {\n                var res = resolveValue(element, text, context);\n                if (res)\n                    return res.element;\n            },\n            \"event\": function (element, text, context) {\n                var res = resolveValue(element, text, context);\n                var parentControl = null;\n                if (!res || !context || !context.name) {\n                    return;\n                }\n                if (context)\n                    parentControl = context.parentControl;\n                if (res && typeof res === 'function') {\n                    if (parentControl && parentControl.eventTracker) {\n                        parentControl.eventTracker.addEvent(context.control, context.name, res);\n                    }\n                    else {\n                        context.control.addEventListener(context.name, res);\n                    }\n                }\n            }\n        };\n        /**\n         * resolve value from an expression. This helper will crawl the DOM up, and provide the property or function from parent page or control.\n         * @function WinJSContrib.Utils.resolveValue\n         * @param {HTMLElement} element DOM element to look\n         * @param {string} text expression like 'page:something' or 'ctrl:something' or 'something'\n         * @returns {Object}\n         */\n        function resolveValue(element, text, context) {\n            var methodName, control, method;\n            var items = text.split(':');\n            if (items.length > 1) {\n                var name = items[0];\n                var val = text.substr(name.length + 1);\n                var parser = Utils.ValueParsers[name];\n                if (parser) {\n                    return parser(element, val, context);\n                }\n            }\n            return text; //WinJSContrib.Utils.readProperty(window, text);\n        }\n        Utils.resolveValue = resolveValue;\n        /**\n         * call resolve value and apply result to a target object\n         * @function WinJSContrib.Utils.applyValue\n         * @param {HTMLElement} element DOM element to look\n         * @param {string} text expression like 'page:something' or 'ctrl:something' or 'something'\n         * @param {string} target target object\n         * @param {string} targetPath path to dest property\n         */\n        function applyValue(element, text, target, targetPath, context) {\n            var tmp = WinJSContrib.Utils.resolveValue(element, text, context);\n            if (tmp && tmp.then && tmp.mcnMustResolve) {\n                tmp.then(function (data) {\n                    WinJSContrib.Utils.writeProperty(target, targetPath, data);\n                });\n            }\n            else {\n                WinJSContrib.Utils.writeProperty(target, targetPath, tmp);\n            }\n        }\n        Utils.applyValue = applyValue;\n        /**\n         * Checks in a safe way if an object has a value, which could be 'false', '0' or '\"\"'\n         * @function WinJSContrib.Utils.hasValue\n         * @param {Object} item The object to check.\n         * @returns {Boolean} Whether the object has a value or not.\n         */\n        function hasValue(item) {\n            return typeof item !== \"undefined\" && item !== null;\n        }\n        Utils.hasValue = hasValue;\n        /**\n         * format error from an xhr call\n         * @function WinJSContrib.Utils.formatXHRError\n         */\n        function formatXHRError(xhr) {\n            return \"{0} - {1}: {2}\".format(xhr.status, xhr.statusText, xhr.responseText);\n        }\n        Utils.formatXHRError = formatXHRError;\n        /**\n         * Unwraps the real error from a WinJS.Promise.join operation, which by design returns an array with 'undefined' for all cells,\n         * excepts the one corresponding to the promise that really faulted.\n         * @function WinJSContrib.Utils.unwrapJoinError\n         * @param {function} errorCallback The callback to use to handle the error.\n         * @returns {Function} The result of the callback being fired with the real error.\n         */\n        function unwrapJoinError(errorCallback) {\n            return function (errorArray) {\n                var unwrappedError = null;\n                for (var i = 0; i < errorArray.length; i++) {\n                    var tentativeError = errorArray[i];\n                    if (typeof tentativeError !== \"undefined\") {\n                        unwrappedError = tentativeError;\n                        break;\n                    }\n                }\n                return errorCallback(unwrappedError);\n            };\n        }\n        Utils.unwrapJoinError = unwrapJoinError;\n        /**\n         * inject properties from source object to target object\n         * @function WinJSContrib.Utils.inject\n         */\n        function inject(target, source) {\n            if (source) {\n                for (var k in source) {\n                    target[k] = source[k];\n                }\n            }\n        }\n        Utils.inject = inject;\n    })(Utils = WinJSContrib.Utils || (WinJSContrib.Utils = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n/**\n * @namespace WinJSContrib.Templates\n */\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Templates;\n    (function (Templates) {\n        var cache = {};\n        /**\n         * get a template from it's path\n         * @function get\n         * @memberof WinJSContrib.Templates\n         * @param {string} uri path to template file\n         * @returns {WinJS.Binding.Template} template object\n         */\n        function get(uri) {\n            var template = cache[uri];\n            if (cache[uri])\n                return template;\n            return new WinJS.Binding.Template(null, { href: uri });\n        }\n        Templates.get = get;\n        /**\n         * get a template and turn it to a rendering function that takes an item promise, and return a DOM element\n         * @function WinJSContrib.Templates.interactive\n         * @param {string} uri path to template file\n         * @param {Object} args definition of interactive elements\n         * @returns {function} rendering function that takes an item promise, and return a DOM element\n         */\n        function interactive(uri, args) {\n            var template = WinJSContrib.Templates.get(uri);\n            if (template) {\n                return WinJSContrib.Templates.makeInteractive(template, args);\n            }\n            else {\n                throw { message: 'template not found for ' + uri };\n            }\n        }\n        Templates.interactive = interactive;\n        /**\n         * generate a rendering function that takes an item promise, and return a DOM element\n         * @function WinJSContrib.Templates.get\n         * @param {WinJS.Binding.Template} template template object\n         * @param {Object} args definition of interactive elements\n         * @returns {function} rendering function that takes an item promise, and return a DOM element\n         */\n        function makeInteractive(template, args) {\n            return function (itemPromise) {\n                return itemPromise.then(function (item) {\n                    return template.render(item).then(function (rendered) {\n                        if (args.tap) {\n                            for (var n in args.tap) {\n                                var elt = rendered.querySelector(n);\n                                WinJSContrib.UI.tap(elt, function (arg) {\n                                    args.tap[n](arg, item);\n                                });\n                            }\n                        }\n                        if (args.click) {\n                            for (var n in args.click) {\n                                var elt = rendered.querySelector(n);\n                                elt.onclick = function (arg) {\n                                    args.click[n](arg, item);\n                                };\n                            }\n                        }\n                        return rendered;\n                    });\n                });\n            };\n        }\n        Templates.makeInteractive = makeInteractive;\n    })(Templates = WinJSContrib.Templates || (WinJSContrib.Templates = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var UI;\n    (function (UI) {\n        UI.Application = {};\n        /**\n         * indicate if fragment should not look for resources when building control\n         * @field WinJSContrib.UI.disableAutoResources\n         * @type {boolean}\n         */\n        UI.disableAutoResources = false;\n        /**\n         * Calculate offset of element relative to parent element. If parent parameter is null, offset is relative to document\n         * @function WinJSContrib.UI.offsetFrom\n         * @param {HTMLElement} element element to evaluate\n         * @param {HTMLElement} parent reference of offset\n         */\n        function offsetFrom(element, parent) {\n            var xPosition = 0;\n            var yPosition = 0;\n            var w = element.clientWidth;\n            var h = element.clientHeight;\n            while (element && element != parent) {\n                xPosition += (element.offsetLeft - element.scrollLeft + element.clientLeft);\n                yPosition += (element.offsetTop - element.scrollTop + element.clientTop);\n                element = element.offsetParent;\n            }\n            return { x: xPosition, y: yPosition, width: w, height: h };\n        }\n        UI.offsetFrom = offsetFrom;\n        var EventTracker = (function () {\n            /**\n             * @class WinJSContrib.UI.EventTracker\n             * @classdesc object to register and release events from addEventListener or bind\n             */\n            function EventTracker() {\n                this.events = [];\n            }\n            /**\n             * register an event from an object\n             * @function WinJSContrib.UI.EventTracker.prototype.addEvent\n             * @param {Object} e object containing addEventListener\n             * @param {string} eventName name of the event\n             * @param {function} handler\n             * @param {boolean} capture\n             * @returns {function} function to call for unregistering the event\n             */\n            EventTracker.prototype.addEvent = function (e, eventName, handler, capture) {\n                var tracker = this;\n                e.addEventListener(eventName, handler, capture);\n                var unregister = function () {\n                    try {\n                        e.removeEventListener(eventName, handler);\n                        var idx = tracker.events.indexOf(unregister);\n                        if (idx >= 0) {\n                            tracker.events.splice(idx, 1);\n                        }\n                    }\n                    catch (exception) {\n                        console.error('unexpected error while releasing callback ' + exception.message);\n                    }\n                };\n                this.events.push(unregister);\n                return unregister;\n            };\n            /**\n             * register binding event\n             * @function WinJSContrib.UI.EventTracker.prototype.addBinding\n             * @param {Object} e object containing bind method\n             * @param {string} eventName name of the binding event\n             * @param {function} handler\n             */\n            EventTracker.prototype.addBinding = function (e, eventName, handler) {\n                e.bind(eventName, handler);\n                var unregister = function () {\n                    e.unbind(eventName, handler);\n                };\n                this.events.push(unregister);\n                return unregister;\n            };\n            /**\n             * release all registered events\n             * @function WinJSContrib.UI.EventTracker.prototype.dispose\n             */\n            EventTracker.prototype.dispose = function () {\n                for (var i = 0; i < this.events.length; i++) {\n                    this.events[i]();\n                }\n                this.events = [];\n            };\n            return EventTracker;\n        })();\n        UI.EventTracker = EventTracker;\n        /**\n         * open all appbars\n         * @function WinJSContrib.UI.appbarsOpen\n         */\n        function appbarsOpen() {\n            var res = document.querySelectorAll('div[data-win-control=\"WinJS.UI.AppBar\"],div[data-win-control=\"WinJS.UI.NavBar\"]');\n            if (res && res.length) {\n                for (var i = 0; i < res.length; i++) {\n                    var e = res[i];\n                    if (e.winControl) {\n                        e.winControl.show();\n                    }\n                }\n            }\n        }\n        UI.appbarsOpen = appbarsOpen;\n        /**\n         * close all appbars\n         * @function WinJSContrib.UI.appbarsClose\n         */\n        function appbarsClose() {\n            var res = document.querySelectorAll('div[data-win-control=\"WinJS.UI.AppBar\"],div[data-win-control=\"WinJS.UI.NavBar\"]');\n            if (res && res.length) {\n                for (var i = 0; i < res.length; i++) {\n                    var e = res[i];\n                    if (e.winControl) {\n                        e.winControl.hide();\n                    }\n                }\n            }\n        }\n        UI.appbarsClose = appbarsClose;\n        /**\n         * disable all appbars\n         * @function WinJSContrib.UI.appbarsDisable\n         */\n        function appbarsDisable() {\n            var res = document.querySelectorAll('div[data-win-control=\"WinJS.UI.AppBar\"],div[data-win-control=\"WinJS.UI.NavBar\"]');\n            if (res && res.length) {\n                for (var i = 0; i < res.length; i++) {\n                    var e = res[i];\n                    if (e.winControl) {\n                        e.winControl.disabled = true;\n                    }\n                }\n            }\n        }\n        UI.appbarsDisable = appbarsDisable;\n        /**\n         * enable all appbars\n         * @function WinJSContrib.UI.appbarsEnable\n         */\n        function appbarsEnable() {\n            var elements = document.querySelectorAll('div[data-win-control=\"WinJS.UI.AppBar\"],div[data-win-control=\"WinJS.UI.NavBar\"]');\n            if (elements && elements.length) {\n                for (var i = 0, l = elements.length; i < l; i++) {\n                    var el = elements[i];\n                    if (el.winControl) {\n                        el.winControl.disabled = false;\n                    }\n                }\n            }\n        }\n        UI.appbarsEnable = appbarsEnable;\n        /**\n         * build a promise around element \"load\" event (work for all element with src property like images, iframes, ...)\n         * @function WinJSContrib.UI.elementLoaded\n         * @param {HTMLElement} element\n         * @param {string} url url used to feed \"src\" on element\n         * @returns {WinJS.Promise}\n         */\n        function elementLoaded(elt, url) {\n            return new WinJS.Promise(function (complete, error) {\n                function onerror(e) {\n                    elt.onload = undefined;\n                    elt.onerror = undefined;\n                    elt.onreadystatechange = undefined;\n                    error('element not loaded');\n                }\n                function onload(e) {\n                    elt.onload = undefined;\n                    elt.onerror = undefined;\n                    elt.onreadystatechange = undefined;\n                    complete({\n                        element: elt,\n                        url: url\n                    });\n                }\n                elt.onerror = onerror;\n                elt.onload = onload;\n                elt.onreadystatechange = onload;\n                if (elt.naturalWidth > 0) {\n                    onload(undefined);\n                }\n                elt.src = url;\n            });\n        }\n        UI.elementLoaded = elementLoaded;\n        /**\n         * Create a promise for getting an image object from url\n         * @function WinJSContrib.UI.loadImage\n         * @param {string} imgUrl url for the picture\n         * @returns {WinJS.Promise}\n         */\n        function loadImage(imgUrl) {\n            return new WinJS.Promise(function (complete, error) {\n                var image = new Image();\n                function onerror(e) {\n                    image.onload = undefined;\n                    image.onerror = undefined;\n                    error({ message: 'image not loaded : ' + imgUrl, path: imgUrl });\n                }\n                function onload(e) {\n                    image.onload = undefined;\n                    image.onerror = undefined;\n                    complete({\n                        element: image,\n                        url: imgUrl\n                    });\n                }\n                image.onerror = onerror;\n                image.onload = onload;\n                if (image.naturalWidth > 0) {\n                    onload(undefined);\n                }\n                image.src = imgUrl;\n            });\n        }\n        UI.loadImage = loadImage;\n        /**\n         * List all elements found after provided element\n         * @function WinJSContrib.UI.listElementsAfterMe\n         * @param {HTMLElement} elt target element\n         * @returns {Array} list of sibling elements\n         */\n        function listElementsAfterMe(elt) {\n            var res = [];\n            var passed = false;\n            if (elt.parentElement) {\n                var parent = elt.parentElement;\n                for (var i = 0; i < parent.children.length; i++) {\n                    if (parent.children[i] === elt) {\n                        passed = true;\n                    }\n                    else if (passed) {\n                        res.push(parent.children[i]);\n                    }\n                }\n            }\n            return res;\n        }\n        UI.listElementsAfterMe = listElementsAfterMe;\n        /**\n         * create an animation for removing an element from a list\n         * @function WinJSContrib.UI.removeElementAnimation\n         * @param {HTMLElement} element that will be removed\n         * @returns {WinJS.Promise}\n         */\n        function removeElementAnimation(elt) {\n            return new WinJS.Promise(function (complete, error) {\n                var remainings = WinJSContrib.UI.listElementsAfterMe(elt);\n                var anim = WinJS.UI.Animation.createDeleteFromListAnimation([\n                    elt\n                ], remainings);\n                elt.style.position = \"fixed\";\n                elt.style.opacity = '0';\n                anim.execute().done(function () {\n                    complete(elt);\n                });\n            });\n        }\n        UI.removeElementAnimation = removeElementAnimation;\n        function bindAction(el, element, control) {\n            el.classList.add('page-action');\n            var actionName = el.dataset.pageAction || el.getAttribute('tap');\n            var action = control[actionName];\n            if (action && typeof action === 'function') {\n                var options = el.dataset.pageActionOptions || el.getAttribute('tap-options');\n                if (options) {\n                    try {\n                        options = WinJS.UI.optionsParser(options, window);\n                    }\n                    catch (exception) {\n                        return;\n                    }\n                }\n                WinJSContrib.UI.tap(el, function (eltarg) {\n                    var p = WinJS.Promise.wrap();\n                    var actionArgs = eltarg.dataset.pageActionArgs || el.getAttribute('tap-args');\n                    if (actionArgs && typeof actionArgs == 'string') {\n                        var tmp = WinJSContrib.Utils.readValue(eltarg, actionArgs);\n                        p = WinJS.Promise.as(tmp).then(function (val) {\n                            if (typeof val === 'string') {\n                                try {\n                                    val = WinJS.UI.optionsParser(val, window);\n                                }\n                                catch (exception) {\n                                    return;\n                                }\n                            }\n                            return val;\n                        });\n                        if (tmp) {\n                            actionArgs = tmp;\n                        }\n                        else {\n                        }\n                    }\n                    return p.then(function () {\n                        return control[actionName].bind(control)({ elt: eltarg, args: actionArgs });\n                    });\n                }, options);\n            }\n        }\n        /**\n         * setup declarative binding to parent control function. It looks for \"data-page-action\" attributes,\n         * and try to find a matching method on the supplyed control.\n         * You could add arguments with a \"page-action-args\" attribute. The argument can be an object or a function\n         * @function WinJSContrib.UI.bindPageActions\n         * @param {HTMLElement} element root node crawled for page actions\n         * @param {Object} control control owning functions to call\n         */\n        function bindPageActions(element, control) {\n            var elements = element.querySelectorAll('*[data-page-action], *[tap]');\n            if (elements && elements.length) {\n                for (var i = 0, l = elements.length; i < l; i++) {\n                    var el = elements[i];\n                    bindAction(el, element, control);\n                }\n            }\n        }\n        UI.bindPageActions = bindPageActions;\n        function bindLink(el, element) {\n            el.classList.add('page-link');\n            var applink = el.getAttribute('applink');\n            var target = el.dataset.pageLink || el.getAttribute('linkto');\n            if (target && target.indexOf('/') < 0) {\n                var tmp = WinJSContrib.Utils.readProperty(window, target);\n                if (tmp) {\n                    target = tmp;\n                }\n            }\n            if (target) {\n                var options = el.dataset.pageActionOptions || el.getAttribute('tap-options');\n                if (options) {\n                    try {\n                        options = WinJS.UI.optionsParser(options, window);\n                    }\n                    catch (exception) {\n                        return;\n                    }\n                }\n                WinJSContrib.UI.tap(el, function (eltarg) {\n                    var p = WinJS.Promise.wrap();\n                    var actionArgs = eltarg.dataset.pageActionArgs || el.getAttribute('linkto-args');\n                    if (actionArgs && typeof actionArgs == 'string') {\n                        var tmp = WinJSContrib.Utils.readValue(eltarg, actionArgs);\n                        p = WinJS.Promise.as(tmp).then(function (val) {\n                            if (typeof val === 'string') {\n                                try {\n                                    val = WinJS.UI.optionsParser(val, window);\n                                }\n                                catch (exception) {\n                                }\n                            }\n                            return val;\n                        });\n                    }\n                    return p.then(function (actionArgs) {\n                        if (!applink && WinJSContrib.UI.parentNavigator && WinJSContrib.UI.parentNavigator(eltarg)) {\n                            var nav = WinJSContrib.UI.parentNavigator(eltarg);\n                            return nav.navigate(target, actionArgs);\n                        }\n                        else {\n                            return WinJS.Navigation.navigate(target, actionArgs);\n                        }\n                    });\n                }, options);\n            }\n        }\n        /**\n         * setup declarative binding to page link. It looks for \"data-page-link\" attributes.\n         * If any the content of the attribute point toward a page. clicking that element will navigate to that page.\n         * You could add arguments with a \"page-action-args\" attribute. The argument can be an object or a function\n         * @function WinJSContrib.UI.bindPageLinks\n         * @param {HTMLElement} element root node crawled for page actions\n         */\n        function bindPageLinks(element) {\n            var elements = element.querySelectorAll('*[data-page-link], *[linkto]');\n            if (elements && elements.length) {\n                for (var i = 0, l = elements.length; i < l; i++) {\n                    var el = elements[i];\n                    bindLink(el, element);\n                }\n            }\n        }\n        UI.bindPageLinks = bindPageLinks;\n        function parentNavigator(element) {\n            var current = element.parentNode;\n            while (current) {\n                if (current.mcnNavigator) {\n                    return current.winControl;\n                }\n                current = current.parentNode;\n            }\n        }\n        UI.parentNavigator = parentNavigator;\n        function bindMember(el, element, control) {\n            el.classList.add('page-member');\n            var memberName = el.dataset.pageMember || el.getAttribute('member');\n            if (!memberName)\n                memberName = el.id;\n            if (memberName && !control[memberName]) {\n                control[memberName] = el;\n                if (el.winControl) {\n                    control[memberName] = el.winControl;\n                }\n            }\n        }\n        /**\n         * Add this element or control as member to the control. It looks for \"data-page-member\" attributes. If attribute is empty, it tooks the element id as member name.\n         * @function WinJSContrib.UI.bindMembers\n         * @param {HTMLElement} element root node crawled for page actions\n         * @param {Object} control control owning functions to call\n         */\n        function bindMembers(element, control) {\n            var elements = element.querySelectorAll('*[data-page-member], *[member]');\n            if (elements && elements.length) {\n                for (var i = 0, l = elements.length; i < l; i++) {\n                    var el = elements[i];\n                    bindMember(el, element, control);\n                }\n            }\n        }\n        UI.bindMembers = bindMembers;\n        /**\n         * setup declarative binding to parent control function and to navigation links. It internally invoke both {@link WinJSContrib.UI.bindPageActions} and {@link WinJSContrib.UI.bindPageLinks}\n         * @function WinJSContrib.UI.bindActions\n         * @param {HTMLElement} element root node crawled for page actions\n         * @param {Object} control control owning functions to call\n         */\n        function bindActions(element, control) {\n            WinJSContrib.UI.bindPageActions(element, control);\n            WinJSContrib.UI.bindPageLinks(element);\n        }\n        UI.bindActions = bindActions;\n        /**\n         * Trigger events on media queries. This class is usefull as a component for other controls to change some properties based on media queries\n         * @class WinJSContrib.UI.MediaTrigger\n         * @param {Object} items object containing one property for each query\n         * @param {Object} linkedControl control linked to media trigger\n         */\n        var MediaTrigger = (function () {\n            function MediaTrigger(items, linkedControl) {\n                var ctrl = this;\n                ctrl.queries = [];\n                ctrl.linkedControl = linkedControl;\n                for (var name in items) {\n                    var e = items[name];\n                    if (e.query) {\n                        ctrl.registerMediaEvent(name, e.query, e);\n                    }\n                }\n            }\n            /**\n             * @function WinJSContrib.UI.MediaTrigger.prototype.dispose\n             * release media trigger\n             */\n            MediaTrigger.prototype.dispose = function () {\n                var ctrl = this;\n                ctrl.linkedControl = null;\n                this.queries.forEach(function (q) {\n                    q.dispose();\n                });\n            };\n            /**\n             * register an event from a media query\n             * @function WinJSContrib.UI.MediaTrigger.prototype.registerMediaEvent\n             * @param {string} name event name\n             * @param {string} query media query\n             * @param {Object} data data associated with this query\n             */\n            MediaTrigger.prototype.registerMediaEvent = function (name, query, data) {\n                var ctrl = this;\n                var mq = window.matchMedia(query);\n                var internalQuery = {\n                    name: name,\n                    query: query,\n                    data: data,\n                    mq: mq,\n                    dispose: null\n                };\n                var f = function (arg) {\n                    if (arg.matches) {\n                        ctrl._mediaEvent(arg, internalQuery);\n                    }\n                };\n                mq.addListener(f);\n                internalQuery.dispose = function () {\n                    mq.removeListener(f);\n                };\n                ctrl.queries.push(internalQuery);\n            };\n            MediaTrigger.prototype._mediaEvent = function (arg, query) {\n                var ctrl = this;\n                if (ctrl.linkedControl) {\n                    WinJS.UI.setOptions(ctrl.linkedControl, query.data);\n                }\n                ctrl.dispatchEvent('media', query);\n            };\n            /**\n             * @function WinJSContrib.UI.MediaTrigger.prototype.check\n             * Check all registered queries\n             */\n            MediaTrigger.prototype.check = function () {\n                var ctrl = this;\n                ctrl.queries.forEach(function (q) {\n                    var mq = window.matchMedia(q.query);\n                    if (mq.matches) {\n                        ctrl._mediaEvent({ matches: true }, q);\n                    }\n                });\n            };\n            /**\n             * Adds an event listener to the control.\n             * @function WinJSContrib.UI.MediaTrigger.prototype.addEventListener\n             * @param type The type (name) of the event.\n             * @param listener The listener to invoke when the event gets raised.\n             * @param useCapture If true, initiates capture, otherwise false.\n            **/\n            MediaTrigger.prototype.addEventListener = function (type, listener, useCapture) {\n            };\n            /**\n             * Raises an event of the specified type and with the specified additional properties.\n             * @function WinJSContrib.UI.MediaTrigger.prototype.dispatchEvent\n             * @param type The type (name) of the event.\n             * @param eventProperties The set of additional properties to be attached to the event object when the event is raised.\n             * @returns true if preventDefault was called on the event.\n            **/\n            MediaTrigger.prototype.dispatchEvent = function (type, eventProperties) {\n                return false;\n            };\n            /**\n             * Removes an event listener from the control.\n             * @function WinJSContrib.UI.MediaTrigger.prototype.removeEventListener\n             * @param type The type (name) of the event.\n             * @param listener The listener to remove.\n             * @param useCapture true if capture is to be initiated, otherwise false.\n            **/\n            MediaTrigger.prototype.removeEventListener = function (type, listener, useCapture) { };\n            return MediaTrigger;\n        })();\n        UI.MediaTrigger = MediaTrigger;\n        WinJS.Class.mix(WinJSContrib.UI.MediaTrigger, WinJS.Utilities.eventMixin);\n        /**\n         * register navigation related events like hardware backbuttons. This method keeps track of previously registered navigation handlers\n         *  and disable them until the latests is closed, enablinh multi-level navigation.\n         * @function WinJSContrib.UI.registerNavigationEvents\n         * @param {Object} control control taking ownership of navigation handlers\n         * @param {function} callback callback to invoke when \"back\" is requested\n         * @returns {function} function to call for releasing navigation handlers\n         */\n        var registeredNavigationStack = [];\n        function registerNavigationEvents(control, callback) {\n            var locked = [];\n            var registration = { control: control, callback: callback };\n            registeredNavigationStack.push(registration);\n            //control.navLocks = control.navLocks || [];\n            //control.navLocks.isActive = true;\n            var backhandler = function (arg) {\n                var idx = registeredNavigationStack.indexOf(registration);\n                if (idx === registeredNavigationStack.length - 1) {\n                    registration.callback.bind(registration.control)(arg);\n                    idx--;\n                    while (idx >= 0 && !arg.handled) {\n                        var tmp = registeredNavigationStack[idx];\n                        tmp.callback.bind(tmp.control)(arg);\n                        idx--;\n                    }\n                }\n                //if (!control.navLocks || control.navLocks.length === 0) {\n                //    callback.bind(control)(arg);\n                //}\n            };\n            //var navcontrols = document.querySelectorAll('.mcn-navigation-ctrl');\n            //for (var i = 0; i < navcontrols.length; i++) {\n            //    var navigationCtrl = (<any>navcontrols[i]).winControl;\n            //    if (navigationCtrl && navigationCtrl != control) {\n            //        navigationCtrl.navLocks = navigationCtrl.navLocks || [];\n            //        if (navigationCtrl.navLocks.isActive && (!navigationCtrl.navLocks.length || navigationCtrl.navLocks.indexOf(control) < 0)) {\n            //            navigationCtrl.navLocks.push(control);\n            //            locked.push(navigationCtrl);\n            //        }\n            //    }\n            //}\n            function cancelNavigation(args) {\n                //this.eventTracker.addEvent(nav, 'beforenavigate', this._beforeNavigate.bind(this));\n                var p = new WinJS.Promise(function (c) { });\n                args.detail.setPromise(p);\n                //setImmediate(function () {\n                p.cancel();\n                //});\n            }\n            WinJS.Navigation.addEventListener('beforenavigate', cancelNavigation);\n            if (window.Windows && window.Windows.Phone)\n                window.Windows.Phone.UI.Input.HardwareButtons.addEventListener(\"backpressed\", backhandler);\n            else\n                document.addEventListener(\"backbutton\", backhandler);\n            var keypress = function (args) {\n                if (args.key === \"Esc\" || args.key === \"Backspace\") {\n                    backhandler(args);\n                }\n            };\n            document.body.addEventListener('keypress', keypress);\n            if (WinJSContrib.UI.Application && WinJSContrib.UI.Application.navigator)\n                WinJSContrib.UI.Application.navigator.addLock();\n            return function () {\n                if (WinJSContrib.UI.Application && WinJSContrib.UI.Application.navigator)\n                    WinJSContrib.UI.Application.navigator.removeLock();\n                //control.navLocks.isActive = false;\n                //locked.forEach(function (navigationCtrl) {\n                //    var idx = navigationCtrl.navLocks.indexOf(control);\n                //    if (idx >= 0)\n                //        navigationCtrl.navLocks.splice(idx, 1);\n                //});\n                var idx = registeredNavigationStack.indexOf(registration);\n                registeredNavigationStack.splice(idx, 1);\n                document.body.removeEventListener('keypress', keypress);\n                WinJS.Navigation.removeEventListener('beforenavigate', cancelNavigation);\n                if (window.Windows && window.Windows.Phone)\n                    window.Windows.Phone.UI.Input.HardwareButtons.removeEventListener(\"backpressed\", backhandler);\n                else\n                    document.removeEventListener(\"backbutton\", backhandler);\n            };\n        }\n        UI.registerNavigationEvents = registerNavigationEvents;\n        /**\n         * remove tap behavior\n         * @function WinJSContrib.UI.untap\n         * @param {HtmlElement} element element to clean\n         */\n        function untap(element) {\n            if (!element)\n                return;\n            if (element.mcnTapTracking) {\n                element.mcnTapTracking.dispose();\n                element.mcnTapTracking = null;\n            }\n        }\n        UI.untap = untap;\n        /**\n         * remove tap behavior from all childs\n         * @function WinJSContrib.UI.untapAll\n         * @param {HtmlElement} element element to clean\n         */\n        function untapAll(element) {\n            if (!element)\n                return;\n            var taps = element.querySelectorAll('.tap');\n            for (var i = 0, l = taps.length; i < l; i++) {\n                untap(taps[i]);\n            }\n        }\n        UI.untapAll = untapAll;\n        /**\n         * add tap behavior to an element, tap manages quirks like click delay, visual feedback, etc\n         * @function WinJSContrib.UI.tap\n         * @param {HtmlElement} element element to make \"tappable\"\n         * @param {function} callback callback function invoked on tap\n         * @param {Object} options tap options\n         */\n        function tap(element, callback, options) {\n            if (!element)\n                return;\n            var ptDown = function (event) {\n                var elt = event.currentTarget || event.target;\n                var tracking = elt.mcnTapTracking;\n                if (tracking && (event.button === undefined || event.button === 0 || (tracking.allowRickClickTap && event.button === 2))) {\n                    if (tracking.lock) {\n                        if (event.pointerId && event.currentTarget.setPointerCapture)\n                            event.currentTarget.setPointerCapture(event.pointerId);\n                        event.stopPropagation();\n                        event.preventDefault();\n                    }\n                    WinJS.Utilities.addClass(elt, 'tapped');\n                    if (event.changedTouches) {\n                        tracking.pointerdown = { x: event.changedTouches[0].clientX, y: event.changedTouches[0].clientY };\n                    }\n                    else {\n                        tracking.pointerdown = { x: event.clientX, y: event.clientY };\n                    }\n                    tracking.animDown(event.currentTarget);\n                    if (tracking.tapOnDown) {\n                        tracking.callback(elt, event);\n                    }\n                }\n            };\n            var ptOut = function (event) {\n                var elt = event.currentTarget || event.target;\n                var tracking = elt.mcnTapTracking;\n                if (tracking && tracking.pointerdown) {\n                    WinJS.Utilities.removeClass(elt, 'tapped');\n                    if (event.pointerId && elt.releasePointerCapture) {\n                        try {\n                            elt.releasePointerCapture(event.pointerId);\n                        }\n                        catch (exception) {\n                            console.error(exception);\n                        }\n                    }\n                    if (!tracking.disableAnimation)\n                        tracking.animUp(event.currentTarget);\n                }\n            };\n            var ptUp = function (event) {\n                var elt = event.currentTarget || event.target;\n                var tracking = elt.mcnTapTracking;\n                if (tracking && (event.button === undefined || event.button === 0 || (tracking.allowRickClickTap && event.button === 2))) {\n                    if (elt.releasePointerCapture) {\n                        try {\n                            elt.releasePointerCapture(event.pointerId);\n                        }\n                        catch (exception) {\n                            console.error(exception);\n                        }\n                    }\n                    if (tracking && !tracking.tapOnDown) {\n                        event.stopPropagation();\n                        var resolveTap = function () {\n                            if (tracking && tracking.pointerdown) {\n                                if (event.changedTouches) {\n                                    var dX = Math.abs(tracking.pointerdown.x - event.changedTouches[0].clientX);\n                                    var dY = Math.abs(tracking.pointerdown.y - event.changedTouches[0].clientY);\n                                }\n                                else {\n                                    var dX = Math.abs(tracking.pointerdown.x - event.clientX);\n                                    var dY = Math.abs(tracking.pointerdown.y - event.clientY);\n                                }\n                                if (tracking.callback && dX < 15 && dY < 15) {\n                                    event.stopImmediatePropagation();\n                                    event.stopPropagation();\n                                    event.preventDefault();\n                                    var res = tracking.callback(elt, event);\n                                    if (WinJS.Promise.is(res)) {\n                                        elt.disabled = true;\n                                        WinJS.Utilities.addClass(elt, 'working');\n                                        res.then(function () {\n                                            elt.disabled = false;\n                                            WinJS.Utilities.removeClass(elt, 'working');\n                                        });\n                                    }\n                                }\n                                if (tracking && tracking.pointerdown)\n                                    tracking.pointerdown = undefined;\n                            }\n                        };\n                        if (tracking.awaitAnim) {\n                            tracking.animUp(elt).done(resolveTap);\n                        }\n                        else {\n                            tracking.animUp(elt);\n                            resolveTap();\n                        }\n                    }\n                    WinJS.Utilities.removeClass(elt, 'tapped');\n                }\n            };\n            var opt = options || {};\n            if (element.mcnTapTracking) {\n                element.mcnTapTracking.dispose();\n            }\n            WinJS.Utilities.addClass(element, 'tap');\n            element.mcnTapTracking = element.mcnTapTracking || {};\n            element.mcnTapTracking.eventTracker = new WinJSContrib.UI.EventTracker();\n            element.mcnTapTracking.disableAnimation = opt.disableAnimation;\n            if (element.mcnTapTracking.disableAnimation) {\n                element.mcnTapTracking.animDown = function () { return WinJS.Promise.wrap(); };\n                element.mcnTapTracking.animUp = function () { return WinJS.Promise.wrap(); };\n            }\n            else {\n                element.mcnTapTracking.animDown = opt.animDown || WinJS.UI.Animation.pointerDown;\n                element.mcnTapTracking.animUp = opt.animUp || WinJS.UI.Animation.pointerUp;\n            }\n            element.mcnTapTracking.element = element;\n            element.mcnTapTracking.callback = callback;\n            element.mcnTapTracking.lock = opt.lock;\n            element.mcnTapTracking.awaitAnim = opt.awaitAnim || false;\n            element.mcnTapTracking.disableAnimation = opt.disableAnimation;\n            element.mcnTapTracking.tapOnDown = opt.tapOnDown;\n            element.mcnTapTracking.pointerModel = 'none';\n            element.mcnTapTracking.dispose = function () {\n                WinJS.Utilities.removeClass(element, 'tap');\n                this.eventTracker.dispose();\n                element.mcnTapTracking = null;\n                element = null;\n            };\n            if (element.onpointerdown !== undefined) {\n                element.mcnTapTracking.pointerModel = 'pointers';\n                element.mcnTapTracking.eventTracker.addEvent(element, 'pointerdown', ptDown);\n                element.mcnTapTracking.eventTracker.addEvent(element, 'pointerout', ptOut);\n                element.mcnTapTracking.eventTracker.addEvent(element, 'pointerup', ptUp);\n            }\n            else if (window.Touch && !opt.noWebkitTouch) {\n                element.mcnTapTracking.pointerModel = 'touch';\n                element.mcnTapTracking.eventTracker.addEvent(element, 'touchstart', function (arg) {\n                    element.mcnTapTracking.cancelMouse = true;\n                    ptDown(arg);\n                });\n                element.mcnTapTracking.eventTracker.addEvent(element, 'touchcancel', function (arg) {\n                    setTimeout(function () {\n                        element.mcnTapTracking.cancelMouse = false;\n                    }, 1000);\n                    ptOut(arg);\n                });\n                element.mcnTapTracking.eventTracker.addEvent(element, 'touchend', function (arg) {\n                    setTimeout(function () {\n                        element.mcnTapTracking.cancelMouse = false;\n                    }, 1000);\n                    ptUp(arg);\n                });\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mousedown', function (arg) {\n                    if (!element.mcnTapTracking.cancelMouse)\n                        ptDown(arg);\n                });\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mouseleave', function (arg) {\n                    ptOut(arg);\n                });\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mouseup', function (arg) {\n                    if (!element.mcnTapTracking.cancelMouse)\n                        ptUp(arg);\n                    else\n                        ptOut(arg);\n                });\n            }\n            else {\n                element.mcnTapTracking.pointerModel = 'mouse';\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mousedown', ptDown);\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mouseleave', ptOut);\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mouseup', ptUp);\n            }\n        }\n        UI.tap = tap;\n        /**\n         * return a promise completed after css transition on the element is ended\n         * @function WinJSContrib.UI.afterTransition\n         * @param {HtmlElement} element element to watch\n         * @param {number} timeout timeout\n         */\n        function afterTransition(element, timeout) {\n            var timeOutRef = null;\n            return new WinJS.Promise(function (complete, error) {\n                var onaftertransition = function (event) {\n                    if (event.srcElement === element) {\n                        close();\n                    }\n                };\n                var close = function () {\n                    clearTimeout(timeOutRef);\n                    element.removeEventListener(\"transitionend\", onaftertransition, false);\n                    complete();\n                };\n                element.addEventListener(\"transitionend\", onaftertransition, false);\n                timeOutRef = setTimeout(close, timeout || 1000);\n            });\n        }\n        UI.afterTransition = afterTransition;\n        /**\n         * Utility class for building DOM elements through code with a fluent API\n         * @class WinJSContrib.UI.FluentDOM\n         * @param {string} nodeType type of DOM node (ex: 'DIV')\n         * @param className css classes\n         * @param parentElt parent DOM element\n         * @param {WinJSContrib.UI.FluentDOM} parent parent FluentDOM\n         * @example\n         * var elt = new WinJSContrib.UI.FluentDOM('DIV', 'item-content')\n         *    .text(item.title)\n         *    .display('none')\n         *    .element;\n         */\n        var FluentDOM = (function () {\n            function FluentDOM(nodeType, className, parentElt, parent) {\n                this.element = document.createElement(nodeType);\n                if (className)\n                    this.element.className = className;\n                if (parentElt)\n                    parentElt.appendChild(this.element);\n                this.parent = parent;\n                this.childs = [];\n                if (parent) {\n                    parent.childs.push(this);\n                }\n            }\n            FluentDOM.for = function (element) {\n                var res = new FluentDOM(null);\n                res.element = element;\n                return res;\n            };\n            FluentDOM.fragment = function () {\n                var res = new FluentDOM(null);\n                res.element = document.createDocumentFragment();\n                return res;\n            };\n            Object.defineProperty(FluentDOM.prototype, \"control\", {\n                get: function () {\n                    return this.element.winControl;\n                },\n                enumerable: true,\n                configurable: true\n            });\n            /**\n             * Add a css class\n             * @function WinJSContrib.UI.FluentDOM.prototype.addClass\n             * @param classname css class\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.addClass = function (classname) {\n                this.element.classList.add(classname);\n                return this;\n            };\n            /**\n             * set className\n             * @function WinJSContrib.UI.FluentDOM.prototype.className\n             * @param classname css classes\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.className = function (classname) {\n                this.element.className = classname;\n                return this;\n            };\n            /**\n             * set opacity\n             * @function WinJSContrib.UI.FluentDOM.prototype.opacity\n             * @param opacity opacity\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.opacity = function (opacity) {\n                this.element.style.opacity = opacity;\n                return this;\n            };\n            /**\n             * set display\n             * @function WinJSContrib.UI.FluentDOM.prototype.display\n             * @param display display\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.display = function (display) {\n                this.element.style.display = display;\n                return this;\n            };\n            /**\n             * set display 'none'\n             * @function WinJSContrib.UI.FluentDOM.prototype.hide\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.hide = function () {\n                this.element.style.display = 'none';\n                return this;\n            };\n            /**\n             * set visibility\n             * @function WinJSContrib.UI.FluentDOM.prototype.visibility\n             * @param visibility visibility\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.visibility = function (visibility) {\n                this.element.style.visibility = visibility;\n                return this;\n            };\n            /**\n             * set textContent\n             * @function WinJSContrib.UI.FluentDOM.prototype.text\n             * @param text text\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.text = function (text) {\n                this.element.textContent = text;\n                return this;\n            };\n            /**\n             * set innerHTML\n             * @function WinJSContrib.UI.FluentDOM.prototype.html\n             * @param text text\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.html = function (text) {\n                this.element.innerHTML = text;\n                return this;\n            };\n            /**\n             * set attribute\n             * @function WinJSContrib.UI.FluentDOM.prototype.attr\n             * @param name attribute name\n             * @param val attribute value\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.attr = function (name, val) {\n                this.element.setAttribute(name, val);\n                return this;\n            };\n            /**\n             * set style property\n             * @function WinJSContrib.UI.FluentDOM.prototype.style\n             * @param name attribute name\n             * @param val attribute value\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.style = function (name, val) {\n                this.element.style[name] = val;\n                return this;\n            };\n            /**\n             * set style property\n             * @function WinJSContrib.UI.FluentDOM.prototype.style\n             * @param name attribute name\n             * @param val attribute value\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.styles = function (obj) {\n                var st = this.element.style;\n                var keys = Object.keys(obj);\n                keys.forEach(function (k) {\n                    st[k] = obj[k];\n                });\n                return this;\n            };\n            /**\n             * append element to another DOM element\n             * @function WinJSContrib.UI.FluentDOM.prototype.appendTo\n             * @param elt parent element\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.appendTo = function (elt) {\n                elt.appendChild(this.element);\n                return this;\n            };\n            /**\n             * add tap behavior\n             * @function WinJSContrib.UI.FluentDOM.prototype.tap\n             * @param callback tap callback\n             * @param options tap options\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.tap = function (callback, options) {\n                WinJSContrib.UI.tap(this.element, callback, options);\n                return this;\n            };\n            /**\n             * create a child FluentDOM and append it to current\n             * @function WinJSContrib.UI.FluentDOM.prototype.append\n             * @param nodeType child node type\n             * @param className css classes\n             * @param callback callback receiving the new FluentDOM as an argument\n             * @returns {WinJSContrib.UI.FluentDOM} current instance (for method chaining)\n             */\n            FluentDOM.prototype.append = function (nodeType, className, callback) {\n                var child = new FluentDOM(nodeType, className, this.element, this);\n                if (callback) {\n                    callback(child);\n                }\n                return this;\n            };\n            /**\n             * create a child FluentDOM and append it to current\n             * @function WinJSContrib.UI.FluentDOM.prototype.createChild\n             * @param nodeType child node type\n             * @param className css classes\n             * @returns {WinJSContrib.UI.FluentDOM} child FluentDOM\n             */\n            FluentDOM.prototype.createChild = function (nodeType, className) {\n                var child = new FluentDOM(nodeType, className, this.element, this);\n                return child;\n            };\n            /**\n             * create a WinJS control\n             * @function WinJSContrib.UI.FluentDOM.prototype.ctrl\n             * @param ctrl constructor or full name of the control\n             * @param options control options\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.ctrl = function (ctrl, options) {\n                var ctor = ctrl;\n                if (typeof ctrl === 'string')\n                    ctor = WinJSContrib.Utils.readProperty(window, ctrl);\n                if (ctor) {\n                    new ctor(this.element, options);\n                }\n                return this;\n            };\n            return FluentDOM;\n        })();\n        UI.FluentDOM = FluentDOM;\n    })(UI = WinJSContrib.UI || (WinJSContrib.UI = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar __global = this;\nvar profiler = __global.msWriteProfilerMark || function () { };\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var UI;\n    (function (UI) {\n        var Pages;\n        (function (Pages) {\n            /**\n             * List of mixins to apply to each fragment managed by WinJS Contrib (through navigator or by calling explicitely {@link WinJSContrib.UI.Pages.fragmentMixin}).\n             * @field WinJSContrib.UI.Pages.defaultFragmentMixins\n             * @type {Array}\n             */\n            Pages.defaultFragmentMixins = [{\n                    $: function (selector) {\n                        return $(selector, this.element || this._element);\n                    },\n                    q: function (selector) {\n                        if (!this.element)\n                            return;\n                        return this.element.querySelector(selector);\n                    },\n                    qAll: function (selector) {\n                        if (!this.element)\n                            return;\n                        var res = this.element.querySelectorAll(selector);\n                        if (res && !res.forEach) {\n                            res = [].slice.call(res);\n                        }\n                        return res;\n                    },\n                },\n                {\n                    dispose: function () {\n                        if (this._promises) {\n                            this.cancelPromises();\n                            this._promises = null;\n                        }\n                    },\n                    promises: {\n                        configurable: true,\n                        get: function () {\n                            if (!this._promises)\n                                this._promises = [];\n                            return this._promises;\n                        }\n                    },\n                    addPromise: function (prom) {\n                        this.promises.push(prom);\n                        return prom;\n                    },\n                    cancelPromises: function () {\n                        var page = this;\n                        if (page.promises) {\n                            for (var i = 0; i < page.promises.length; i++) {\n                                if (page.promises[i]) {\n                                    page.promises[i].cancel();\n                                }\n                            }\n                            page.promises = [];\n                        }\n                    }\n                },\n                {\n                    dispose: function () {\n                        if (this._eventTracker) {\n                            this._eventTracker.dispose();\n                            this._eventTracker = null;\n                        }\n                    },\n                    eventTracker: {\n                        configurable: true,\n                        get: function () {\n                            if (!this._eventTracker)\n                                this._eventTracker = new WinJSContrib.UI.EventTracker();\n                            return this._eventTracker;\n                        }\n                    }\n                }];\n            function broadcast(ctrl, element, eventName, args, before, after) {\n                var promises = [];\n                if (before)\n                    promises.push(WinJS.Promise.as(before.apply(ctrl, args)));\n                var query = element.querySelectorAll(\".mcn-layout-ctrl\");\n                if (query && query.length) {\n                    var index = 0;\n                    var length = query.length;\n                    while (index < length) {\n                        var childctrl = query[index];\n                        if (childctrl) {\n                            var event = childctrl.winControl[eventName];\n                            if (event) {\n                                if (childctrl.winControl.pageLifeCycle) {\n                                    promises.push(childctrl.winControl.pageLifeCycle.steps.layout.promise);\n                                }\n                                else {\n                                    promises.push(WinJS.Promise.as(event.apply(childctrl.winControl, args)));\n                                }\n                            }\n                        }\n                        // Skip descendants\n                        if (childctrl && childctrl.winControl && childctrl.winControl.pageLifeCycle) {\n                            index += childctrl.querySelectorAll(\".mcn-fragment, .mcn-layout-ctrl\").length + 1;\n                            childctrl.winControl.__checkLayout();\n                        }\n                        else {\n                            index += 1;\n                        }\n                    }\n                    //if (after)\n                    //    promises.push(WinJS.Promise.as(after.apply(ctrl, args)));\n                    return WinJS.Promise.join(promises).then(function () {\n                        if (after)\n                            return WinJS.Promise.as(after.apply(ctrl, args));\n                    });\n                }\n                else {\n                    if (after)\n                        return WinJS.Promise.as(after.apply(ctrl, args));\n                    return WinJS.Promise.wrap();\n                }\n            }\n            /**\n             * render a html fragment with winjs contrib pipeline and properties, and add WinJS Contrib page events.\n             * @function WinJSContrib.UI.Pages.renderFragment\n             * @param {HTMLElement} container element that will contain the fragment\n             * @param {string} location url for the fragment\n             * @param {Object} args arguments to the fragment\n             * @param {Object} options rendering options\n             */\n            function renderFragment(container, location, args, options) {\n                var fragmentCompleted;\n                var fragmentError;\n                options = options || {};\n                var element = document.createElement(\"div\");\n                element.setAttribute(\"dir\", __global.getComputedStyle(element, null).direction);\n                element.style.opacity = '0';\n                container.appendChild(element);\n                var fragmentPromise = new WinJS.Promise(function (c, e) { fragmentCompleted = c; fragmentError = e; });\n                var parented = options.parented ? WinJS.Promise.as(options.parented) : null;\n                var layoutCtrls = [];\n                var pageConstructor = WinJS.UI.Pages.get(location);\n                function preparePageControl(elementCtrl) {\n                    if (args && args.injectToPage) {\n                        WinJSContrib.Utils.inject(elementCtrl, args.injectToPage);\n                    }\n                    elementCtrl.navigationState = { location: location, state: args };\n                    if (options.oncreate) {\n                        options.oncreate(elementCtrl.element, args);\n                    }\n                    if (options.oninit) {\n                        elementCtrl.pageLifeCycle.steps.init.attach(function () {\n                            return options.oninit(elementCtrl.element, args);\n                        });\n                    }\n                    if (elementCtrl.enterPageAnimation || options.enterPage) {\n                        if (elementCtrl.enterPageAnimation)\n                            elementCtrl._enterAnimation = elementCtrl.enterPageAnimation;\n                        else\n                            elementCtrl._enterAnimation = options.enterPage;\n                        elementCtrl.enterPageAnimation = function () {\n                            var page = this;\n                            var elts = null;\n                            element.style.opacity = '';\n                            if (page && page.getAnimationElements) {\n                                elts = page.getAnimationElements(false);\n                            }\n                            else {\n                                elts = page.element;\n                            }\n                            if (elts)\n                                return page._enterAnimation(elts);\n                        };\n                    }\n                    if (options.onrender) {\n                        elementCtrl.pageLifeCycle.steps.process.attach(function () {\n                            options.onrender(elementCtrl.element, args);\n                        });\n                    }\n                    if (!WinJSContrib.UI.disableAutoResources) {\n                        elementCtrl.pageLifeCycle.steps.process.attach(function () {\n                            return WinJS.Resources.processAll(element);\n                        });\n                    }\n                    if (options.closeOldPagePromise) {\n                        elementCtrl.pageLifeCycle.steps.ready.attach(function () {\n                            return options.closeOldPagePromise;\n                        });\n                    }\n                    elementCtrl.pageLifeCycle.steps.ready.attach(function () {\n                        if (options.onready)\n                            options.onready(elementCtrl.element, args);\n                        if (elementCtrl.enterPageAnimation) {\n                            return WinJS.Promise.as(elementCtrl.enterPageAnimation(element, options));\n                        }\n                        else {\n                            elementCtrl.element.style.opacity = '';\n                        }\n                    });\n                    elementCtrl.pageLifeCycle.steps.ready.promise.then(fragmentCompleted, fragmentError);\n                }\n                var elementCtrl = new pageConstructor(element, args, preparePageControl, parented);\n                return fragmentPromise;\n            }\n            Pages.renderFragment = renderFragment;\n            var PageLifeCycleStep = (function () {\n                function PageLifeCycleStep(page, stepName, parent) {\n                    var _this = this;\n                    this.queue = [];\n                    this.isDone = false;\n                    this.stepName = stepName;\n                    //this.created = new Date();\n                    this.promise = new WinJS.Promise(function (c, e) {\n                        _this._resolvePromise = c;\n                        _this._rejectPromise = e;\n                    });\n                    page.promises.push(this.promise);\n                    //if their is a parent page fragment, we attach step to synchronize page construction\n                    if (parent && parent.pageLifeCycle) {\n                        parent.pageLifeCycle.steps[stepName].attach(function () {\n                            return _this.promise;\n                        });\n                    }\n                }\n                PageLifeCycleStep.prototype.attach = function (callback) {\n                    if (this.queue && !this.isDone) {\n                        this.queue.push(callback);\n                        return this.promise;\n                    }\n                    else {\n                        return WinJS.Promise.as(callback());\n                    }\n                };\n                PageLifeCycleStep.prototype.resolve = function (arg) {\n                    var step = this;\n                    this.isDone = true;\n                    function closeStep() {\n                        //step.resolved = new Date();\n                        step._resolvePromise(arg);\n                        //console.log('resolved ' + step.stepName + '(' + (<any>step.resolved - <any>step.created) + 'ms)');\n                        return step.promise;\n                    }\n                    if (this.queue && this.queue.length) {\n                        var promises = [];\n                        this.queue.forEach(function (q) {\n                            promises.push(new WinJS.Promise(function (c, e) {\n                                try {\n                                    WinJS.Promise.as(q()).then(function (res) {\n                                        c(res);\n                                    }, e);\n                                }\n                                catch (exception) {\n                                    e(exception);\n                                }\n                            }));\n                        });\n                        this.queue = null;\n                        return WinJS.Promise.join(promises).then(function () {\n                            return closeStep();\n                        }, this.reject.bind(this));\n                    }\n                    else {\n                        this.queue = null;\n                        return closeStep();\n                    }\n                };\n                PageLifeCycleStep.prototype.reject = function (arg) {\n                    this.isDone = true;\n                    this.queue = null;\n                    this._rejectPromise(arg);\n                    return WinJS.Promise.wrapError(this.promise);\n                };\n                return PageLifeCycleStep;\n            })();\n            Pages.PageLifeCycleStep = PageLifeCycleStep;\n            (function (_Pages, _Global, _Base, _CorePages, _BaseUtils, _ElementUtilities, _WriteProfilerMark, Promise, Fragments, ControlProcessor) {\n                'use strict';\n                if (!_Global.document || !_CorePages)\n                    return;\n                var viewMap = _CorePages._viewMap || _CorePages.viewMap || {};\n                //this property allows defining mixins applyed to all pages\n                function abs(uri) {\n                    var a = _Global.document.createElement(\"a\");\n                    a.href = uri;\n                    return a.href;\n                }\n                function selfhost(uri) {\n                    return _Global.document.location.href.toLowerCase() === uri.toLowerCase();\n                }\n                var _mixinBase = {\n                    dispose: function () {\n                        /// <signature helpKeyword=\"WinJS.UI.Pages.dispose\">\n                        /// <summary locid=\"WinJS.UI.Pages.dispose\">\n                        /// Disposes this Page.\n                        /// </summary>\n                        /// </signature>\n                        if (this._disposed) {\n                            return;\n                        }\n                        this.pageLifeCycle.stop();\n                        this.pageLifeCycle = null;\n                        this._disposed = true;\n                        this.readyComplete.cancel();\n                        _ElementUtilities.disposeSubTree(this.element);\n                        this.element = null;\n                    },\n                    init: function () {\n                    },\n                    load: function (uri) {\n                        /// <signature helpKeyword=\"WinJS.UI.Pages._mixin.load\">\n                        /// <summary locid=\"WinJS.UI.Pages._mixin.load\">\n                        /// Creates a copy of the DOM elements from the specified URI.  In order for this override\n                        /// to be used, the page that contains the load override needs to be defined by calling\n                        /// WinJS.UI.Pages.define() before WinJS.UI.Pages.render() is called.\n                        /// </summary>\n                        /// <param name=\"uri\" locid=\"WinJS.UI.Pages._mixin.load_p:uri\">\n                        /// The URI from which to copy the DOM elements.\n                        /// </param>\n                        /// <returns type=\"WinJS.Promise\" locid=\"WinJS.UI.Pages._mixin.load_returnValue\">\n                        /// A promise whose fulfilled value is the set of unparented DOM elements, if asynchronous processing is necessary. If not, returns nothing.\n                        /// </returns>\n                        /// </signature>\n                        if (!this.selfhost) {\n                            return Fragments.renderCopy(abs(uri));\n                        }\n                    },\n                    process: function (element, options) {\n                        /// <signature helpKeyword=\"WinJS.UI.Pages._mixin.process\">\n                        /// <summary locid=\"WinJS.UI.Pages._mixin.process\">\n                        /// Processes the unparented DOM elements returned by load.\n                        /// </summary>\n                        /// <param name=\"element\" locid=\"WinJS.UI.Pages._mixin.process_p:element\">\n                        /// The DOM element that will contain all the content for the page.\n                        /// </param>\n                        /// <param name=\"options\" locid=\"WinJS.UI.Pages._mixin.process_p:options\">\n                        /// The options that are to be passed to the constructor of the page.\n                        /// </param>\n                        /// <returns type=\"WinJS.Promise\" locid=\"WinJS.UI.Pages._mixin.process_returnValue\">\n                        /// A promise that is fulfilled when processing is complete.\n                        /// </returns>\n                        /// </signature>\n                        return ControlProcessor.processAll(element);\n                    },\n                    processed: function (element, options) { },\n                    render: function (element, options, loadResult) {\n                        /// <signature helpKeyword=\"WinJS.UI.Pages._mixin.render\">\n                        /// <summary locid=\"WinJS.UI.Pages._mixin.render\">\n                        /// Renders the control, typically by adding the elements specified in the loadResult parameter to the specified element.\n                        /// </summary>\n                        /// <param name=\"element\" locid=\"WinJS.UI.Pages._mixin.render_p:element\">\n                        /// The DOM element that will contain all the content for the page.\n                        /// </param>\n                        /// <param name=\"options\" locid=\"WinJS.UI.Pages._mixin.render_p:options\">\n                        /// The options passed into the constructor of the page.\n                        /// </param>\n                        /// <param name=\"loadResult\" locid=\"WinJS.UI.Pages._mixin.render_p:loadResult\">\n                        /// The elements returned from the load method.\n                        /// </param>\n                        /// <returns type=\"WinJS.Promise\" locid=\"WinJS.UI.Pages._mixin.render_returnValue\">\n                        /// A promise that is fulfilled when rendering is complete, if asynchronous processing is necessary. If not, returns nothing.\n                        /// </returns>\n                        /// </signature>\n                        if (!this.selfhost) {\n                            element.appendChild(loadResult);\n                        }\n                        return element;\n                    },\n                    rendered: function (element, options) { },\n                    ready: function () { }\n                };\n                function injectMixin(base, mixin) {\n                    var d = base.prototype.dispose;\n                    base = _Base.Class.mix(base, mixin);\n                    //we want to allow this mixins to provide their own addition to \"dispose\"\n                    if (d && mixin.hasOwnProperty('dispose')) {\n                        base.prototype.dispose = function () {\n                            mixin.dispose.apply(this);\n                            d.apply(this);\n                        };\n                    }\n                    return base;\n                }\n                function mergeJavaScriptClass(baseCtor, classDef) {\n                    var keys = Object.keys(baseCtor.prototype);\n                    keys.forEach(function (k) {\n                        if (classDef.prototype[k] === undefined) {\n                            classDef.prototype[k] = baseCtor.prototype[k];\n                        }\n                    });\n                    return baseCtor;\n                }\n                function addMembers(ctor, members) {\n                    if (!members)\n                        return ctor;\n                    if (typeof members == 'function') {\n                        ctor.prototype._attachedConstructor = members;\n                        return mergeJavaScriptClass(ctor, members);\n                    }\n                    else if (typeof members == 'object') {\n                        return injectMixin(ctor, members);\n                    }\n                    return ctor;\n                }\n                function pageLifeCycle(that, uri, element, options, complete, parentedPromise) {\n                    if (element.style.display)\n                        that.pageLifeCycle.initialDisplay = element.style.display;\n                    element.style.display = 'none';\n                    var profilerMarkIdentifier = \" uri='\" + uri + \"'\" + _BaseUtils._getProfilerMarkIdentifier(that.element);\n                    _WriteProfilerMark(\"WinJS.UI.Pages:createPage\" + profilerMarkIdentifier + \",StartTM\");\n                    if (WinJSContrib.UI.WebComponents) {\n                        that.pageLifeCycle.observer = WinJSContrib.UI.WebComponents.watch(that.element);\n                    }\n                    var load = Promise.timeout().then(function Pages_load() {\n                        return that.load(uri);\n                    }).then(function (loadResult) {\n                        //if page is defined by Js classes, call class constructors \n                        if (that._attachedConstructor) {\n                            var realControl = new that._attachedConstructor(element, options);\n                            element.winControl = realControl;\n                            var keys = Object.keys(that);\n                            keys.forEach(function (k) {\n                                realControl[k] = that[k];\n                            });\n                            realControl.pageLifeCycle.page = realControl;\n                            that.pageControl = realControl;\n                            that.dismissed = true;\n                            that = realControl;\n                        }\n                        return loadResult;\n                    });\n                    var renderCalled = load.then(function Pages_init(loadResult) {\n                        return Promise.join({\n                            loadResult: loadResult,\n                            initResult: that.init(element, options)\n                        });\n                    }).then(function Pages_render(result) {\n                        return that.pageLifeCycle.steps.init.resolve().then(function () {\n                            return result;\n                        });\n                    }).then(function Pages_render(result) {\n                        return that.render(element, options, result.loadResult);\n                    }).then(function Pages_render(result) {\n                        return that.rendered(element, options);\n                    }).then(function (result) {\n                        return that.pageLifeCycle.steps.render.resolve();\n                    }).then(function Pages_processed() {\n                        if (WinJSContrib.UI.WebComponents) {\n                            //add delay to enable webcomponent processing\n                            return WinJS.Promise.timeout();\n                        }\n                    });\n                    that.elementReady = renderCalled.then(function () {\n                        return element;\n                    });\n                    that.renderComplete = renderCalled.then(function Pages_process() {\n                        return that.process(element, options);\n                    }).then(function (result) {\n                        return that.pageLifeCycle.steps.process.resolve();\n                    }).then(function Pages_processed() {\n                        WinJSContrib.UI.bindMembers(element, that);\n                        return that.processed(element, options);\n                    }).then(function () {\n                        return that;\n                    });\n                    var callComplete = function () {\n                        complete && complete(that);\n                        _WriteProfilerMark(\"WinJS.UI.Pages:createPage\" + profilerMarkIdentifier + \",StopTM\");\n                    };\n                    // promises guarantee order, so this will be called prior to ready path below\n                    //\n                    that.renderComplete.then(callComplete, callComplete);\n                    that.layoutComplete = that.renderComplete.then(function () {\n                        return parentedPromise;\n                    }).then(function () {\n                        element.style.display = that.pageLifeCycle.initialDisplay || '';\n                        var r = element.getBoundingClientRect(); //force element layout\n                        return broadcast(that, element, 'pageLayout', [element, options], null, that.pageLayout);\n                    }).then(function () {\n                        WinJSContrib.UI.bindActions(element, that);\n                    }).then(function (result) {\n                        return that.pageLifeCycle.steps.layout.resolve();\n                    }).then(function () {\n                        return that;\n                    });\n                    that.readyComplete = that.layoutComplete.then(function Pages_ready() {\n                        that.ready(element, options);\n                        that.pageLifeCycle.ended = new Date();\n                        that.pageLifeCycle.delta = that.pageLifeCycle.ended - that.pageLifeCycle.created;\n                        console.log('navigation to ' + uri + ' took ' + that.pageLifeCycle.delta + 'ms');\n                        //broadcast(that, element, 'pageReady', [element, options]);\n                    }).then(function (result) {\n                        return that.pageLifeCycle.steps.ready.resolve();\n                    }).then(function () {\n                        return that;\n                    }).then(null, function Pages_error(err) {\n                        if (that.error)\n                            return that.error(err);\n                        if (err && err._value && err._value.name === \"Canceled\")\n                            return;\n                        return WinJS.Promise.wrapError(err);\n                    });\n                    that.__checkLayout = function () {\n                        var page = this;\n                        var updateLayoutArgs = arguments;\n                        var p = null;\n                        if (page.updateLayout) {\n                            p = WinJS.Promise.as(page.updateLayout.apply(page, updateLayoutArgs));\n                        }\n                        else {\n                            p = WinJS.Promise.wrap();\n                        }\n                        return p.then(function () {\n                            return broadcast(page, page.element, 'updateLayout', updateLayoutArgs);\n                        });\n                    };\n                }\n                function getPageConstructor(uri, members) {\n                    /// <signature helpKeyword=\"WinJS.UI.Pages.define\">\n                    /// <summary locid=\"WinJS.UI.Pages.define\">\n                    /// Creates a new page control from the specified URI that contains the specified members.\n                    /// Multiple calls to this method for the same URI are allowed, and all members will be\n                    /// merged.\n                    /// </summary>\n                    /// <param name=\"uri\" locid=\"WinJS.UI.Pages.define_p:uri\">\n                    /// The URI for the content that defines the page.\n                    /// </param>\n                    /// <param name=\"members\" locid=\"WinJS.UI.Pages.define_p:members\">\n                    /// Additional members that the control will have.\n                    /// </param>\n                    /// <returns type=\"Function\" locid=\"WinJS.UI.Pages.define_returnValue\">\n                    /// A constructor function that creates the page.\n                    /// </returns>\n                    /// </signature>\n                    var refUri = abs(uri).toLowerCase();\n                    var base = viewMap[refUri];\n                    uri = abs(uri);\n                    if (!base) {\n                        base = _Base.Class.define(\n                        // This needs to follow the WinJS.UI.processAll \"async constructor\"\n                        // pattern to interop nicely in the \"Views.Control\" use case.\n                        //\n                        // This needs to follow the WinJS.UI.processAll \"async constructor\"\n                        // pattern to interop nicely in the \"Views.Control\" use case.\n                        //\n                        function PageControl_ctor(element, options, complete, parentedPromise) {\n                            var that = this;\n                            var parent = WinJSContrib.Utils.getScopeControl(element);\n                            _ElementUtilities.addClass(element, \"win-disposable\");\n                            _ElementUtilities.addClass(element, \"pagecontrol\");\n                            _ElementUtilities.addClass(element, \"mcn-layout-ctrl\");\n                            that.pageLifeCycle = {\n                                created: new Date(),\n                                location: uri,\n                                stop: function () {\n                                    that.readyComplete.cancel();\n                                    that.cancelPromises();\n                                    if (this.observer) {\n                                        this.observer.disconnect();\n                                        this.observer = null;\n                                    }\n                                },\n                                steps: {\n                                    init: new PageLifeCycleStep(that, 'init', null),\n                                    render: new PageLifeCycleStep(that, 'render', null),\n                                    process: new PageLifeCycleStep(that, 'process', parent),\n                                    layout: new PageLifeCycleStep(that, 'layout', parent),\n                                    ready: new PageLifeCycleStep(that, 'ready', parent)\n                                },\n                                initialDisplay: null\n                            };\n                            this._disposed = false;\n                            this.element = element = element || _Global.document.createElement(\"div\");\n                            element.msSourceLocation = uri;\n                            this.uri = uri;\n                            this.selfhost = selfhost(uri);\n                            element.winControl = this;\n                            that.parentedComplete = parentedPromise;\n                            pageLifeCycle(this, uri, element, options, complete, parentedPromise);\n                        }, _mixinBase);\n                        base = _Base.Class.mix(base, WinJS.UI.DOMEventMixin);\n                        //inject default behaviors to page constructor\n                        WinJSContrib.UI.Pages.defaultFragmentMixins.forEach(function (mixin) {\n                            injectMixin(base, mixin);\n                        });\n                        //WinJSContrib.UI.Pages.fragmentMixin(base);\n                        viewMap[refUri] = base;\n                    }\n                    base = addMembers(base, members);\n                    base.selfhost = selfhost(uri);\n                    return base;\n                }\n                function Pages_define(uri, members) {\n                    /// <signature helpKeyword=\"WinJS.UI.Pages.define\">\n                    /// <summary locid=\"WinJS.UI.Pages.define\">\n                    /// Creates a new page control from the specified URI that contains the specified members.\n                    /// Multiple calls to this method for the same URI are allowed, and all members will be\n                    /// merged.\n                    /// </summary>\n                    /// <param name=\"uri\" locid=\"WinJS.UI.Pages.define_p:uri\">\n                    /// The URI for the content that defines the page.\n                    /// </param>\n                    /// <param name=\"members\" locid=\"WinJS.UI.Pages.define_p:members\">\n                    /// Additional members that the control will have.\n                    /// </param>\n                    /// <returns type=\"Function\" locid=\"WinJS.UI.Pages.define_returnValue\">\n                    /// A constructor function that creates the page.\n                    /// </returns>\n                    /// </signature>\n                    var ctor = viewMap[uri];\n                    if (!ctor) {\n                        ctor = getPageConstructor(uri);\n                    }\n                    if (members) {\n                        ctor = addMembers(ctor, members);\n                    }\n                    if (ctor.selfhost) {\n                        WinJS.Utilities.ready(function () {\n                            render(abs(uri), _Global.document.body);\n                        }, true);\n                    }\n                    //in case we are on WinJS<4 we reference members on WinJS Core Pages\n                    if (!_CorePages.viewMap && !_CorePages._viewMap && typeof members !== 'function')\n                        _Pages._corePages.define(uri, members);\n                    return ctor;\n                }\n                function render(uri, element, options, parentedPromise) {\n                    var Ctor = _CorePages.get(uri);\n                    var control = new Ctor(element, options, null, parentedPromise);\n                    return control.renderComplete.then(null, function (err) {\n                        return Promise.wrapError({\n                            error: err,\n                            page: control\n                        });\n                    });\n                }\n                function get(uri) {\n                    var ctor = viewMap[uri];\n                    if (!ctor) {\n                        ctor = Pages_define(uri);\n                    }\n                    return ctor;\n                }\n                function remove(uri) {\n                    Fragments.clearCache(abs(uri));\n                    delete viewMap[uri.toLowerCase()];\n                }\n                _Pages._corePages = {\n                    get: _CorePages.get,\n                    render: _CorePages.render,\n                    define: _CorePages.define,\n                    _remove: _CorePages._remove,\n                    _viewMap: viewMap,\n                };\n                var pageOverride = {\n                    define: Pages_define,\n                    get: get,\n                    render: render,\n                    _remove: remove,\n                    _viewMap: viewMap\n                };\n                var source = WinJS.UI.Pages;\n                WinJS.Namespace._moduleDefine(_Pages, null, pageOverride);\n                source.get = pageOverride.get;\n                source.define = pageOverride.define;\n                source.render = pageOverride.render;\n                source._remove = pageOverride._remove;\n                //replaces HtmlControl, otherwise it does not use proper Page constructor\n                WinJS.UI.HtmlControl = WinJS.Class.define(function HtmlControl_ctor(element, options, complete) {\n                    /// <signature helpKeyword=\"WinJS.UI.HtmlControl.HtmlControl\">\n                    /// <summary locid=\"WinJS.UI.HtmlControl.constructor\">\n                    /// Initializes a new instance of HtmlControl to define a new page control.\n                    /// </summary>\n                    /// <param name=\"element\" locid=\"WinJS.UI.HtmlControl.constructor_p:element\">\n                    /// The element that hosts the HtmlControl.\n                    /// </param>\n                    /// <param name=\"options\" locid=\"WinJS.UI.HtmlControl.constructor_p:options\">\n                    /// The options for configuring the page. The uri option is required in order to specify the source\n                    /// document for the content of the page.\n                    /// </param>\n                    /// </signature>\n                    WinJS.UI.Pages.render(options.uri, element, options).\n                        then(complete, function () { complete(); });\n                });\n            })(WinJSContrib.UI.Pages, __global, WinJS, WinJS.UI.Pages, WinJS.Utilities, WinJS.Utilities, profiler, WinJS.Promise, WinJS.UI.Fragments, WinJS.UI);\n        })(Pages = UI.Pages || (UI.Pages = {}));\n    })(UI = WinJSContrib.UI || (WinJSContrib.UI = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=winjscontrib.core.js.map","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/*\r\nWARNING: this feature is experimental\r\nYou must add winjscontrib.core.js before this file\r\n*/\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n/**\r\n * @namespace\r\n */\r\nWinJSContrib.UI.WebComponents = WinJSContrib.UI.WebComponents || {};\r\n\r\n(function (global) {\r\n\t'use strict';\r\n\tvar registered = {};\r\n\tWinJSContrib.UI.WebComponents.registered = registered;\r\n\tWinJSContrib.UI.WebComponents.polyfill = false;\r\n\r\n\tif (!global.document.registerElement && global.MutationObserver) {\r\n\t\tWinJSContrib.UI.WebComponents.polyfill = true;\r\n\t}\r\n\r\n\tfunction inspect(node) {\r\n\t\tvar customElement = null;\r\n\t\tvar ctrlName = node.nodeName;\r\n\t\tvar promises = [];\r\n\r\n\t\tif (node.nodeName !== '#text') {\r\n\t\t\tif (node.attributes) {\r\n\t\t\t\tvar ctrlName = node.getAttribute(\"is\");\r\n\t\t\t\tif (ctrlName) {\r\n\t\t\t\t\t//we uppercase because node names are uppercase\r\n\t\t\t\t\tcustomElement = registered[ctrlName.toUpperCase()];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!customElement && node.nodeName !== 'DIV' && node.nodeName !== 'SPAN') {\r\n\t\t\t\tcustomElement = registered[node.nodeName];\r\n\t\t\t}\r\n\r\n\t\t\tif (customElement && !node.mcnComponent) {\r\n\t\t\t\t//createElement(node, customElement);\r\n\t\t\t\tpromises.push(createElement(node, customElement));\r\n\t\t\t}\r\n\r\n\t\t\tif (node.msParentSelectorScope && node.winControl && node.winControl.pageLifeCycle && node.winControl.pageLifeCycle.observer) {\r\n\t\t\t\t//element is a fragment with its own mutation observer, no need to inspect childs\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t//if (node.nodeName === 'WIN-TEMPLATE') {\r\n\t\t\t//    return;\r\n\t\t\t//}\r\n\r\n\t\t\tfor (var i = 0, l = node.childNodes.length; i < l; i++) {\r\n\t\t\t\tpromises.push(inspect(node.childNodes[i]));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn WinJS.Promise.join(promises);\r\n\t}\r\n\r\n\t/**\r\n\t * inspect current DOM element and create webcomponents found on that element and on its child.\r\n\t * @function\r\n\t * @param {HTMLElement} element DOM element to inspect\r\n\t */\r\n\tWinJSContrib.UI.WebComponents.processAll = function (element) { };\r\n\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\tWinJSContrib.UI.WebComponents.processAll = inspect;\r\n\t}\r\n\r\n\tfunction observeMutations(element) {\r\n\t\tvar observer = null;\r\n\t\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\t\tobserver = new MutationObserver(function (mutations) {\r\n\t\t\t\t//console.time('check mutation');\r\n\t\t\t\tmutations.forEach(function (mutation) {\r\n\t\t\t\t\tif (mutation.addedNodes.length) {\r\n\t\t\t\t\t\tfor (var i = 0, l = mutation.addedNodes.length; i < l ; i++) {\r\n\t\t\t\t\t\t\tinspect(mutation.addedNodes[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t//console.timeEnd('check mutation');\r\n\t\t\t});\r\n\r\n\t\t\tobserver.observe(element, { childList: true, subtree: true });\r\n\t\t}\r\n\r\n\t\treturn observer;\r\n\t}\r\n\tWinJSContrib.UI.WebComponents.watch = observeMutations;\r\n\r\n\tfunction createElement(element, definition) {\r\n\t\tvar ctrl = element.winControl;\r\n\t\telement.mcnComponent = true;\r\n\t\tvar scope = WinJSContrib.Utils.getScopeControl(element);\r\n\t\tvar p = WinJS.Promise.wrap();\r\n\t\tvar process = function () {\r\n\t\t\tgetControlInstance(definition.ctor, element);\r\n\t\t}\r\n\r\n\t\tif (scope && scope.pageLifeCycle) {\r\n\t\t\t//if the component is owned by a page/fragment, we process the control according to page lifecycle\r\n\t\t\tp = scope.pageLifeCycle.steps.render.attach(process);\r\n\t\t} else {\r\n\t\t\tprocess();\r\n\t\t}\r\n\r\n\t\t//put a proxy on setAttribute to detect changes in attributes\r\n\t\tvar setAttribute = element.setAttribute;\r\n\t\telement.setAttribute = function (name, val) {\r\n\t\t\tif (element.winControl) {\r\n\t\t\t\tsetAttribute.call(this, name, val);\r\n\t\t\t\tvar definition = element.winControl.constructor.mcnWebComponent;\r\n\t\t\t\tif (definition) {\r\n\t\t\t\t\tvar map = definition[name.toUpperCase()];\r\n\t\t\t\t\tif (map) {\r\n\t\t\t\t\t\tvar ctx = { control: element.winControl, name: map.property, data: {} }\r\n\t\t\t\t\t\tdefinition.applyAttribute(name, this, ctx);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn p;\r\n\t}\r\n\r\n\tfunction getControlInstance(ctor, element) {\r\n\t\telement.mcnComponent = true;\r\n\t\tvar definition = ctor.mcnWebComponent;\r\n\t\t//console.time('building ' + definition.name);\r\n\t\tvar options = {};\r\n\t\tif (element.dataset.winOptions) {\r\n\t\t\toptions = getWinJSOptions(element);\r\n\t\t}\r\n\r\n\t\tif (definition && definition.optionsCallback) {\r\n\t\t\toptions = definition.optionsCallback(element, options, scope);\r\n\t\t}\r\n\r\n\t\tvar ctrl = new ctor(element, options);\r\n\t\telement.winControl = ctrl;\r\n\t\tif (definition) {\r\n\t\t\tdefinition.applyAll(element);\r\n\t\t}\r\n\t\t//console.timeEnd('building ' + definition.name);\t\t\r\n\t}\r\n\r\n\tfunction applyMapping(tagname, ctor, mapping) {\r\n\t\tif (typeof mapping == 'function')\r\n\t\t\treturn;\r\n\t\tmapping = mapping || {};\r\n\r\n\t\tctor.mcnWebComponent = {\r\n\t\t\tname: tagname,\r\n\t\t\tmap: mapping.map || {},\r\n\t\t\toptionsCallback: mapping.optionsCallback,\r\n\t\t\tapplyAll: function (element) {\r\n\t\t\t\tvar contextData = {};\r\n\t\t\t\tfor (var item in this.map) {\r\n\t\t\t\t\tvar attrcontext = { control: element.winControl, name: this.map[item].property, data: contextData };\r\n\t\t\t\t\tthis.applyAttribute(item, element, null, attrcontext);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tapplyAttribute: function (name, element, attrvalue, context) {\r\n\t\t\t\tvar map = this.map[name.toUpperCase()];\r\n\t\t\t\tif (map) {\r\n\t\t\t\t\tvar val = attrvalue || element.getAttribute(map.attribute);\r\n\t\t\t\t\tvar ctrl = element.winControl;\r\n\t\t\t\t\tif (val && ctrl) {\r\n\t\t\t\t\t\tif (!map.type || map.type === 'property') {\r\n\t\t\t\t\t\t\tif (map.resolve) {\r\n\t\t\t\t\t\t\t\tWinJSContrib.Utils.applyValue(element, val, ctrl, map.property, context);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tWinJSContrib.Utils.writeProperty(ctrl, map.property, val);\r\n\t\t\t\t\t\t} else if (map.type === 'event') {\r\n\t\t\t\t\t\t\tWinJSContrib.Utils.resolveValue(element, val, context);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (mapping.properties) {\r\n\t\t\tmapping.properties.forEach(function (p) {\r\n\t\t\t\tif (p) {\r\n\t\t\t\t\tctor.mcnWebComponent.map[p.toUpperCase()] = { attribute: p, property: p, resolve: true, type: 'property' };\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (mapping.events) {\r\n\t\t\tmapping.events.forEach(function (p) {\r\n\t\t\t\tif (p) {\r\n\t\t\t\t\tctor.mcnWebComponent.map[p.toUpperCase()] = { attribute: p, property: p, resolve: true, type: 'event' };\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (mapping.controls) {\r\n\t\t\tfor (var ctKey in mapping.controls) {\r\n\t\t\t\tvar control = mapping.controls[ctKey];\r\n\t\t\t\tvar controlDefinition = control.mcnWebComponent;\r\n\t\t\t\tfor (var mapKey in controlDefinition.map) {\r\n\t\t\t\t\tvar key = ctKey + '.' + mapKey;\r\n\t\t\t\t\tvar controlmap = controlDefinition.map[mapKey];\r\n\t\t\t\t\tctor.mcnWebComponent.map[key.toUpperCase()] = {\r\n\t\t\t\t\t\tattribute: ctKey + '.' + controlmap.attribute,\r\n\t\t\t\t\t\tproperty: ctKey + '.' + controlmap.property,\r\n\t\t\t\t\t\tresolve: controlmap.resolve\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Register a control to be used as a webcomponent. If a tagname has already been registered, \r\n\t* the function will throw an error unless you specify the override flag\r\n\t* @function\r\n\t* @param {string} tagname name for DOM element for the component\r\n\t* @param {function} ctor constructor for the WinJS control\r\n\t* @param {Object} mapping definition for mapping between control and DOM element\r\n\t* @param {boolean} override indicate that you want to override an existing component definition\r\n\t* @example\r\n\t* WinJSContrib.UI.WebComponents.register('mcn-semanticlistviews', WinJSContrib.UI.SemanticListViews, {\r\n\t*\tproperties: ['nameOfProperty'],\r\n\t*   events : ['nameOfEvent'],\r\n\t*\tcontrols: {\r\n\t*\t\t\"listview\": WinJS.UI.ListView,\r\n\t*\t\t\"zoomedOutListview\": WinJS.UI.ListView,\r\n\t*\t\t\"semanticZoom\": WinJS.UI.SemanticZoom\r\n\t*\t},\r\n\t*\tmap: {\r\n\t*\t\t\"DEFAULTGROUPLIMIT\": { attribute: 'defaultGroupLimit', property: '_dataManager.defaultGroupLimit', resolve: true },\r\n\t*\t\t\"GROUPKIND\": { attribute: 'groupKind', property: '_dataManager.groupKind', resolve: true },\r\n\t*\t\t\"FIELD\": { attribute: 'field', property: '_dataManager.field', resolve: true },\r\n\t*\t\t\"ITEMS\": { attribute: 'items', property: '_dataManager.items', resolve: true },\r\n\t*\t}\r\n\t*});\r\n\t*/\r\n\tWinJSContrib.UI.WebComponents.register = function register(tagname, ctor, mapping, override) {\r\n\t\tvar existing = registered[tagname.toUpperCase()];\r\n\t\tif (existing && !override) {\r\n\t\t\tthrow 'component ' + tagname + ' already exists';\r\n\t\t}\r\n\r\n\t\tapplyMapping(tagname, ctor, mapping);\r\n\r\n\t\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\t\tglobal.document.createElement(tagname);\r\n\t\t\t//we uppercase because node names are uppercase\r\n\t\t\tregistered[tagname.toUpperCase()] = { ctor: ctor };\r\n\t\t} else if (global.document.registerElement) {\r\n\t\t\t//register component with \"real\" webcomponent\r\n\t\t\tvar proto = Object.create(HTMLElement.prototype);\r\n\t\t\tproto.createdCallback = function () {\r\n\t\t\t}\r\n\r\n\t\t\tproto.attachedCallback = function () {\r\n\t\t\t\tvar element = this;\r\n\t\t\t\tvar scope = WinJSContrib.Utils.getScopeControl(element);\r\n\t\t\t\tvar process = function () {\r\n\t\t\t\t\tgetControlInstance(ctor, element);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (scope && scope.pageLifeCycle) {\r\n\t\t\t\t\t//if the component is owned by a page/fragment, we process the control according to page lifecycle\r\n\t\t\t\t    scope.pageLifeCycle.steps.render.attach(process);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tprocess();\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\tproto.attributeChangedCallback = function (attrName, oldValue, newValue) {\r\n\t\t\t\tvar element = this;\r\n\t\t\t\tif (element.winControl) {\r\n\t\t\t\t\tvar definition = element.winControl.constructor.mcnWebComponent;\r\n\t\t\t\t\tif (definition) {\r\n\t\t\t\t\t\tvar map = definition.map[attrName.toUpperCase()];\r\n\t\t\t\t\t\tif (map) {\r\n\t\t\t\t\t\t\tdefinition.applyAttribute(attrName, element, newValue, { control: element.winControl, name: map.property, data: {} });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\tglobal.document.registerElement(tagname, { prototype: proto });\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getWinJSOptions(elt) {\r\n\t\treturn WinJS.UI.optionsParser(elt.dataset.winOptions, window, {\r\n\t\t\tselect: WinJS.Utilities.markSupportedForProcessing(function (text) {\r\n\t\t\t\tvar parent = WinJSContrib.Utils.getScopeControl(elt);\r\n\t\t\t\tif (parent) {\r\n\t\t\t\t\treturn parent.element.querySelector(text);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn document.querySelector(text);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\tif (WinJS.Binding && WinJS.Binding.Template) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-template', WinJS.Binding.Template, {\r\n\t\t\tproperties: ['extractChild']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.AppBar) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-appbar', WinJS.UI.AppBar, {\r\n\t\t\tproperties: ['closedDisplayMode', 'disabled', 'hidden', 'layout', 'placement', 'sticky', 'commands', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.AutoSuggestBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-autosuggestbox', WinJS.UI.AutoSuggestBox, {\r\n\t\t\tproperties: ['chooseSuggestionOnEnter', 'disabled', 'onquerychanged', 'onquerysubmitted', \r\n\t\t\t\t'onresultsuggestionchosen', 'onsuggestionsrequested', 'placeholderText', 'queryText', \r\n\t\t\t\t'searchHistoryContext', 'searchHistoryDisabled'],\r\n\t\t\tevents: ['querychanged', 'querysubmitted', 'resultsuggestionchosen', 'suggestionsrequested']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.BackButton) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-backbutton', WinJS.UI.BackButton);\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ContentDialog) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-contentdialog', WinJS.UI.ContentDialog, {\r\n\t\t\tproperties: ['hidden', 'primaryCommandDisabled', 'primaryCommandText', 'secondaryCommandDisabled',\r\n\t\t\t\t'secondaryCommandText', 'title', 'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.DatePicker) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-datepicker', WinJS.UI.DatePicker, {\r\n\t\t\tproperties: ['calendar', 'datePattern', 'disabled', 'maxYear', 'minYear', \r\n\t\t\t\t'monthPattern', 'yearPattern', 'onchange', 'current'],\r\n\t\t\tevents: ['change']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.FlipView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-flipview', WinJS.UI.FlipView, {\r\n\t\t\tproperties: ['currentPage', 'orientation', 'itemTemplate', 'itemDataSource', 'itemSpacing', 'ondatasourcecountchanged', 'onpagevisibilitychanged', 'onpageselected', 'onpagecompleted'],\r\n\t\t\tevents: ['datasourcecountchanged', 'pagevisibilitychanged', 'pageselected', 'pagecompleted']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Flyout) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-flyout', WinJS.UI.Flyout, {\r\n\t\t\tproperties: ['alignment', 'anchor', 'disabled', 'hidden', 'placement', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Hub) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-hub', WinJS.UI.Hub, {\r\n\t\t\tproperties: ['headerTemplate', 'indexOfFirstVisible', 'indexOfLastVisible', 'loadingState', \r\n\t\t\t\t'oncontentanimating', 'onheaderinvoked', 'onloadingstatechanged', \r\n\t\t\t\t'orientation', 'scrollPosition', 'sectionOnScreen', 'sections', 'zoomableView'],\r\n\t\t\tevents: ['contentanimating', 'headerinvoked', 'loadingstatechanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.HubSection) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-hubsection', WinJS.UI.HubSection, {\r\n\t\t\tproperties: ['contentElement', 'header', 'isHeaderStatic']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ItemContainer) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-itemcontainer', WinJS.UI.ItemContainer, {\r\n\t\t\tproperties: ['draggable', 'oninvoked', 'onselectionchanged', 'onselectionchanging', 'selected', 'selectionDisabled', \r\n\t\t\t\t'swipeBehavior', 'swipeOrientation', 'tapBehavior'],\r\n\t\t\tevents: ['invoked', 'selectionchanged', 'selectionchanging']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ListView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-listview', WinJS.UI.ListView, {\r\n\t\t\tproperties: [\r\n\t\t\t\t'itemTemplate', 'itemDataSource', 'itemsDraggable', 'itemsReorderable',\r\n\t\t\t\t'oniteminvoked', 'groupHeaderTemplate', 'groupDataSource', 'swipeBehavior',\r\n\t\t\t\t'selectBehavior', 'tapBehavior', 'header', 'footer'\r\n\t\t\t],\r\n\t\t\tevents: ['iteminvoked']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Menu) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-menu', WinJS.UI.Menu, {\r\n\t\t\tproperties: ['alignment', 'anchor', 'commands', 'disabled', 'hidden', 'placement', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Pivot) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-pivot', WinJS.UI.Pivot, {\r\n\t\t\tproperties: ['items', 'locked', 'onitemanimationend', 'onitemanimationstart', 'onselectionchanged', \r\n\t\t\t\t'selectedIndex', 'selectedItem', 'title'],\r\n\t\t\tevents: ['itemanimationend', 'itemanimationstart', 'selectionchanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.PivotItem) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-pivotitem', WinJS.UI.PivotItem, {\r\n\t\t\tproperties: ['contentElement', 'header']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Rating) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-rating', WinJS.UI.Rating, {\r\n\t\t\tproperties: ['averageRating', 'disabled', 'enableClear', 'maxRating', \r\n\t\t\t\t'oncancel', 'onchange', 'onpreviewchange', 'tooltipStrings', 'userRating'],\r\n\t\t\tevents: ['cancel', 'change', 'previewchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Repeater) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-repeater', WinJS.UI.Repeater, {\r\n\t\t\tproperties: ['data', 'length', 'onitemchanged', 'onitemchanging', 'oniteminserted', 'oniteminserting', \r\n\t\t\t\t'onitemmoved', 'onitemmoving', 'onitemremoved', 'onitemremoving', 'onitemsloaded', \r\n\t\t\t\t'onitemsreloaded', 'onitemsreloading', 'template'],\r\n\t\t\tevents: ['itemchanged', 'itemchanging', 'iteminserted', 'iteminserting',\r\n\t\t\t\t'itemmoved', 'itemmoving', 'itemremoved', 'itemremoving', 'itemsloaded',\r\n\t\t\t\t'itemsreloaded', 'itemsreloading']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SearchBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-searchbox', WinJS.UI.SearchBox, {\r\n\t\t\tproperties: ['chooseSuggestionOnEnter', 'disabled', 'focusOnKeyboardInput', 'onquerychanged', 'onquerysubmitted', \r\n\t\t\t\t'onresultsuggestionchosen', 'onsuggestionsrequested', 'placeholderText', 'queryText', \r\n\t\t\t\t'searchHistoryContext', 'searchHistoryDisabled'],\r\n\t\t\tevents: ['querychanged', 'querysubmitted', 'resultsuggestionchosen', 'suggestionsrequested']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SemanticZoom) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-semanticzoom', WinJS.UI.SemanticZoom, {\r\n\t\t\tproperties: ['enableButton', 'locked', 'onzoomchanged', 'zoomedInItem', 'zoomedOut', 'zoomedOutItem', 'zoomFactor'],\r\n\t\t\tevents: ['zoomchanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SplitView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-splitview', WinJS.UI.SplitView, {\r\n\t\t\tproperties: ['contentElement', 'hiddenDisplayMode', 'paneElement', 'paneHidden', 'panePlacement', 'shownDisplayMode',\r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.TimePicker) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-timepicker', WinJS.UI.TimePicker, {\r\n\t\t\tproperties: ['onchange', 'clock', 'current', 'disabled', 'hourPattern',\r\n\t\t\t\t'minuteIncrement', 'minutePattern', 'periodPattern'],\r\n\t\t\tevents: ['onchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ToggleSwitch) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-toggleswitch', WinJS.UI.ToggleSwitch, {\r\n\t\t\tproperties: ['onchange', 'checked', 'disabled', 'labelOff', 'labelOn', 'title'],\r\n\t\t\tevents: ['onchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ToolBar) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-toolbar', WinJS.UI.ToolBar);\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Tooltip) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-tooltip', WinJS.UI.Tooltip, {\r\n\t\t\tproperties: ['contentElement', 'extraClass', 'infotip', 'innerHTML', 'onbeforeclose', \r\n\t\t\t\t'onbeforeopen', 'onclosed', 'onopened', 'placement'],\r\n\t\t\tevents: ['beforeclose', 'beforeopen', 'closed', 'opened']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ViewBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-viewbox', WinJS.UI.ViewBox);\r\n\t}\r\n\r\n\r\n\t/*\r\n\t\t\t\tWinJS.UI.MenuCommand\r\n\t\t\t\tWinJS.UI.NavBar\r\n\t\t\t\tWinJS.UI.NavBarCommand\r\n\t\t\t\tWinJS.UI.NavBarContainer\r\n\t\t\t\tToolbar\r\n\t*/\r\n})(this);","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var WinRT;\n    (function (WinRT) {\n        /**\n         * read protocol arguments from application activation event arguments\n         * @function WinJSContrib.WinRT.readProtocol\n         * @param {Object} args WinJS application activation argument\n         * @returns {Object} protocol arguments\n         */\n        function readProtocol(args) {\n            if (args.detail.kind === Windows.ApplicationModel.Activation.ActivationKind.protocol && args.detail.uri) {\n                var navArgs = { action: undefined };\n                var protocolArgs = {};\n                var queryargs = args.detail.uri.query;\n                if (queryargs[0] == '?') {\n                    queryargs = queryargs.substr(1);\n                }\n                if (queryargs) {\n                    queryargs.split('&').forEach(function (item) {\n                        var arg = item.split('=');\n                        protocolArgs[arg[0]] = decodeURIComponent(arg[1]);\n                    });\n                }\n                navArgs.protocol = {\n                    action: args.detail.uri.host,\n                    args: protocolArgs\n                };\n                return navArgs;\n            }\n        }\n        WinRT.readProtocol = readProtocol;\n        ;\n        /**\n         * Indicate if a valid internet connection is available, even with constrained access\n         * @function WinJSContrib.WinRT.isConnected\n         * @returns {boolean}\n         */\n        function isConnected() {\n            var nlvl = Windows.Networking.Connectivity.NetworkConnectivityLevel;\n            var profile = Windows.Networking.Connectivity.NetworkInformation.getInternetConnectionProfile();\n            if (profile !== null) {\n                var level = profile.getNetworkConnectivityLevel();\n                return level === nlvl.constrainedInternetAccess || level === nlvl.internetAccess;\n            }\n            return false;\n        }\n        WinRT.isConnected = isConnected;\n        ;\n        /**\n         * Indicate if a valid internet connection is available\n         * @function WinJSContrib.WinRT.hasInternetAccess\n         * @returns {boolean}\n         */\n        function hasInternetAccess() {\n            var nlvl = Windows.Networking.Connectivity.NetworkConnectivityLevel;\n            var profile = Windows.Networking.Connectivity.NetworkInformation.getInternetConnectionProfile();\n            if (profile !== null) {\n                var level = profile.getNetworkConnectivityLevel();\n                return level === nlvl.internetAccess;\n            }\n            return false;\n        }\n        WinRT.hasInternetAccess = hasInternetAccess;\n        ;\n        /**\n         * trigger callback when internet connection status is changing\n         * @function WinJSContrib.WinRT.onInternetStatusChanged\n         * @param {function} callback callback for internet status change notification\n         * @returns {function} function to call for unregistering the callback\n         */\n        function onInternetStatusChanged(callback) {\n            var handler = function (arg) {\n                var e = arg;\n                callback(WinJSContrib.WinRT.hasInternetAccess());\n            };\n            var network = Windows.Networking.Connectivity.NetworkInformation;\n            network.addEventListener('networkstatuschanged', handler);\n            return function () {\n                network.removeEventListener('networkstatuschanged', handler);\n            };\n        }\n        WinRT.onInternetStatusChanged = onInternetStatusChanged;\n    })(WinRT = WinJSContrib.WinRT || (WinJSContrib.WinRT = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Alerts;\n    (function (Alerts) {\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.messageBox\n         * @param {Object} opt message options\n         * @returns {WinJS.Promise}\n         */\n        function messageBox(opt) {\n            var _global = window;\n            if (opt) {\n                if (_global.Windows) {\n                    var md = new Windows.UI.Popups.MessageDialog(opt.content);\n                    if (opt.title) {\n                        md.title = opt.title;\n                    }\n                    if (opt.commands && opt.commands.forEach) {\n                        opt.commands.forEach(function (command, index) {\n                            var cmd = new Windows.UI.Popups.UICommand();\n                            if (command.id)\n                                cmd.id = command.id;\n                            cmd.label = command.label;\n                            if (command.callback) {\n                                cmd.invoked = command.callback;\n                            }\n                            ((md.commands)).append(cmd);\n                            if (command.isDefault) {\n                                md.defaultCommandIndex = index;\n                            }\n                        });\n                    }\n                    return (md.showAsync());\n                }\n                else {\n                    return new WinJS.Promise(function (complete, error) {\n                        var title = \"\";\n                        if (opt.title) {\n                            title = opt.title;\n                        }\n                        var commands = [];\n                        if (opt.commands && opt.commands.forEach) {\n                            //if (opt.commands.length > 2) {\n                            //    return WinJS.Promise.wrapError(\"you must specify maximum 2 commands on Cordova platforms\");\n                            //}\n                            opt.commands.forEach(function (command, index) {\n                                commands.push(command.label);\n                            });\n                        }\n                        else\n                            commands = ['Ok'];\n                        if (_global.navigator && _global.navigator.notification && _global.navigator.notification.confirm) {\n                            _global.navigator.notification.confirm(opt.content, function (res) {\n                                if (opt.commands && opt.commands[res - 1] && opt.commands[res - 1].callback) {\n                                    var c = opt.commands[res - 1].callback();\n                                    if (c && c.then) {\n                                        c.then(function () {\n                                            complete(true);\n                                        });\n                                    }\n                                    else {\n                                        complete(true);\n                                    }\n                                }\n                                else if (res != 0)\n                                    complete(true);\n                                else\n                                    complete(false);\n                            }, title, commands // buttonLabels\n                            );\n                        }\n                        else {\n                            if (window.confirm(title))\n                                complete(true);\n                            else\n                                complete(false);\n                        }\n                    });\n                }\n            }\n            return WinJS.Promise.wrapError(\"you must specify commands as an array of objects with properties text and callback such as {text: '', callback: function(c){}}\");\n        }\n        Alerts.messageBox = messageBox;\n        ;\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.message\n         * @param {string} title title of the alert\n         * @param {string} content text for the alert\n         * @returns {WinJS.Promise}\n         */\n        function message(title, content) {\n            return WinJSContrib.Alerts.messageBox({ title: title, content: content });\n        }\n        Alerts.message = message;\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.confirm\n         * @param {string} title title of the alert\n         * @param {string} content text for the alert\n         * @param {string} yes text for yes\n         * @param {string} no text for no\n         * @returns {WinJS.Promise}\n         */\n        function confirm(title, content, yes, no) {\n            return new WinJS.Promise(function (complete, error) {\n                WinJSContrib.Alerts.messageBox({\n                    title: title,\n                    content: content,\n                    commands: [\n                        {\n                            label: yes,\n                            callback: function (e) {\n                                complete(true);\n                            },\n                            isDefault: true\n                        },\n                        {\n                            label: no,\n                            callback: function (e) {\n                                complete(false);\n                            }\n                        }\n                    ]\n                });\n            });\n        }\n        Alerts.confirm = confirm;\n        /**\n         * show system toast notification\n         * @function WinJSContrib.Alerts.toastNotification\n         * @param {Object} data toast options\n         */\n        function toastNotification(data) {\n            if (Windows) {\n                var notifications = Windows.UI.Notifications;\n                var template = data.template || (data.picture ? notifications.ToastTemplateType.toastImageAndText01 : notifications.ToastTemplateType.toastText01);\n                //var template = notifications.ToastTemplateType[data.template]; //toastImageAndText01;\n                var toastXml = notifications.ToastNotificationManager.getTemplateContent(template);\n                var toastTextElements = toastXml.getElementsByTagName(\"text\");\n                var toastImageElements = toastXml.getElementsByTagName(\"image\");\n                if (data.launch) {\n                    var toastElements = toastXml.getElementsByTagName(\"toast\");\n                    toastElements[0].setAttribute(\"launch\", JSON.stringify(data.launch));\n                }\n                toastTextElements[0].appendChild(toastXml.createTextNode(data.text));\n                if (data.text2 && toastTextElements.length > 1) {\n                    toastTextElements[1].appendChild(toastXml.createTextNode(data.text2));\n                }\n                if (data.text3 && toastTextElements.length > 1) {\n                    toastTextElements[2].appendChild(toastXml.createTextNode(data.text3));\n                }\n                if (data.picture) {\n                    toastImageElements[0].setAttribute(\"src\", data.picture); //\"ms-appx:///images/logo.png\"\n                }\n                var toast = new notifications.ToastNotification(toastXml);\n                var toastNotifier = notifications.ToastNotificationManager.createToastNotifier();\n                toastNotifier.show(toast);\n            }\n            else {\n                throw \"No notification plugin found\";\n            }\n        }\n        Alerts.toastNotification = toastNotification;\n        /**\n         * show system toast notification\n         * @function WinJSContrib.Alerts.toast\n         * @param {string} text text displayed in the toast\n         * @param {string} picture path to a picture to display in the toast\n         */\n        function toast(text, picture) {\n            WinJSContrib.Alerts.toastNotification({ text: text, picture: picture });\n        }\n        Alerts.toast = toast;\n    })(Alerts = WinJSContrib.Alerts || (WinJSContrib.Alerts = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=../../Sources/WinRT/winjscontrib.winrt.core.js.map","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UPnP = WinJSContrib.UPnP || {};\r\n\r\n(function (global) {\r\n\r\n    WinJSContrib.UPnP.deviceTypes = {\r\n        ContentDirectory1: 'urn:schemas-upnp-org:service:ContentDirectory:1',\r\n        ContentDirectory2: 'urn:schemas-upnp-org:service:ContentDirectory:2',\r\n        ContentDirectory3: 'urn:schemas-upnp-org:service:ContentDirectory:3',\r\n        ContentDirectory4: 'urn:schemas-upnp-org:service:ContentDirectory:4',\r\n        MediaRenderer1: 'urn:schemas-upnp-org:device:MediaRenderer:1',\r\n        MediaRenderer2: 'urn:schemas-upnp-org:device:MediaRenderer:2',\r\n        MediaRenderer3: 'urn:schemas-upnp-org:device:MediaRenderer:3',\r\n        MediaRenderer4: 'urn:schemas-upnp-org:device:MediaRenderer:4',\r\n        MediaServer1: 'urn:schemas-upnp-org:device:MediaServer:1',\r\n        MediaServer2: 'urn:schemas-upnp-org:device:MediaServer:2',\r\n        MediaServer3: 'urn:schemas-upnp-org:device:MediaServer:3',\r\n        MediaServer4: 'urn:schemas-upnp-org:device:MediaServer:4',\r\n        AVTransport1:'urn:schemas-upnp-org:service:AVTransport:1',\r\n        AVTransport2: 'urn:schemas-upnp-org:service:AVTransport:2',\r\n        ConnectionManager1: 'urn:schemas-upnp-org:service:ConnectionManager:1',\r\n        ConnectionManager2: 'urn:schemas-upnp-org:service:ConnectionManager:2',\r\n        ConnectionManager3: 'urn:schemas-upnp-org:service:ConnectionManager:3'\r\n    };\r\n\r\n    WinJSContrib.UPnP.devicesDiscovery = function devicesDiscovery(filter, callback, timeout) {\r\n        var hostName;\r\n        try {\r\n            hostName = new Windows.Networking.HostName(\"239.255.255.250\");\r\n        } catch (ex) {\r\n            error({ message: \"Invalid host name.\" });\r\n            return;\r\n        }\r\n\r\n        var devices = new WinJS.Binding.List();\r\n\r\n        var discovery = {\r\n            devices: devices,\r\n            hasError: null,\r\n            promise: null,\r\n        };\r\n\r\n        function exists(url) {\r\n            var matches = devices.filter(function (d) {\r\n                return (url == d.deviceDescriptionUrl);\r\n            });\r\n            return matches.length > 0;\r\n        }\r\n\r\n        function discover(filter) {\r\n            return new WinJS.Promise(function (complete, error) {\r\n                var clientSocket = new Windows.Networking.Sockets.DatagramSocket();\r\n\r\n                function onsuccess(err) {\r\n                    try {\r\n                        if (clientSocket)\r\n                            clientSocket.close();\r\n                    } catch (ex) {\r\n                    }\r\n                    complete(devices);\r\n                }\r\n\r\n                function onerror(err) {\r\n                    try {\r\n                        if (clientSocket)\r\n                            clientSocket.close();\r\n                    } catch (ex) {\r\n                    }\r\n                    error(err);\r\n                }\r\n\r\n                clientSocket.onmessagereceived = function (args) {\r\n                    var e = args;\r\n                    var reader = args.getDataReader();\r\n                    var count = reader.unconsumedBufferLength;\r\n                    var data = reader.readString(count);\r\n                    var completed = false;\r\n\r\n                    if (data) {\r\n                        var items = data.split('\\n');\r\n                        items.forEach(function (item) {\r\n                            if (!completed && item.toLowerCase().indexOf('location:') == 0) {\r\n                                var url = item.substr(9, item.length - 9);\r\n                                completed = true;\r\n                                if (!exists(url)) {\r\n                                    WinJS.xhr({ url: url }).then(function (r) {\r\n\r\n                                        var rawdevice = xmlToJson(r.responseXML);\r\n                                        var device = rawdevice.root.device;\r\n\r\n                                        device.deviceDescriptionUrl = url;\r\n                                        device.rootUrl = url.substr(0, url.indexOf('/', 8));\r\n                                        if (!exists(url)) {\r\n                                            devices.push(new WinJSContrib.UPnP.UPnPDevice(device));\r\n                                        }\r\n\r\n                                        if (callback)\r\n                                            callback(device, url);\r\n                                    }, function (err) {\r\n                                        console.error('calling device failed');\r\n                                        console.error(err);\r\n                                    });\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                }\r\n\r\n                clientSocket.getOutputStreamAsync(hostName, \"1900\").then(function (outputStream) {\r\n                    var message = \"M-SEARCH * HTTP/1.1\\r\\n\" +\r\n                                        \"HOST: 239.255.255.250:1900\\r\\n\" +\r\n                                          \"ST:\" + (filter || \"upnp:rootdevice\") + \"\\r\\n\" +\r\n                                          \"MAN:\\\"ssdp:discover\\\"\\r\\n\" +\r\n                                          \"MX:3\\r\\n\\r\\n\";\r\n\r\n\r\n                    var writer = new Windows.Storage.Streams.DataWriter(outputStream);\r\n                    writer.unicodeEncoding = Windows.Storage.Streams.UnicodeEncoding.Utf8;\r\n                    writer.writeString(message);\r\n                    return writer.storeAsync();\r\n                }).then(function () {\r\n                    return WinJS.Promise.timeout(timeout || 20000);\r\n                }).then(onsuccess, onerror);\r\n            }).then(function (res) {\r\n                discovery.hasError = false;\r\n            }, function (err) {\r\n                discovery.hasError = true;\r\n                discovery.error = err;\r\n            });\r\n        }\r\n\r\n        var promises = [];\r\n\r\n        if (!filter || (typeof filter == 'string')) {\r\n            promises.push(discover(filter));\r\n        }\r\n        else if (filter && typeof filter != 'string' && filter.length) {\r\n            for (var i = 0 ; i < filter.length; i++) {\r\n                promises.push(discover(filter[i]));\r\n            }\r\n        }\r\n\r\n        discovery.promise = WinJS.Promise.join(promises);\r\n\r\n        return discovery;\r\n    }\r\n\r\n    function endsWith(text, search) {\r\n        return text.indexOf(search) == text.length - search.length;\r\n    }\r\n\r\n    WinJSContrib.UPnP.getContentType = function (url, extension) {\r\n        var lowerUrl = url.toLowerCase();\r\n\r\n        if (extension == \"mp3\" || endsWith(lowerUrl, \".mp3\"))\r\n            return \"audio/mp3\";\r\n\r\n        if (extension == \"mp4\" || endsWith(lowerUrl, \".mp4\"))\r\n            return \"video/mp4\";\r\n\r\n        if (extension == \"avi\" || endsWith(lowerUrl, \".avi\"))\r\n            return \"video/avi\";\r\n\r\n        if (extension == \"mkv\" || endsWith(lowerUrl, \".mkv\"))\r\n            return \"video/x-matroska\";\r\n    }\r\n\r\n    function xmlToJson(xml) {\r\n\r\n        // Create the return object\r\n        var obj = {};\r\n\r\n        if (xml.nodeType == 1) { // element\r\n            // do attributes\r\n            if (xml.attributes.length > 0) {\r\n                obj[\"@attributes\"] = {};\r\n                for (var j = 0; j < xml.attributes.length; j++) {\r\n                    var attribute = xml.attributes.item(j);\r\n\r\n                    obj[\"@attributes\"][attribute.nodeName] = attribute.nodeValue;\r\n                }\r\n            }\r\n        } else if (xml.nodeType == 3) { // text\r\n            obj = xml.nodeValue;\r\n        }\r\n\r\n        // do children\r\n        if (xml.hasChildNodes()) {\r\n            var properties = 0;\r\n            for (var i = 0; i < xml.childNodes.length; i++) {\r\n                var item = xml.childNodes.item(i);\r\n                var nodeName = item.nodeName;\r\n                if (typeof (obj[nodeName]) == \"undefined\") {\r\n                    var tmp = xmlToJson(item);\r\n                    var colonIdx = nodeName.indexOf(':');\r\n                    if (colonIdx > 0) {\r\n                        var clearNode = nodeName.substr(colonIdx + 1, nodeName.length - colonIdx - 1);\r\n\r\n                    }\r\n\r\n                    if (clearNode && !obj[clearNode]) {\r\n                        obj[clearNode] = tmp;\r\n                    } else {\r\n                        obj[nodeName] = tmp;\r\n                    }\r\n\r\n                    properties++;\r\n                } else {\r\n                    if (typeof (obj[nodeName].push) == \"undefined\") {\r\n                        var old = obj[nodeName];\r\n                        obj[nodeName] = [];\r\n                        obj[nodeName].push(old);\r\n                    }\r\n                    obj[nodeName].push(xmlToJson(item));\r\n                    properties++;\r\n                }\r\n            }\r\n\r\n            if (obj['#text'] && typeof obj['#text'] == 'string') {\r\n                obj['#text'] = obj['#text'].trim();\r\n            }\r\n            if (properties == 1 && obj['#text'] && typeof obj['#text'] == 'string') {\r\n                obj = obj['#text'];\r\n            }\r\n        }\r\n\r\n        for (var e in obj[\"@attributes\"]) {\r\n            if (!obj[e])\r\n                obj[e] = obj[\"@attributes\"][e];\r\n        }\r\n\r\n        return obj;\r\n    };\r\n\r\n    /**\r\n     * UPnP device\r\n     * @class\r\n     */\r\n    WinJSContrib.UPnP.UPnPDevice = function (deviceObj) {\r\n        for (var p in deviceObj) {\r\n            this[p] = deviceObj[p];\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getService = function (serviceType) {\r\n        var device = this;\r\n        var service = null;\r\n\r\n        if (typeof serviceType == 'string')\r\n            serviceType = [serviceType];\r\n\r\n        if (device.serviceList && device.serviceList.service) {\r\n            service = device.serviceList.service.filter(function (s) {\r\n                return serviceType.indexOf(s.serviceType) >= 0;\r\n            })[0];\r\n\r\n            if (!service && device.deviceList) {\r\n                device.deviceList.device.forEach(function (childdevice) {\r\n                    var childService = childdevice.serviceList.service.filter(function (s) {\r\n                        return serviceType.indexOf(s.serviceType) >= 0;\r\n                    })[0];\r\n\r\n                    if (childService)\r\n                        service = childService;\r\n                });\r\n            }\r\n        }\r\n\r\n        if (service) {\r\n            service.rootUrl = device.rootUrl;\r\n            service.url = device.rootUrl + service.controlURL;\r\n        }\r\n\r\n        return service;\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getAVTransport = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.AVTransport1, WinJSContrib.UPnP.deviceTypes.AVTransport2]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPAVTransport(service);\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getContentDirectory = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.ContentDirectory1, WinJSContrib.UPnP.deviceTypes.ContentDirectory2, WinJSContrib.UPnP.deviceTypes.ContentDirectory3, WinJSContrib.UPnP.deviceTypes.ContentDirectory4]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPContentDirectory(service);\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getConnectionManager = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.ConnectionManager1, WinJSContrib.UPnP.deviceTypes.ConnectionManager2, WinJSContrib.UPnP.deviceTypes.ConnectionManager3]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPConnectionManager(service);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Code largely from https://github.com/richtr/plug.play.js\r\n     */\r\n\r\n    WinJSContrib.UPnP.UPnPService = function (serviceObj, opts) {\r\n\r\n        this.options = opts || { debug: false };\r\n        this.svc = serviceObj;\r\n\r\n        // API stub\r\n        this.action = function () { };\r\n\r\n        //if (!this.svc || !(this.svc instanceof NetworkService)) {\r\n\r\n        //    this.debugLog('First argument provided in constructor MUST be a valid NetworkService object');\r\n\r\n        //    return this;\r\n        //}\r\n\r\n        //if (!this.svc.type || this.svc.type.indexOf('upnp:') !== 0) {\r\n\r\n        //    this.debugLog('First argument provided in constructor MUST be a _UPnP_ NetworkService object');\r\n\r\n        //    return this;\r\n\r\n        //}\r\n\r\n        //this.svcType = this.svc.type.replace('upnp:', '');\r\n        this.svcType = this.svc.serviceType;\r\n        this.svcUrl = this.svc.url;\r\n\r\n        var self = this;\r\n\r\n        // Full API\r\n        this.action = function (upnpAction, upnpParameters, callback) {\r\n\r\n            return new WinJS.Promise(function (promiseComplete, promiseError) {\r\n\r\n                // Handle .action( name, callback )\r\n                if (!callback && Object.prototype.toString.call(upnpParameters) == '[object Function]') {\r\n                    callback = upnpParameters;\r\n                    upnpParameters = {};\r\n                }\r\n\r\n                // Generate a callback stub if a Function has not been provided\r\n                if (!callback || Object.prototype.toString.call(callback) !== '[object Function]') {\r\n                    callback = function (e, response) { };\r\n                }\r\n\r\n                // Create a UPnP XML Request message\r\n                var svcMsg = self.createRequest(self.svcType, upnpAction, upnpParameters);\r\n\r\n                // Send the UPnP XML Request message to the current service\r\n                self.sendRequest(self.svcType, upnpAction, self.svcUrl, svcMsg, function (e, xmlResponse) {\r\n\r\n                    if (e !== null) {\r\n                        callback.apply(self, [e, null]);\r\n                        promiseError(e);\r\n                        return;\r\n                    }\r\n\r\n                    // Parse UPnP XML Response message\r\n                    self.handleResponse(upnpAction, xmlResponse.responseXML || \"\", upnpParameters, function (e, upnpResponse) {\r\n\r\n                        // Fire callback\r\n                        callback.apply(self, [e, upnpResponse]);\r\n\r\n                        // Fire promise\r\n                        if (e !== null) {\r\n                            promiseError(e);\r\n                        } else {\r\n                            promiseComplete(upnpResponse);\r\n                        }\r\n\r\n                    });\r\n\r\n                });\r\n            });\r\n        }\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.constructor = WinJSContrib.UPnP.UPnPService;\r\n\r\n    // UPnP XML MESSAGING TEMPLATES\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.requestTemplate = \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\n\" +\r\n     \"<s:Envelope s:encodingStyle=\\\"http://schemas.xmlsoap.org/soap/encoding/\\\" \" +\r\n       \"xmlns:s=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\">\\n\" +\r\n       \"\\t<s:Body>\\n\" +\r\n         \"\\t\\t<u:{ACTION_NAME} xmlns:u=\\\"{ACTION_TYPE}\\\">\\n\" +\r\n           \"{ACTION_VARS}\" +\r\n         \"\\t\\t</u:{ACTION_NAME}>\\n\" +\r\n       \"\\t</s:Body>\\n\" +\r\n     \"</s:Envelope>\\n\";\r\n\r\n    // UPNP PRIMITIVE VARIABLE TYPE CHECKERS\r\n    // from http://upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.0.pdf\r\n    WinJSContrib.UPnP.UPnPService.prototype.types = {\r\n\r\n        \"i1\": function (val, allowedValues, toNative) {\r\n            var i8 = new Int8Array(1);\r\n            i8[0] = val;\r\n\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i8[0], allowedValues);\r\n\r\n        },\r\n\r\n        \"i2\": function (val, allowedValues, toNative) {\r\n            var i16 = new Int16Array(1);\r\n            i16[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i16[0], allowedValues);\r\n        },\r\n\r\n        \"i4\": function (val, allowedValues, toNative) {\r\n            var i32 = new Int32Array(1);\r\n            i32[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i32[0], allowedValues);\r\n        },\r\n\r\n        \"ui1\": function (val, allowedValues, toNative) {\r\n            var ui8 = new Uint8Array(1);\r\n            ui8[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui8[0], allowedValues);\r\n        },\r\n\r\n        \"ui2\": function (val, allowedValues, toNative) {\r\n            var ui16 = new Uint16Array(1);\r\n            ui16[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui16[0], allowedValues);\r\n        },\r\n\r\n        \"ui4\": function (val, allowedValues, toNative) {\r\n            var ui32 = new Uint32Array(1);\r\n            ui32[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui32[0], allowedValues);\r\n        },\r\n\r\n        \"int\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || isNaN(val)) {\r\n                val = 0;\r\n            } else if (typeof val !== 'number') {\r\n                if (val === true) {\r\n                    val = 1;\r\n                } else {\r\n                    val = parseInt(val + \"\", 10);\r\n                }\r\n            }\r\n            if (!toNative) {\r\n                val = expandExponential(val + \"\");\r\n            }\r\n            if (isNaN(val)) val = 0;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"r4\": function (val, allowedValues, toNative) {\r\n            var f32 = new Float32Array(1);\r\n            f32[0] = val;\r\n            if (!toNative) {\r\n                return f32[0] ? expandExponential(f32[0] + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(f32[0], allowedValues);\r\n        },\r\n\r\n        \"r8\": function (val, allowedValues, toNative) {\r\n            var f64 = new Float64Array(1);\r\n            f64[0] = val;\r\n            if (!toNative) {\r\n                return f64[0] ? expandExponential(f64[0] + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(f64[0], allowedValues);\r\n        },\r\n\r\n        \"number\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['r8'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"fixed_14_4\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['float'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"float\": function (val, allowedValues, toNative) {\r\n            var _float = parseFloat(val);\r\n            if (!toNative) {\r\n                return _float ? expandExponential(_float + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(_float, allowedValues);\r\n        },\r\n\r\n        \"char\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            } else if (val === false || val === true || val == \"true\" || val == \"yes\" || val == \"false\" || val == \"no\") {\r\n                val = (val === true || val == \"true\" || val == \"yes\") ? \"1\" : \"0\";\r\n            } else {\r\n                val = val.toString();\r\n            }\r\n            if (val.length > 0) {\r\n                val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n                return val.charAt(0);\r\n            }\r\n            return val;\r\n        },\r\n\r\n        \"string\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            val = val + \"\";\r\n\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            return val;\r\n        },\r\n\r\n        \"xmlObj\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            val = val + \"\";\r\n\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            try {\r\n                var s = '';\r\n\r\n                var currentPos = val.indexOf('&');\r\n                while (currentPos > 0) {\r\n                    var idx = val.indexOf(';', currentPos);\r\n                    if (idx < 0 || (idx - currentPos) > 5) {\r\n                        val = val.substr(0, currentPos) + \"&amp;\" + val.substr(currentPos + 1, val.length - (currentPos + 1));\r\n                    }\r\n                    currentPos = val.indexOf('&', currentPos + 1);\r\n                }\r\n\r\n                var xml = parseXML(val);\r\n                return xmlToJson(xml);\r\n            } catch (exception) {\r\n                console.error(exception);\r\n                return val;\r\n            }\r\n        },\r\n\r\n        \"date\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"dateTime\": function (val, allowedValues, toNative) {\r\n            if (toNative) { // Parse to ECMA Date object\r\n                if (Object.prototype.toString.call(val) == '[object String]') {\r\n                    val = new Date(parseDate(val));\r\n                    if (isNaN(val)) val = \"\";\r\n                } else if (Object.prototype.toString.call(val) == '[object Date]') {\r\n                    val = val;\r\n                }\r\n            } else { // Parse to ISO-8601 string\r\n                if (Object.prototype.toString.call(val) == '[object String]') {\r\n                    val = val + \"\";\r\n                } else if (Object.prototype.toString.call(val) == '[object Date]') {\r\n                    if (val.toString() == \"Invalid Date\") { // opera specific functionality\r\n                        val = \"\";\r\n                    } else {\r\n                        val = val.toISOString();\r\n                    }\r\n                }\r\n            }\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            return val;\r\n        },\r\n\r\n        \"dateTime_tz\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"time\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"time_tz\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"boolean\": function (val, allowedValues, toNative) {\r\n            if (val == 'false' || val == 'f' || val == 'no' || val == 'n' || val instanceof RegExp || val <= 0 || !val) {\r\n                if (toNative) {\r\n                    val = false;\r\n                } else {\r\n                    val = \"0\";\r\n                }\r\n            } else {\r\n                if (toNative) {\r\n                    val = true;\r\n                } else {\r\n                    val = \"1\";\r\n                }\r\n            }\r\n            return val;\r\n        },\r\n\r\n        \"bin_base64\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            if (val === true || val === false) {\r\n                val = val === true ? \"1\" : \"0\";\r\n            }\r\n            if (toNative) { // convert to string\r\n                val = atob(val + \"\");\r\n            } else { // convert to base64\r\n                val = btoa(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"bin_hex\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            if (val === true || val === false) {\r\n                val = val === true ? \"1\" : \"0\";\r\n            }\r\n            if (toNative) { // convert to string\r\n                val = htoa(val + \"\");\r\n            } else { // convert to hex\r\n                val = atoh(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"uri\": function (val, allowedValues, toNative) {\r\n            if (toNative) {\r\n                val = decodeURI(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['string'](val, allowedValues); // No URI syntax checking\r\n        },\r\n\r\n        \"uuid\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['string'](val, allowedValues); // No UUID syntax checking\r\n        }\r\n\r\n    };\r\n\r\n    // Override .types toString function\r\n    for (var type in WinJSContrib.UPnP.UPnPService.prototype.types) {\r\n        WinJSContrib.UPnP.UPnPService.prototype.types[type]._name = type;\r\n        WinJSContrib.UPnP.UPnPService.prototype.types[type][\"toString\"] = function () { return this._name; };\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.createRequest = function (upnpServiceType, upnpActionName, parameters) {\r\n\r\n        parameters = this.formatParameters(parameters);\r\n\r\n        this.debugLog('Creating UPnP XML Control Message for [' + upnpActionName + '] with parameters:');\r\n        this.debugLog(JSON ? JSON.stringify(parameters) : null);\r\n\r\n        // Build basic part of XML request\r\n        var svcMsg = this.requestTemplate.replace(/\\{ACTION_TYPE\\}/g, encodeXML(trim(upnpServiceType)));\r\n\r\n        svcMsg = svcMsg.replace(/\\{ACTION_NAME\\}/g, encodeXML(trim(upnpActionName)));\r\n\r\n        var svcInParams = parameters['request'],\r\n            svcInParams_xml = \"\";\r\n\r\n        if (svcInParams) {\r\n\r\n            // Generate XML parameters syntax\r\n            for (var svcParam in svcInParams) {\r\n\r\n                // Perform type checking sanitization\r\n                if (svcInParams[svcParam]['type'] !== undefined && svcInParams[svcParam]['type'] !== null) {\r\n\r\n                    // get the primitive sanitization function\r\n                    var typeCheck = this.types[svcInParams[svcParam]['type']];\r\n\r\n                    if (typeCheck) {\r\n                        svcInParams[svcParam]['value'] = typeCheck(svcInParams[svcParam]['value'], svcInParams[svcParam]['allowedValueList'], false);\r\n                    }\r\n\r\n                }\r\n\r\n                if (svcInParams[svcParam]['value'] === null || svcInParams[svcParam]['value'] === undefined) {\r\n\r\n                    svcInParams[svcParam]['value'] = \"\"; // pass through empty value\r\n\r\n                }\r\n\r\n                svcInParams_xml += \"\\t\\t\\t<\" + svcParam + \">\" + encodeXML(trim(svcInParams[svcParam]['value'] + \"\")) + \"</\" + svcParam + \">\\n\";\r\n\r\n            }\r\n\r\n        }\r\n\r\n        // Add ACTION_VARS, if any\r\n        svcMsg = svcMsg.replace(/\\{ACTION_VARS\\}/g, svcInParams_xml);\r\n\r\n        // DEBUG\r\n        this.debugLog('[REQUEST] (SOAPAction: ' + upnpServiceType + '#' + upnpActionName + ') ' + svcMsg);\r\n\r\n        return svcMsg;\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.sendRequest = function (upnpServiceType, upnpActionName, upnpEndpointURL, upnpRequestXML, onUPnPResponse) {\r\n\r\n        var soapaction = '\\\"' + upnpServiceType.replace(/[\\\"\\#]/g, '') + '#' + upnpActionName.replace(/[\\\"\\#]/g, '') + '\\\"'\r\n        var httpClient = new Windows.Web.Http.HttpClient();\r\n        var uri = new Windows.Foundation.Uri(upnpEndpointURL);\r\n        var request = new Windows.Web.Http.HttpRequestMessage(Windows.Web.Http.HttpMethod.post, uri);\r\n        request.headers.append('SOAPACTION', soapaction);\r\n        //request.headers.append('Content-Type', 'text/xml; charset=\"utf-8\";');        \r\n\r\n        request.content = new Windows.Web.Http.HttpStringContent(upnpRequestXML, Windows.Storage.Streams.UnicodeEncoding.utf8, \"text/xml\");\r\n\r\n        httpClient.sendRequestAsync(request).then(function (r) {\r\n            var content = r.content.readAsStringAsync().then(function (text) {\r\n                var xml = parseXML(text);\r\n                var r = {\r\n                    status: 200,\r\n                    responseText: text,\r\n                    responseXML: xml\r\n                };\r\n                onUPnPResponse.apply(this, [null, r]);\r\n            });\r\n\r\n        }, function (err) {\r\n            onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest failed'), null]);\r\n        });\r\n\r\n        return this;\r\n\r\n        try {\r\n\r\n            var xhr = new XMLHttpRequest();\r\n\r\n            xhr.open('POST', upnpEndpointURL);\r\n            xhr.setRequestHeader('Content-Type', 'text/xml; charset=\"utf-8\";');\r\n            xhr.setRequestHeader('action', soapaction);\r\n            xhr.setRequestHeader('zurgl', soapaction);\r\n            xhr.setRequestHeader('SOAPAction', soapaction);\r\n\r\n            xhr.onabort = xhr.onerror = function () {\r\n\r\n                onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest failed'), null]);\r\n\r\n                //xhrManager.release(xhr);\r\n\r\n            };\r\n\r\n            var self = this;\r\n\r\n            xhr.onreadystatechange = function () {\r\n\r\n                if (this.readyState < 4) return;\r\n\r\n                if (this.status !== 200) {\r\n\r\n                    onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest expected 200 OK. Received ' + this.status + ' response.'), null]);\r\n\r\n                    self.debugLog(\"[ERROR-RESPONSE] \" + this.responseText);\r\n\r\n                    //xhrManager.release(xhr);\r\n\r\n                    return;\r\n\r\n                }\r\n\r\n                self.debugLog(\"[SUCCESS-RESPONSE] \" + this.responseText);\r\n\r\n                onUPnPResponse.apply(this, [null, this]);\r\n\r\n                //xhrManager.release(xhr);\r\n\r\n            };\r\n\r\n            xhr.send(upnpRequestXML);\r\n\r\n        } catch (e) {\r\n\r\n            onUPnPResponse.apply(undefined, [new UPnPError(e), null]);\r\n\r\n        }\r\n\r\n        return this; // allow method chaining\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.handleResponse = function (upnpActionName, upnpResponseXML, parameters, onUPnPResolved) {\r\n\r\n        parameters = this.formatParameters(parameters);\r\n\r\n        var svcOutParams = parameters['response'];\r\n\r\n        var responseJSON = {};\r\n\r\n        // Process all XML response variables\r\n        var responseContainer = upnpResponseXML.getElementsByTagName ?\r\n                                  upnpResponseXML.getElementsByTagName(upnpActionName + \"Response\") : null;\r\n\r\n        // If we don't have any response variables, try again with the namespace attached (required for lib to work in Firefox)\r\n        if (responseContainer === null || responseContainer.length <= 0) {\r\n            responseContainer = upnpResponseXML.getElementsByTagName ?\r\n                                      upnpResponseXML.getElementsByTagName(\"u:\" + upnpActionName + \"Response\") : null;\r\n        }\r\n\r\n        if (responseContainer !== null && responseContainer.length > 0) {\r\n\r\n            var responseVars = responseContainer[0].childNodes;\r\n\r\n            if (responseVars && responseVars.length > 0) {\r\n\r\n                for (var i = 0, l = responseVars.length; i < l; i++) {\r\n\r\n                    var varName = responseVars[i].nodeName;\r\n                    var varVal = responseVars[i].firstChild ? trim(decodeXML(responseVars[i].firstChild.nodeValue + \"\")) : null;\r\n\r\n                    // Perform type checking sanitization if requested\r\n                    if (svcOutParams[varName] && svcOutParams[varName]['type'] !== undefined && svcOutParams[varName]['type'] !== null) {\r\n\r\n                        // get the primitive sanitization function\r\n                        var typeCheck = this.types[svcOutParams[varName]['type']];\r\n\r\n                        if (typeCheck) {\r\n                            varVal = typeCheck(varVal, svcOutParams[varName]['allowedValueList'] || null, true);\r\n                        }\r\n\r\n                    }\r\n\r\n                    responseJSON[varName] = (varVal !== undefined && varVal !== null) ? varVal : \"\";\r\n\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n        // Fire callback with the parsed action response data\r\n        onUPnPResolved.apply(undefined, [null, { data: responseJSON }]);\r\n\r\n        return this; // allow method chaining\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.formatParameter = function (parameter) {\r\n\r\n        var param = {};\r\n\r\n        if (parameter['type'] !== undefined || parameter['value'] !== undefined || parameter['allowedValueList'] !== undefined) {\r\n\r\n            param = parameter;\r\n\r\n            if (parameter['allowedValueList'] !== undefined && typeof parameter['allowedValueList'] !== 'array') {\r\n                parameter['allowedValueList'] = [];\r\n            }\r\n\r\n        } else {\r\n\r\n            param = { value: parameter };\r\n\r\n        }\r\n\r\n        // check type is valid, otherwise discard requested type\r\n        if (param['type'] !== undefined && param['type'] !== null) {\r\n\r\n            if (!this.types[(param['type'] + \"\")]) {\r\n\r\n                delete param['type'];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return param;\r\n\r\n    };\r\n\r\n    // Normalize the input parameters argument\r\n    WinJSContrib.UPnP.UPnPService.prototype.formatParameters = function (parameters) {\r\n\r\n        if (parameters === undefined || parameters === null) {\r\n            parameters = {};\r\n        }\r\n\r\n        if (!parameters['request']) {\r\n            parameters['request'] = {};\r\n        }\r\n\r\n        if (!parameters['response']) {\r\n            parameters['response'] = {};\r\n        }\r\n\r\n        for (var param in parameters) {\r\n\r\n            if (param === 'request' || param === 'response') {\r\n\r\n                for (var processParam in parameters[param]) {\r\n\r\n                    parameters[param][processParam] = this.formatParameter(parameters[param][processParam]);\r\n\r\n                }\r\n\r\n            } else { // append as 'request' parameter and remove from root object\r\n\r\n                parameters['request'][param] = this.formatParameter(parameters[param]);\r\n\r\n                delete parameters[param];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return parameters;\r\n\r\n    };\r\n\r\n    // ALLOWED VALUE LIST CHECKER\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues = function (val, allowedValueList) {\r\n\r\n        // Check against allowedValues if provided\r\n        if (val && allowedValueList && Object.prototype.toString.call(allowedValueList) == '[object Array]') {\r\n\r\n            var matchFound = false;\r\n\r\n            for (var i = 0, l = allowedValueList.length; i < l; i++) {\r\n\r\n                if (val == allowedValueList[i]) {\r\n\r\n                    matchFound = true;\r\n                    break;\r\n\r\n                }\r\n            }\r\n\r\n            if (!matchFound) {\r\n                return \"\";\r\n            }\r\n        }\r\n\r\n        return val;\r\n\r\n    };\r\n\r\n    // UPnP DEBUGGER\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.debugLog = function (msg, level) {\r\n        if ((this.options && this.options.debug)) {\r\n            console[level || 'log'](\"Plug.UPnP: \" + msg);\r\n        }\r\n    };\r\n\r\n    // UPnP ERROR OBJECT\r\n\r\n    var UPnPError = function (description) {\r\n        return {\r\n            'description': description\r\n        };\r\n    };\r\n\r\n    function parseXML(text) {\r\n        return (new DOMParser()).parseFromString(text, \"text/xml\");\r\n    }\r\n\r\n    // *** CUSTOM TYPE FUNCTIONS ***\r\n\r\n    // BASE64 FUNCTIONS\r\n    // (forked from https://github.com/dankogai/js-base64/blob/master/base64.js)\r\n\r\n    var b64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\r\n\r\n    var b64tab = (function (bin) {\r\n        var t = {};\r\n        for (var i = 0, l = bin.length; i < l; i++) t[bin.charAt(i)] = i;\r\n        return t;\r\n    })(b64chars);\r\n\r\n    var cb_encode = function (ccc) {\r\n        var padlen = [0, 2, 1][ccc.length % 3],\r\n            ord = ccc.charCodeAt(0) << 16\r\n                | ((ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8)\r\n                | ((ccc.length > 2 ? ccc.charCodeAt(2) : 0)),\r\n            chars = [\r\n                b64chars.charAt(ord >>> 18),\r\n                b64chars.charAt((ord >>> 12) & 63),\r\n                padlen >= 2 ? '=' : b64chars.charAt((ord >>> 6) & 63),\r\n                padlen >= 1 ? '=' : b64chars.charAt(ord & 63)\r\n            ];\r\n        return chars.join('');\r\n    };\r\n\r\n    var cb_decode = function (cccc) {\r\n        var len = cccc.length,\r\n            padlen = len % 4,\r\n            n = (len > 0 ? b64tab[cccc.charAt(0)] << 18 : 0)\r\n              | (len > 1 ? b64tab[cccc.charAt(1)] << 12 : 0)\r\n              | (len > 2 ? b64tab[cccc.charAt(2)] << 6 : 0)\r\n              | (len > 3 ? b64tab[cccc.charAt(3)] : 0),\r\n            chars = [\r\n                String.fromCharCode(n >>> 16),\r\n                String.fromCharCode((n >>> 8) & 0xff),\r\n                String.fromCharCode(n & 0xff)\r\n            ];\r\n        chars.length -= [0, 0, 2, 1][padlen];\r\n        return chars.join('');\r\n    };\r\n\r\n    var btoa = global.btoa || function (b) {\r\n        return b.replace(/[\\s\\S]{1,3}/g, cb_encode);\r\n    };\r\n\r\n    var atob = global.atob || function (a) {\r\n        return a.replace(/[\\s\\S]{1,4}/g, cb_decode);\r\n    };\r\n\r\n    // HEX FUNCTIONS\r\n\r\n    var hexChars = '0123456789abcdef';\r\n\r\n    var hextab = (function (bin) {\r\n        var t = {};\r\n        for (var i = 0, l = bin.length; i < l; i++) t[i] = bin.charAt(i);\r\n        return t;\r\n    })(hexChars);\r\n\r\n    function toHex(n) {\r\n        var result = ''\r\n        var start = true;\r\n        for (var i = 32; i > 0;) {\r\n            i -= 4;\r\n            var digit = (n >> i) & 0xf;\r\n            if (!start || digit != 0) {\r\n                start = false;\r\n                result += hextab[digit];\r\n            }\r\n        }\r\n        return (result == '' ? '0' : result);\r\n    }\r\n\r\n    function pad(str, len, pad) {\r\n        var result = str;\r\n        for (var i = str.length; i < len; i++) {\r\n            result = pad + result;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function ntos(n) {\r\n        n = n.toString(16);\r\n        if (n.length == 1) n = \"0\" + n;\r\n        n = \"%\" + n;\r\n        return unescape(n);\r\n    }\r\n\r\n    function htoa(str) {\r\n        str = str.toUpperCase().replace(new RegExp(\"s/[^0-9A-Z]//g\"));\r\n        var result = \"\";\r\n        var nextchar = \"\";\r\n        for (var i = 0; i < str.length; i++) {\r\n            nextchar += str.charAt(i);\r\n            if (nextchar.length == 2) {\r\n                result += ntos(parseInt(nextchar, 16));\r\n                nextchar = \"\";\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function atoh(str) {\r\n        var result = \"\";\r\n        for (var i = 0; i < str.length; i++) {\r\n            result += pad(toHex(str.charCodeAt(i) & 0xff), 2, '0');\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // NUMBER FUNCTIONS\r\n\r\n    function expandExponential(str) {\r\n        return str.replace(/^([+-])?(\\d+).?(\\d*)[eE]([-+]?\\d+)$/, function (x, s, n, f, c) {\r\n            var l = +c < 0, i = n.length + +c, x = (l ? n : f).length,\r\n            c = ((c = Math.abs(c)) >= x ? c - x + l : 0),\r\n            z = (new Array(c + 1)).join(\"0\"), r = n + f;\r\n            return (s || \"\") + (l ? r = z + r : r += z).substr(0, i += l ? z.length : 0) + (i < r.length ? \".\" + r.substr(i) : \"\");\r\n        });\r\n    };\r\n\r\n    // STRING FUNCTIONS\r\n\r\n    var trim = function (str) {\r\n        if (String.prototype.trim) {\r\n            return str.trim();\r\n        } else {\r\n            return str.replace(/^\\s+|\\s+$/g, \"\");\r\n        }\r\n    };\r\n\r\n    var encodeXML = function (str) {\r\n        return str.replace(/\\&/g, '&amp;')\r\n                   .replace(/</g, '&lt;')\r\n                   .replace(/>/g, '&gt;')\r\n                   .replace(/'/g, '&#39;')\r\n                   .replace(/\"/g, '&quot;');\r\n    };\r\n\r\n    var decodeXML = function (str) {\r\n        return str.replace(/\\&quot;/g, '\"')\r\n                   .replace(/\\&\\#39;/g, '\\'')\r\n                   .replace(/\\&gt;/g, '>')\r\n                   .replace(/\\&lt;/g, '<')\r\n                   .replace(/\\&amp;/g, '&');\r\n    };\r\n\r\n    /**\r\n     * Date.parse with progressive enhancement for ISO 8601 <https://github.com/csnover/js-iso8601>\r\n     *  2011 Colin Snover <http://zetafleet.com>\r\n     * Released under MIT license.\r\n     *\r\n     * 2012 - Modifications to accept times without dates - by Rich Tibbett\r\n     */\r\n\r\n    var parseDate = function (date) {\r\n        var timestamp, struct, minutesOffset = 0, numericKeys = [1, 4, 5, 6, 7, 10, 11];\r\n\r\n        if (typeof date !== 'string') date += \"\";\r\n\r\n        if ((struct = /^((\\d{4}|[+\\-]\\d{6})(?:-(\\d{2})(?:-(\\d{2}))?)?)?(?:[T\\s]?(\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d{3}))?)?(?:(Z)|([+\\-])(\\d{4}))?)?$/.exec(date))) {\r\n\r\n            struct = struct.slice(1, struct.length);\r\n\r\n            // avoid NaN timestamps caused by undefined values being passed to Date.UTC\r\n            for (var i = 0, k; (k = numericKeys[i]) ; ++i) {\r\n                struct[k] = +struct[k] || 0;\r\n            }\r\n\r\n            // allow undefined days and months\r\n            struct[2] = (+struct[2] || 1) - 1;\r\n            struct[3] = +struct[3] || 1;\r\n\r\n            if (struct[8] !== 'Z' && struct[9] !== undefined) {\r\n                minutesOffset = ((struct[10] / 100) - ((struct[10] / 100) % 1)) * 60 + (struct[10] % 100);\r\n\r\n                if (struct[9] === '+') {\r\n                    minutesOffset = 0 - minutesOffset;\r\n                }\r\n            }\r\n\r\n            timestamp = Date.UTC(struct[1], struct[2], struct[3], struct[4], struct[5] + minutesOffset, struct[6], struct[7]);\r\n        }\r\n        else {\r\n            timestamp = Date.parse ? Date.parse(date) : NaN;\r\n        }\r\n\r\n        return timestamp;\r\n    };\r\n\r\n    var allowedContentDirectoryTypes = {\r\n        'urn:schemas-upnp-org:service:ContentDirectory:1': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:2': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:3': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:4': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPContentDirectory = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedContentDirectoryTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Server Service\");\r\n            return;\r\n        }\r\n\r\n        // *** ContentDirectory:1 methods\r\n\r\n        this.getSystemUpdateId = function (callback) {\r\n\r\n            return this.action('GetSystemUpdateID', {\r\n                request: {},\r\n                response: {\r\n                    Id: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSearchCapabilities = function (callback) {\r\n\r\n            return this.action('GetSearchCapabilities', {\r\n                request: {},\r\n                response: {\r\n                    SearchCaps: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSortCapabilities = function (callback) {\r\n\r\n            return this.action('GetSortCapabilities', {\r\n                request: {},\r\n                response: {\r\n                    SortCaps: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.browse = function (objectId, browseFlag, filter, startingIndex, requestedCount, sortCriteria, callback) {\r\n\r\n            return this.action('Browse', {\r\n                request: {\r\n                    ObjectID: {\r\n                        value: objectId || '0',\r\n                        type: this.types.string\r\n                    },\r\n                    BrowseFlag: {\r\n                        value: browseFlag || 'BrowseDirectChildren',\r\n                        type: this.types.string\r\n                    },\r\n                    Filter: {\r\n                        value: filter || '*',\r\n                        type: this.types.string\r\n                    },\r\n                    StartingIndex: {\r\n                        value: startingIndex || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    RequestedCount: {\r\n                        value: requestedCount || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    SortCriteria: {\r\n                        value: sortCriteria,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    Result: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    NumberReturned: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TotalMatches: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    UpdateID: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.search = function (objectId, browseFlag, filter, startingIndex, requestedCount, sortCriteria, callback) {\r\n\r\n            return this.action('Search', {\r\n                request: {\r\n                    ObjectID: {\r\n                        value: objectId || '0',\r\n                        type: this.types.string\r\n                    },\r\n                    BrowseFlag: {\r\n                        value: browseFlag || 'BrowseDirectChildren',\r\n                        type: this.types.string\r\n                    },\r\n                    Filter: {\r\n                        value: filter || '*',\r\n                        type: this.types.string\r\n                    },\r\n                    StartingIndex: {\r\n                        value: startingIndex || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    RequestedCount: {\r\n                        value: requestedCount || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    SortCriteria: {\r\n                        value: sortCriteria,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    Result: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    NumberReturned: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TotalMatches: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    UpdateID: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n\r\n        // *** ContentDirectory:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:2') {\r\n\r\n            // TODO: GetFeatureList, GetSortExtensionCapabilities, MoveObject\r\n\r\n        }\r\n\r\n\r\n        // *** ContentDirectory:3 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:3') {\r\n\r\n            // TODO\r\n\r\n        }\r\n\r\n        // *** ContentDirectory:4 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:4') {\r\n            // TODO\r\n        }\r\n    };\r\n    WinJSContrib.UPnP.UPnPContentDirectory.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedConnectionManagerTypes = {\r\n        'urn:schemas-upnp-org:service:ConnectionManager:1': true,\r\n        'urn:schemas-upnp-org:service:ConnectionManager:2': true,\r\n        'urn:schemas-upnp-org:service:ConnectionManager:3': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPConnectionManager = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedConnectionManagerTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Service\");\r\n            return;\r\n        }\r\n\r\n        // *** ConnectionManager:1 methods\r\n\r\n        this.getCurrentConnectionIDs = function (callback) {\r\n\r\n            return this.action('GetCurrentConnectionIDs', {\r\n                request: {},\r\n                response: {\r\n                    ConnectionIDs: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getCurrentConnectionInfo = function (connectionId, callback) {\r\n\r\n            return this.action('GetCurrentConnectionInfo', {\r\n                request: {\r\n                    ConnectionID: {\r\n                        value: connectionId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    RcsID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    AVTransportID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    ProtocolInfo: {\r\n                        type: this.types.string\r\n                    },\r\n                    PeerConnectionManager: {\r\n                        type: this.types.string\r\n                    },\r\n                    PeerConnectionID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    Direction: {\r\n                        type: this.types.string\r\n                    },\r\n                    Status: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getProtocolInfo = function (callback) {\r\n\r\n            return this.action('GetProtocolInfo', {\r\n                request: {},\r\n                response: {\r\n                    Source: {\r\n                        type: this.types.string\r\n                    },\r\n                    Sink: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** ConnectionManager:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ConnectionManager:2') {\r\n            // TODO\r\n        }\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPConnectionManager.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedAVTransportTypes = {\r\n        'urn:schemas-upnp-org:service:AVTransport:1': true,\r\n        'urn:schemas-upnp-org:service:AVTransport:2': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPAVTransport = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedAVTransportTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Renderer Service\");\r\n            return;\r\n        }\r\n\r\n        // *** AVTransport:1 methods\r\n\r\n        this.getDeviceCapabilities = function (instanceId, callback) {\r\n\r\n            return this.action('GetDeviceCapabilities', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    PlayMedia: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecMedia: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecQualityModes: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getMediaInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetMediaInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    NrTracks: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    MediaDuration: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURIMetaData: {\r\n                        type: this.types.string\r\n                    },\r\n                    NextURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    NextURIMetaData: {\r\n                        type: this.types.string\r\n                    },\r\n                    PlayMedium: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecordMedium: {\r\n                        type: this.types.string\r\n                    },\r\n                    WriteStatus: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getPositionInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetPositionInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    Track: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TrackDuration: {\r\n                        type: this.types.string\r\n                    },\r\n                    TrackMetaData: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    TrackURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    RelTime: {\r\n                        type: this.types.string\r\n                    },\r\n                    AbsTime: {\r\n                        type: this.types.string\r\n                    },\r\n                    RelCount: {\r\n                        type: this.types.i4\r\n                    },\r\n                    AbsCount: {\r\n                        type: this.types.i4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getTransportInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetTransportInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentTransportState: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentTransportStatus: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentSpeed: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getTransportSettings = function (instanceId, callback) {\r\n\r\n            return this.action('GetTransportSettings', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    PlayMode: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    RecQualityMode: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setAVTransportURI = function (instanceId, currentURI, currentURIMetaData, callback) {\r\n\r\n            return this.action('SetAVTransportURI', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    CurrentURI: {\r\n                        value: currentURI,\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURIMetaData: {\r\n                        value: currentURIMetaData,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.play = function (instanceId, speed, callback) {\r\n\r\n            return this.action('Play', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Speed: {\r\n                        value: speed || '1',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.pause = function (instanceId, callback) {\r\n\r\n            return this.action('Pause', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.stop = function (instanceId, callback) {\r\n\r\n            return this.action('Stop', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.next = function (instanceId, callback) {\r\n\r\n            return this.action('Next', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.previous = function (instanceId, callback) {\r\n\r\n            return this.action('Previous', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.seek = function (instanceId, unit, target, callback) {\r\n\r\n            return this.action('Seek', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Unit: {\r\n                        value: unit,\r\n                        type: this.types.string\r\n                    },\r\n                    Target: {\r\n                        value: target,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** AVTransport:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:AVTransport:2') {\r\n\r\n            // TODO\r\n\r\n        }\r\n    };\r\n    WinJSContrib.UPnP.UPnPAVTransport.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedRenderingControlTypes = {\r\n        'urn:schemas-upnp-org:service:RenderingControl:1': true,\r\n        'urn:schemas-upnp-org:service:RenderingControl:2': true,\r\n        'urn:schemas-upnp-org:service:RenderingControl:3': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPRenderingControl = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedRenderingControlTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Renderer Service\");\r\n            return;\r\n        }\r\n\r\n        // *** RenderingControl:1 methods\r\n\r\n        this.listPresets = function (instanceId, callback) {\r\n\r\n            return this.action('ListPresets', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentPresetNameList: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.selectPreset = function (instanceId, presetName, callback) {\r\n\r\n            return this.action('SelectPreset', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    PresetName: {\r\n                        value: presetName || \"FactoryDefaults\",\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBrightness = function (instanceId, callback) {\r\n\r\n            return this.action('GetBrightness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBrightness: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBrightness = function (instanceId, desiredBrightness, callback) {\r\n\r\n            return this.action('SetBrightness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBrightness: {\r\n                        value: desiredBrightness,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getContrast = function (instanceId, callback) {\r\n\r\n            return this.action('GetContrast', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentContrast: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setContrast = function (instanceId, desiredContrast, callback) {\r\n\r\n            return this.action('SetContrast', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredContrast: {\r\n                        value: desiredContrast,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSharpness = function (instanceId, callback) {\r\n\r\n            return this.action('GetSharpness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentSharpness: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setSharpness = function (instanceId, desiredSharpness, callback) {\r\n\r\n            return this.action('SetSharpness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredSharpness: {\r\n                        value: desiredSharpness,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getRedVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetRedVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentRedVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setRedVideoGain = function (instanceId, desiredRedVideoGain, callback) {\r\n\r\n            return this.action('SetRedVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredRedVideoGain: {\r\n                        value: desiredRedVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getGreenVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetGreenVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentGreenVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setGreenVideoGain = function (instanceId, desiredGreenVideoGain, callback) {\r\n\r\n            return this.action('SetGreenVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredGreenVideoGain: {\r\n                        value: desiredGreenVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBlueVideoGain = function (instanceId, desiredBlueVideoGain, callback) {\r\n\r\n            return this.action('SetBlueVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBlueVideoGain: {\r\n                        value: desiredBlueVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getRedVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetRedVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentRedVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setRedVideoBlackLevel = function (instanceId, desiredRedVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetRedVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredRedVideoBlackLevel: {\r\n                        value: desiredRedVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getGreenVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetGreenVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentGreenVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setGreenVideoBlackLevel = function (instanceId, desiredGreenVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetGreenVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredGreenVideoBlackLevel: {\r\n                        value: desiredGreenVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBlueVideoBlackLevel = function (instanceId, desiredBlueVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBlueVideoBlackLevel: {\r\n                        value: desiredBlueVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getColorTemperature = function (instanceId, callback) {\r\n\r\n            return this.action('GetColorTemperature', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentColorTemperature: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setColorTemperature = function (instanceId, desiredColorTemperature, callback) {\r\n\r\n            return this.action('SetColorTemperature', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredColorTemperature: {\r\n                        value: desiredColorTemperature,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getHorizontalKeystone = function (instanceId, callback) {\r\n\r\n            return this.action('GetHorizontalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentHorizontalKeystone: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setHorizontalKeystone = function (instanceId, desiredHorizontalKeystone, callback) {\r\n\r\n            return this.action('SetHorizontalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredHorizontalKeystone: {\r\n                        value: desiredHorizontalKeystone,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVerticalKeystone = function (instanceId, callback) {\r\n\r\n            return this.action('GetVerticalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVerticalKeystone: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVerticalKeystone = function (instanceId, desiredVerticalKeystone, callback) {\r\n\r\n            return this.action('SetVerticalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredVerticalKeystone: {\r\n                        value: desiredVerticalKeystone,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getMute = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetMute', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentMute: {\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setMute = function (instanceId, channel, desiredMute, callback) {\r\n\r\n            return this.action('SetMute', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredMute: {\r\n                        value: desiredMute,\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolume = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolume', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVolume: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVolume = function (instanceId, channel, desiredVolume, callback) {\r\n\r\n            return this.action('SetVolume', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredVolume: {\r\n                        value: desiredVolume,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolumeDB = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolumeDB', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVolume: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVolumeDB = function (instanceId, channel, desiredVolume, callback) {\r\n\r\n            return this.action('SetVolumeDB', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredVolume: {\r\n                        value: desiredVolume,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolumeDBRange = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolumeDBRange', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    MinValue: {\r\n                        type: this.types.i2\r\n                    },\r\n                    MaxValue: {\r\n                        type: this.types.i2\r\n                    },\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getLoudness = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetLoudness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentLoudness: {\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setLoudness = function (instanceId, channel, desiredLoudness, callback) {\r\n\r\n            return this.action('SetLoudness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredLoudness: {\r\n                        value: desiredLoudness,\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** RenderingControl:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:2' ||\r\n              this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:3') {\r\n\r\n            this.getStateVariables = function (instanceId, stateVariableList, callback) {\r\n\r\n                return this.action('GetStateVariables', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        StateVariableList: {\r\n                            value: stateVariableList,\r\n                            type: this.types.string\r\n                        }\r\n                    },\r\n                    response: {\r\n                        StateVariableValuePairs: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setStateVariables = function (instanceId, renderingControlUDN, serviceType, serviceId, stateVariableValuePairs, callback) {\r\n\r\n                return this.action('SetStateVariables', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        RenderingControlUDN: {\r\n                            value: renderingControlUDN,\r\n                            type: this.types.string\r\n                        },\r\n                        ServiceType: {\r\n                            value: serviceType,\r\n                            type: this.types.string\r\n                        },\r\n                        ServiceId: {\r\n                            value: serviceId,\r\n                            type: this.types.string\r\n                        },\r\n                        StateVariableValuePairs: {\r\n                            value: stateVariableValuePairs,\r\n                            type: this.types.string\r\n                        }\r\n                    },\r\n                    response: {\r\n                        StateVariableList: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n        }\r\n\r\n        // *** RenderingControl:3 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:3') {\r\n\r\n            this.getAllowedTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllowedTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        }\r\n                    },\r\n                    response: {\r\n                        CurrentAllowedTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        }\r\n                    },\r\n                    response: {\r\n                        CurrentTransformValues: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setTransforms = function (instanceId, desiredTransformValues, callback) {\r\n\r\n                return this.action('SetTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        DesiredTransformValues: {\r\n                            value: desiredTransformValues,\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getAllAvailableTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllAvailableTransforms', {\r\n                    response: {\r\n                        AllAllowedTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getAllowedDefaultTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllowedDefaultTransforms', {\r\n                    response: {\r\n                        AllowedDefaultTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getDefaultTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetDefaultTransforms', {\r\n                    response: {\r\n                        CurrentDefaultTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setDefaultTransforms = function (instanceId, desiredDefaultTransformSettings, callback) {\r\n\r\n                return this.action('SetDefaultTransforms', {\r\n                    request: {\r\n                        DesiredDefaultTransformSettings: {\r\n                            value: desiredDefaultTransformSettings,\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n        }\r\n\r\n    };\r\n    WinJSContrib.UPnP.UPnPRenderingControl.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n})(window);","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib;\r\n(function (WinJSContrib) {\r\n    'use strict';\r\n\r\n    /**\r\n     * Custom WinJS Bindings\r\n     * @namespace WinJSContrib.Bindings\r\n     */\r\n    (function (Bindings) {\r\n\r\n        /**\r\n         * path for default picture\r\n         */\r\n        WinJSContrib.Bindings.pictureUnavailable = '/images/unavailable.png';\r\n\r\n        /**\r\n         * Helper for reading arguments for an element\r\n         * @param {HTMLElement} element\r\n         * @param {string} argument name\r\n         */\r\n        WinJSContrib.Bindings.bindingArguments = function bindingArguments(elt, argname) {\r\n            var data;\r\n            if (WinJS.UI._optionsParser) {\r\n                var text = elt.getAttribute(\"data-win-bind-args\");\r\n                if (text) {\r\n                    data = WinJS.UI.optionsParser(text, window);\r\n                }\r\n            } else {\r\n                data = elt.dataset.winBindArgs;\r\n            }\r\n\r\n            if (data) {\r\n                if (argname) {\r\n                    return data[argname];\r\n                } else {\r\n                    return data;\r\n                }\r\n            }\r\n        };\r\n        var bindingArguments = WinJSContrib.Bindings.bindingArguments;\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.removeHTML = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var elt = document.createElement('DIV');\r\n            elt.innerHTML = data;\r\n            WinJS.Binding.oneTime({ value: elt.innerText }, ['value'], dest, [destProperty]);\r\n        });\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination with an ellipse after X characters. The number of characters is specified with \"ellipsisize\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.removeHTMLAndEllipsisize = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var elt = document.createElement('DIV');\r\n            elt.innerHTML = data;\r\n            var textRes = elt.innerText;\r\n            var size = bindingArguments(dest, 'ellipsisize');\r\n\r\n            if (size)\r\n                textRes = toStaticHTML(WinJSContrib.Utils.ellipsisizeString(elt.innerText, size, true));\r\n            WinJS.Binding.oneTime({ value: textRes }, ['value'], dest, [destProperty]);\r\n        });\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination with an ellipse after X characters. The number of characters is specified with \"ellipsisize\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.staticHTML = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            dest[destProperty] = toStaticHTML(data);\r\n        });\r\n\r\n        /**\r\n         * Binding function to add a data-* attribute to the element. Use the destination name to specifiy attribute name\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         * @example\r\n         * //assuming object is { myproperty: 42 }\r\n         * <div data-win-bind=\"foo : myproperty WinJSContrib.Bindings.dataAttr\"></div>\r\n         * //will result to\r\n         * <div data-foo=\"42\" data-win-bind=\"foo : myproperty WinJSContrib.Bindings.dataAttr\"></div>\r\n         */\r\n        WinJSContrib.Bindings.dataAttr = WinJS.Binding.initializer(function dataAttrBinding(source, sourceProperty, dest, destProperty) {\r\n        \tvar data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n        \tdest.setAttribute('data-' + destProperty, data)\r\n        });\r\n\r\n        /**\r\n         * Binding function to add css class named after object property. You could format class by using a \"format\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.addClass = WinJS.Binding.initializer(function addClassBinding(source, sourceProperty, dest, destProperty) {\r\n            function setClass(newval, oldval) {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                var formatParameter = bindingArguments(dest, 'format');\r\n                if (formatParameter) {\r\n                    dest.classList.remove(formatParameter.format(oldval));\r\n                    dest.classList.add(formatParameter.format(data));\r\n                }\r\n                else {\r\n                    dest.classList.remove(oldval);\r\n                    dest.classList.add(data);\r\n                }\r\n            }\r\n\r\n            var bindingDesc = {};\r\n            bindingDesc[sourceProperty] = setClass;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * add css class based on a prefix defined with destProperty and the value from the source object\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.asClass = WinJS.Binding.initializer(function asClassBinding(source, sourceProperty, dest, destProperty) {\r\n            function setClass(newval, oldval) {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                dest.classList.remove(destProperty + '-' + oldval);\r\n                dest.classList.add(destProperty + '-' + data);\r\n            }\r\n            var bindingDesc = {};\r\n            bindingDesc[sourceProperty] = setClass;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * convert a url string for use as a background image url\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.toBgImage = WinJS.Binding.initializer(function toBgImageBinding(source, sourceProperty, dest, destProperty) {\r\n            function setImage() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data || !data.length) {\r\n                    dest.style.backgroundImage = '';\r\n                    return;\r\n                }\r\n                dest.style.backgroundImage = 'url(\"' + data + '\")';\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setImage;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n\r\n        WinJSContrib.Bindings.ToRealDate = WinJS.Binding.initializer(function ToRealDateBinding(source, sourceProperty, dest, destProperty) {\r\n            var date = new Date(source.date * 1000);\r\n            dest.innerHTML = date.toLocaleDateString();\r\n        });\r\n\r\n        function _setPic(dest, url) {\r\n            if (dest.nodeName.toLowerCase() == 'img') {\r\n                dest.src = url;\r\n            }\r\n            else {\r\n                dest.style.backgroundImage = 'url(\"' + url + '\")';\r\n            }\r\n            dest.classList.add('imageLoaded');\r\n        }\r\n\r\n        /**\r\n         * Asynchronously load a picture (using src for image tag and background-image for other elements) from url path, and add 'imageLoaded' css class once picture is ready. \r\n         * You could rely on '.imageLoaded' to add transitions for image loading\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.picture = WinJS.Binding.initializer(function toSmartBgImageBinding(source, sourceProperty, dest, destProperty) {\r\n            function setImage() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data || !data.length) {\r\n                    data = Bindings.pictureUnavailable;\r\n                }\r\n\r\n                dest.classList.remove('imageLoaded');\r\n                setTimeout(function () {\r\n                    WinJSContrib.UI.loadImage(data).done(function () {\r\n                        _setPic(dest, data);\r\n                    }, function () {\r\n                        _setPic(dest, Bindings.pictureUnavailable);\r\n                        WinJS.Utilities.addClass(dest, 'imageLoaded');\r\n                    });\r\n                }, 200);\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setImage;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.toSmartBgImage = WinJSContrib.Bindings.picture; //deprecated method name\r\n\r\n        /**\r\n         * show element if property is filled or true. The dest property can be used to choose what to use for showing/hiding object (opacity, visibility, or display)\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.showIf = WinJS.Binding.initializer(function hideUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.classList.remove('mcn-show');\r\n                    dest.classList.add('mcn-hide');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '0';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = 'hidden';\r\n                    } else {\r\n                        dest.style.display = 'none';\r\n                    }\r\n                } else {\r\n                    dest.classList.remove('mcn-hide');\r\n                    dest.classList.add('mcn-show');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = '';\r\n                    } else {\r\n                        dest.style.display = '';\r\n                    }\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * Alias for {@link WinJSContrib.Bindings.showIf}, just for semantic purpose\r\n         * @function\r\n         * @see WinJSContrib.Bindings.showIf\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.hideIfNot = WinJSContrib.Bindings.showIf;\r\n        WinJSContrib.Bindings.hideIfNotDefined = WinJSContrib.Bindings.showIf;//warning, deprecated\r\n\r\n        /**\r\n         * hide element if property is filled or true. The dest property can be used to choose what to use for showing/hiding object (opacity, visibility, or display)\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.hideIf = WinJS.Binding.initializer(function showUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.classList.remove('mcn-hide');\r\n                    dest.classList.add('mcn-show');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = '';\r\n                    } else {\r\n                        dest.style.display = '';\r\n                    }\r\n                } else {\r\n                    dest.classList.remove('mcn-show');\r\n                    dest.classList.add('mcn-hide');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '0';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = 'hidden';\r\n                    } else {\r\n                        dest.style.display = 'none';\r\n                    }\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * Alias for {@link WinJSContrib.Bindings.hideIf}, just for semantic purpose\r\n         * @function\r\n         * @see WinJSContrib.Bindings.hideIf\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.showIfNot = WinJSContrib.Bindings.hideIf; //warning, deprecated\r\n\r\n        WinJSContrib.Bindings.showIfNotDefined = WinJSContrib.Bindings.hideIf; //warning, deprecated\r\n\r\n        /**\r\n         * enable element if property is filled or true\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.enableIf = WinJS.Binding.initializer(function disableUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.disabled = true;\r\n                } else {\r\n                    dest.disabled = false;\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.disableIfNot = WinJSContrib.Bindings.enableIf;\r\n\r\n        /**\r\n         * disable element if property is filled or true\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.disableIf = WinJS.Binding.initializer(function enableUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.disabled = false;\r\n                } else {\r\n                    dest.disabled = true;\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.enableIfNot = WinJSContrib.Bindings.disableIf;\r\n\r\n        /**\r\n         * apply a percent number as width (in percent) on the element\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.toWidth = WinJS.Binding.initializer(function progressToWidth(source, sourceProperty, dest, destProperty) {\r\n            function setWidth() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.style.width = '';\r\n                } else {\r\n                    dest.style.width = data + '%';\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setWidth;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * truncate a string and add ellipse to the text if string is longer than a limit. The max size of text is determined by a 'ellipsisize' argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         * @example {@lang xml}\r\n         * <p data-win-bind=\"innerText : someLongText WinJSContrib.Bindings.ellipsisize\" data-win-bind-args='{ \"ellipsisize\" : 50}'></p>\r\n         */\r\n        WinJSContrib.Bindings.ellipsisize = WinJS.Binding.initializer(function toEllipsisizedBinding(source, sourceProperty, dest, destProperty) {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var size = bindingArguments(dest, 'ellipsisize');\r\n            dest[destProperty] = toStaticHTML(WinJSContrib.Utils.ellipsisizeString(sourcedata, size, true));\r\n        });\r\n        WinJSContrib.Bindings.toEllipsisized = WinJSContrib.Bindings.ellipsisize; //deprecated name\r\n\r\n        WinJSContrib.Bindings.emptyIfNull = WinJS.Binding.initializer(function emptyIfNull(source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (typeof data === \"undefined\" || data === null) {\r\n                dest[destProperty] = \"\";\r\n            } else {\r\n                dest[destProperty] = data;\r\n            }\r\n        });\r\n\r\n\r\n        /**\r\n         * Two way binding triggered by \"change\" event on inputs\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.twoWayOnChange = WinJS.Binding.initializer(function twoWayOnChangeBinding(source, sourceProperty, dest, destProperty) {\r\n            function setVal() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                WinJSContrib.Utils.writeProperty(dest, destProperty, data || '');\r\n            }\r\n\r\n            function getVal() {\r\n                var val = WinJSContrib.Utils.getProperty(dest, destProperty);\r\n                WinJSContrib.Utils.writeProperty(source, sourceProperty, val.propValue);\r\n            }\r\n\r\n            dest.addEventListener('change', getVal, false);\r\n            if (!dest.winControl) {\r\n                dest.classList.add('win-disposable');\r\n                dest.winControl = {\r\n                    dispose: function () {\r\n                        dest.removeEventListener('change', getVal);\r\n                    }\r\n                };\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n\r\n            bindingDesc[sourceProperty] = setVal;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /** \r\n         * cleans up a binding list by returning its items as non-observable \r\n         * @function \r\n         * @param {Object[]} bindingList binding list to clean up \r\n         * @returns {Object[]} array containing the cleaned up items \r\n         */\r\n        Bindings.cleanUpBindingList = function (bindingList) {\r\n            var result = [];\r\n\r\n            bindingList.forEach(function (item) {\r\n                var unwrappedItem = WinJS.Binding.unwrap(item);\r\n                result.push(unwrappedItem);\r\n            });\r\n\r\n            return result;\r\n        };\r\n\r\n\r\n    })(WinJSContrib.Bindings || (WinJSContrib.Bindings = {}));\r\n    var Bindings = WinJSContrib.Bindings;\r\n})(WinJSContrib || (WinJSContrib = {}));\r\n","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"WinJSContrib.binding.utils.js\" />\r\n/// <reference path=\"moment.min.js\" />\r\n\r\nvar WinJSContrib;\r\nWinJSContrib.Utils = WinJSContrib.Utils || {};\r\nWinJSContrib.Bindings = WinJSContrib.Bindings || {};\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    /** \r\n     * format date using binding argument 'formatDate'\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.formatDate = WinJS.Utilities.markSupportedForProcessing(function formatDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                var arg = WinJSContrib.Bindings.bindingArguments(dest, 'formatDate') || 'L';\r\n                dest.innerText = moment(sourcedata).format(arg);\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    /** \r\n     * format date using calendar function\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.calendar = WinJS.Utilities.markSupportedForProcessing(function formatDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                dest.innerText = moment(sourcedata).calendar();\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    function daysSince(m, d, y) {\r\n        if (d == '' || m == '' || y == '') {\r\n            //alert(\"All fields must be entered\");\r\n            return;\r\n        }\r\n\r\n        if (isNaN(m) || isNaN(y) || isNaN(d)) {\r\n            //alert(\"Only numbers .\");\r\n            return;\r\n        }\r\n\r\n        var myDate = new Date();\r\n        var yourDate = new Date(y, m - 1, d);\r\n\r\n        var secondsInADay = 1000 * 60 * 60 * 24;\r\n        var diff = Math.floor((myDate.getTime() - yourDate.getTime()) / secondsInADay);\r\n        return diff;\r\n    }\r\n\r\n\r\n    /**\r\n     * display number of days since a date\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.daysSinceDate = WinJS.Utilities.markSupportedForProcessing(function daysSinceDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                sourcedata = new Date(sourcedata);\r\n                var m = sourcedata.getMonth() + 1, d = sourcedata.getDate(), y = sourcedata.getFullYear();\r\n                var fromdate = daysSince(m, d, y);\r\n                dest.innerText = fromdate;\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    /**\r\n     * apply moment.js humanize formatting on a date. Use 'humanizeFormat' and 'addSuffix' arguments to configure binding\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.humanizeDate = WinJS.Utilities.markSupportedForProcessing(function humanizeDate(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                var arg = WinJSContrib.Bindings.bindingArguments(dest, \"humanizeFormat\"),\r\n                    addSuffix = WinJSContrib.Bindings.bindingArguments(dest, \"addSuffix\");\r\n                dest.innerText = moment.duration(sourcedata, arg).humanize(addSuffix);\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"WinJSContrib.core.js\" />\r\n\r\n(function () {\r\n    \"use strict\";\r\n\r\n    var appView = null;\r\n    if (window.Windows && window.Windows.UI && window.Windows.UI.ViewManagement && window.Windows.UI.ViewManagement.ApplicationView)\r\n        appView = window.Windows.UI.ViewManagement.ApplicationView;\r\n\r\n    var nav = WinJS.Navigation;\r\n\r\n    var defaultExitPageAnimation = function (elt) {\r\n        return WinJS.UI.Animation.exitPage(elt)\r\n    }\r\n\r\n    var defaultEnterPageAnimation = function (elt) {\r\n        return WinJS.UI.Animation.enterPage(elt);\r\n    }\r\n\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        parentNavigator: function (element) {\r\n            var current = element.parentNode;\r\n\r\n            while (current) {\r\n                if (current.mcnNavigator) {\r\n                    return current.winControl;\r\n                }\r\n                current = current.parentNode;\r\n            }\r\n        },\r\n\r\n        PageControlNavigator: WinJS.Class.mix(WinJS.Class.define(\r\n            /**\r\n             * @class WinJSContrib.UI.PageControlNavigator\r\n             * @param {HTMLElement} element DOM element containing the control\r\n             * @param {Object} options\r\n             */\r\n            function PageControlNavigator(element, options) {\r\n                var options = options || {};\r\n                var navigator = this;\r\n                this.element = element || document.createElement(\"div\");\r\n                this.element.winControl = this;\r\n                this.element.mcnNavigator = true;\r\n                this.element.classList.add('mcn-navigator');\r\n                this.element.classList.add('mcn-navigation-ctrl');\r\n                this.eventTracker = new WinJSContrib.UI.EventTracker();\r\n                this.delay = options.delay || 0;\r\n                this.disableHistory = options.disableHistory || false;\r\n                this.animationWaitForPreviousPageClose = options.animationWaitForPreviousPageClose || true;\r\n                this.animations = {};\r\n                this.locks = 0;\r\n\r\n                if (options.enterPageAnimation) {\r\n                    this.animations.enterPage = WinJSContrib.Utils.resolveMethod(element, options.enterPageAnimation);\r\n                }\r\n                if (!this.animations.enterPage)\r\n                    this.animations.enterPage = defaultEnterPageAnimation;\r\n\r\n                if (options.exitPageAnimation) {\r\n                    this.animations.exitPage = WinJSContrib.Utils.resolveMethod(element, options.exitPageAnimation);\r\n                }\r\n                if (!this.animations.exitPage)\r\n                    this.animations.exitPage = defaultExitPageAnimation;\r\n                this.home = options.home;\r\n                if (appView)\r\n                    this._lastViewstate = appView.value;\r\n\r\n                this.global = options.global !== undefined ? options.global : true;\r\n                if (this.global) { //navigation classique \r\n                    document.body.onkeyup = this._keyupHandler.bind(this);\r\n                    document.body.onkeypress = this._keypressHandler.bind(this);\r\n                    document.body.onmspointerup = this._mspointerupHandler.bind(this);\r\n\r\n                    WinJSContrib.UI.Application = WinJSContrib.UI.Application || {};\r\n                    WinJSContrib.UI.Application.navigator = this;\r\n\r\n                    this.eventTracker.addEvent(nav, 'beforenavigate', this._beforeNavigate.bind(this));\r\n                    this.eventTracker.addEvent(nav, 'navigated', this._navigated.bind(this));\r\n\r\n                    var systemNavigationManager = null;\r\n                    if (WinJSContrib.UI.enableSystemBackButton && window.Windows && window.Windows.UI && window.Windows.UI.Core && window.Windows.UI.Core.SystemNavigationManager) {\r\n                        systemNavigationManager = window.Windows.UI.Core.SystemNavigationManager.getForCurrentView();\r\n                    }\r\n\r\n                    if (systemNavigationManager && WinJSContrib.UI.enableSystemBackButton) {\r\n                        this.eventTracker.addEvent(systemNavigationManager, 'backrequested', function (arg) {\r\n                            if (WinJS.Navigation.canGoBack) {\r\n                                WinJS.Navigation.back();\r\n                                arg.handled = true;\r\n                            }\r\n                        });\r\n\r\n                    }\r\n                }\r\n                else {\r\n                    if (options.navigationEvents) {\r\n                        this.addNavigationEvents();\r\n                    }\r\n                    this._history = { backstack: [] };\r\n                }\r\n\r\n                this.eventTracker.addEvent(window, 'resize', function (args) {\r\n                    if (navigator.resizeHandler)\r\n                        cancelAnimationFrame(navigator.resizeHandler);\r\n\r\n                    navigator.resizeHandler = requestAnimationFrame(function () {\r\n                        navigator.resizeHandler = null;\r\n                        navigator._resized(args);\r\n                    });\r\n                });\r\n            },\r\n                /**\r\n                 * @lends WinJSContrib.UI.PageControlNavigator.prototype\r\n                 */\r\n                {\r\n                    home: \"\",\r\n                    /// <field domElement=\"true\" />\r\n                    element: null,\r\n                    _lastNavigationPromise: WinJS.Promise.as(),\r\n                    _lastViewstate: 0,\r\n\r\n                    // This is the currently loaded Page object.\r\n                    pageControl: {\r\n                        get: function () {\r\n                            return this.pageElement ? this.pageElement.winControl : null;\r\n                        }\r\n                    },\r\n\r\n                    // This is the root element of the current page.\r\n                    pageElement: {\r\n                        get: function () {\r\n                            return this._pageElement || this.element.lastElementChild;\r\n                        }\r\n                    },\r\n\r\n                    history: {\r\n                        get: function () {\r\n                            if (this.global)\r\n                                return WinJS.Navigation.history;\r\n                            else\r\n                                return this._history;\r\n                        }\r\n                    },\r\n\r\n                    addLock: function () {\r\n                        this.locks++;\r\n                    },\r\n\r\n                    removeLock: function () {\r\n                        this.locks--;\r\n                    },\r\n\r\n                    // Creates a container for a new page to be loaded into.\r\n                    _createPageElement: function () {\r\n                        var element = document.createElement(\"div\");\r\n                        element.setAttribute(\"dir\", window.getComputedStyle(this.element, null).direction);\r\n                        //element.style.width = \"100%\";\r\n                        //element.style.height = \"100%\";\r\n                        //element.style.position = 'relative';\r\n                        return element;\r\n                    },\r\n\r\n                    // This function disposes the page navigator and its contents.\r\n                    dispose: function () {\r\n                        if (this._disposed) {\r\n                            return;\r\n                        }\r\n                        this._disposed = true;\r\n                        this.removeNavigationEvents();\r\n                        if (WinJS.Utilities.disposeSubTree)\r\n                            WinJS.Utilities.disposeSubTree(this.element);\r\n\r\n                        this.eventTracker.dispose();\r\n                    },\r\n\r\n                    //check back navigation in the context of navigation events.\r\n                    _checkBackNavigation: function (arg) {\r\n                        var navigator = this;\r\n                        var currentPage = navigator.pageControl;\r\n                        var confirm = function () {\r\n                            arg.handled = true;\r\n                            if (arg.preventDefault)\r\n                                arg.preventDefault();\r\n                        }\r\n                        var check = function () {\r\n                            if (navigator.canGoBack) {\r\n                                navigator.back();\r\n                                confirm();\r\n                                return true;\r\n                            };\r\n                        }\r\n\r\n                        if (currentPage.canClose) {\r\n                            var res = currentPage.canClose();\r\n                            if (WinJS.Promise.is(res)) {\r\n                                res.then(function (canClose) {\r\n                                    if (!canClose) {\r\n                                        confirm();\r\n                                        return true;\r\n                                    }\r\n                                    return check();\r\n                                });\r\n                            } else {\r\n                                if (!res) {\r\n                                    confirm();\r\n                                    return true;\r\n                                }\r\n                                return check();\r\n                            }\r\n\r\n                        } else {\r\n                            return check();\r\n                        }\r\n                    },\r\n\r\n                    //register hardware backbutton. unecessary if navigator is global\r\n                    addNavigationEvents: function () {\r\n                        var navigator = this;\r\n                        this.navigationEvents = WinJSContrib.UI.registerNavigationEvents(this, function (arg) {\r\n                            navigator._checkBackNavigation(arg);\r\n                        });\r\n                    },\r\n\r\n                    removeNavigationEvents: function () {\r\n                        if (this.navigationEvents) {\r\n                            this.navigationEvents();\r\n                            this.navigationEvents = null;\r\n                        }\r\n                    },\r\n\r\n                    // Retrieves a list of animation elements for the current page.\r\n                    // If the page does not define a list, animate the entire page.\r\n                    _getAnimationElements: function (isExit) {\r\n                        if (this.pageControl && this.pageControl.getAnimationElements) {\r\n                            return this.pageControl.getAnimationElements(isExit);\r\n                        }\r\n                        return this.pageElement;\r\n                    },\r\n\r\n                    // Navigates back whenever the backspace key is pressed and\r\n                    // not captured by an input field.\r\n                    _keypressHandler: function (args) {\r\n                        if (this.locks > 0)\r\n                            return;\r\n\r\n                        if (args.key === \"Backspace\") {\r\n                            this.back();\r\n                        }\r\n                    },\r\n\r\n                    // Navigates back or forward when alt + left or alt + right\r\n                    // key combinations are pressed.\r\n                    _keyupHandler: function (args) {\r\n                        if (this.locks > 0)\r\n                            return;\r\n\r\n                        if ((args.key === \"Left\" && args.altKey) || (args.key === \"BrowserBack\")) {\r\n                            this.back();\r\n                        }/* else if ((args.key === \"Right\" && args.altKey) || (args.key === \"BrowserForward\")) {\r\n            \t\t\tnav.forward();\r\n            \t\t}*/\r\n                    },\r\n\r\n                    // This function responds to clicks to enable navigation using\r\n                    // back and forward mouse buttons.\r\n                    _mspointerupHandler: function (args) {\r\n                        if (args.button === 3) {\r\n                            nav.back();\r\n                        } else if (args.button === 4) {\r\n                            nav.forward();\r\n                        }\r\n                    },\r\n\r\n                    navigate: function (location, initialState, skipHistory, isback) {\r\n                        var nav = this;\r\n                        if (this.global) {\r\n                            return WinJS.Navigation.navigate(location, initialState);\r\n                        } else {\r\n                            var arg = {\r\n                                skipHistory: skipHistory,\r\n                                detail: {\r\n                                    location: location,\r\n                                    state: initialState,\r\n                                    setPromise: function (promise) {\r\n                                        this.pagePromise = promise;\r\n                                    }\r\n                                }\r\n                            };\r\n                            nav._beforeNavigate(arg);\r\n                            arg.detail.pagePromise = arg.detail.pagePromise || WinJS.Promise.wrap();\r\n                            nav._history.current = { state: initialState, location: location };\r\n                            return arg.detail.pagePromise.then(function () {\r\n                                if (isback) {\r\n                                    nav._history.backstack.splice(nav._history.backstack.length - 1, 1);\r\n                                }\r\n                                nav._navigated(arg);\r\n                                return arg.detail.pagePromise;\r\n                            });\r\n                        }\r\n                    },\r\n\r\n                    clearHistory: function () {\r\n                        if (this.global) {\r\n                            WinJS.Navigation.history.backStack = [];\r\n                        } else {\r\n                            this._history.backstack = [];\r\n                            this._history.current = null;\r\n                        }\r\n                    },\r\n\r\n                    closeAllPages: function () {\r\n                        var navigator = this;\r\n                        var pages = navigator.element.querySelectorAll('.pagecontrol');\r\n                        for (var i = 0, l = pages.length ; i < l ; i++) {\r\n                            var page = pages[i];\r\n                            if (page.parentElement == navigator.element) {\r\n                                page.winControl.dispose();\r\n                                navigator.element.removeChild(page);\r\n                            }\r\n                        }\r\n                    },\r\n\r\n                    clear: function () {\r\n                        this.clearHistory();\r\n                        this.closeAllPages();\r\n                        this._pageElement = null;\r\n                        this.element.innerHTML = '';\r\n                    },\r\n\r\n                    //warning, deprecated...\r\n                    open: function (uri, options) {\r\n                        return this.navigate(uri, options);\r\n                    },\r\n\r\n                    pick: function (uri, options) {\r\n                        options = options || {};\r\n                        options.navigateStacked = true;\r\n                        return this.navigate(uri, options);\r\n                    },\r\n\r\n                    canGoBack: {\r\n                        get: function () {\r\n                            if (this.global)\r\n                                return nav.canGoBack;\r\n                            else\r\n                                return this._history.backstack.length > 0;\r\n                        }\r\n                    },\r\n\r\n                    back: function (distance) {\r\n                        var navigator = this;\r\n                        if (navigator.global) {\r\n                            return WinJS.Navigation.back(distance);\r\n                        }\r\n                        else {\r\n                            if (navigator._history.backstack.length) {\r\n                                var pageindex = navigator._history.backstack.length - 1;\r\n                                var previousPage = navigator._history.backstack[pageindex];\r\n\r\n                                return navigator.navigate(previousPage.location, previousPage.state, true, true);\r\n                            }\r\n                        }\r\n                    },\r\n\r\n                    _beforeNavigate: function (args) {\r\n                        var navigator = this;\r\n                        var page = this.pageElement;\r\n                        args.detail.state = args.detail.state || {};\r\n                        var openStacked = navigator.stackNavigation == true || args.detail.state.navigateStacked;\r\n\r\n                        if (this.locks > 0) {\r\n                            var p = new WinJS.Promise(function (c) { });\r\n                            args.detail.setPromise(p);\r\n                            p.cancel();\r\n                            return;\r\n                        }\r\n                        else if (page && page.winControl && !openStacked && page.winControl.canClose) {\r\n                            var completeCallback = null;\r\n                            var p = new WinJS.Promise(function (c) {\r\n                                completeCallback = c;\r\n                            });\r\n                            setImmediate(function () {\r\n                                WinJS.Promise.wrap(page.winControl.canClose()).then(function (res) {\r\n                                    if (!res) {\r\n                                        p.cancel();\r\n                                    }\r\n                                    else {\r\n                                        navigator.triggerPageExit(openStacked);\r\n                                        completeCallback();\r\n                                    }\r\n                                });\r\n                            });\r\n                            args.detail.setPromise(p);\r\n\r\n                            return;\r\n                        }\r\n\r\n                        if (openStacked && !args.detail.state.mcnNavigationDetails)\r\n                            return;\r\n\r\n                        navigator.triggerPageExit();\r\n                    },\r\n\r\n                    triggerPageExit: function (openStacked) {\r\n                        var navigator = this;\r\n                        var page = this.pageElement;\r\n                        if (openStacked) {\r\n                            page.winControl.exitPagePromise = WinJS.Promise.wrap();\r\n                            return;\r\n                        }\r\n                        var hidepage = function () {\r\n                            if (!openStacked) {\r\n                                page.style.display = 'none';\r\n                                page.style.visibility = 'hidden';\r\n                                page.style.opacity = '';\r\n                            }\r\n                        }\r\n                        if (page && page.winControl && !page.winControl.exitPagePromise) {\r\n                            if (page.winControl.exitPage) {\r\n                                var exitPageResult = page.winControl.exitPage();\r\n                                if (exitPageResult) {\r\n                                    var res = WinJS.Promise.as(exitPageResult);\r\n                                    page.winControl.exitPagePromise = res.then(function () {\r\n                                        if (page.winControl.exitPageAnimation) {\r\n                                            return WinJS.Promise.as(page.winControl.exitPageAnimation());\r\n                                        }\r\n                                    }).then(hidepage);\r\n                                } else {\r\n                                    if (page.winControl.exitPageAnimation) {\r\n                                        page.winControl.exitPagePromise = WinJS.Promise.as(page.winControl.exitPageAnimation()).then(hidepage);\r\n                                    } else {\r\n                                        page.winControl.exitPagePromise = WinJS.Promise.as(navigator.animations.exitPage(navigator._getAnimationElements(true))).then(hidepage);\r\n                                    }\r\n                                }\r\n                            } else {\r\n                                if (page.winControl.exitPageAnimation) {\r\n                                    page.winControl.exitPagePromise = WinJS.Promise.as(page.winControl.exitPageAnimation()).then(hidepage);\r\n                                } else {\r\n                                    page.winControl.exitPagePromise = WinJS.Promise.as(navigator.animations.exitPage(navigator._getAnimationElements(true))).then(hidepage);\r\n                                }\r\n                            }\r\n\r\n                            var layoutCtrls = page.querySelectorAll('.mcn-layout-ctrl');\r\n                            if (layoutCtrls && layoutCtrls.length) {\r\n                                for (var i = 0 ; i < layoutCtrls.length; i++) {\r\n                                    var ctrl = layoutCtrls[i].winControl;\r\n                                    if (ctrl.exitPage)\r\n                                        ctrl.exitPage();\r\n                                }\r\n                            }\r\n\r\n                            if (WinJSContrib.UI.Application.progress)\r\n                                WinJSContrib.UI.Application.progress.show();\r\n                        }\r\n                    },\r\n\r\n                    closePage: function (pageElementToClose, args) {\r\n                        var navigator = this;\r\n                        args = args || {};\r\n                        var pagecontainer = navigator.element;\r\n                        var oldElement = pageElementToClose || this.pageElement;\r\n                        if (oldElement) {\r\n                            WinJSContrib.UI.untapAll(oldElement);\r\n                        }\r\n                        var oldPageExitPromise = (oldElement && oldElement.winControl && oldElement.winControl.exitPagePromise) ? oldElement.winControl.exitPagePromise : WinJS.Promise.wrap()\r\n                        navigator.dispatchEvent('closingPage', { page: oldElement });\r\n\r\n                        if (oldElement && oldElement.winControl) {\r\n                            oldElement.winControl.pageLifeCycle.stop();\r\n                            oldElement.winControl.dispatchEvent('closing', { youpla: 'boom' });\r\n\r\n                            if (oldElement.winControl.cancelPromises) {\r\n                                oldElement.winControl.cancelPromises();\r\n                            }\r\n                        }\r\n\r\n                        if (!navigator.global && !navigator.disableHistory && oldElement && oldElement.winControl && oldElement.winControl.navigationState && !args.skipHistory) {\r\n                            navigator._history.backstack.push(oldElement.winControl.navigationState);\r\n                        }\r\n\r\n                        navigator._pageElement = null;\r\n                        return oldPageExitPromise.then(function () {\r\n                            if (oldElement) {\r\n                                oldElement.style.opacity = '0';\r\n                                oldElement.style.display = 'none';\r\n                                //    }\r\n                                //    return WinJS.Promise.timeout();\r\n                                //}).then(function () {\r\n                                //    if (oldElement) {\r\n                                if (oldElement.winControl) {\r\n                                    oldElement.winControl.stackedOn = null;\r\n                                    oldElement.winControl.stackedBy = null;\r\n                                    if (oldElement.winControl.eventTracker) {\r\n                                        oldElement.winControl.eventTracker.dispose();\r\n                                    }\r\n\r\n                                    if (oldElement.winControl.unload) {\r\n                                        oldElement.winControl.unload();\r\n                                    }\r\n                                }\r\n\r\n                                if (WinJS.Utilities.disposeSubTree)\r\n                                    WinJS.Utilities.disposeSubTree(oldElement);\r\n\r\n                                //oldElement.innerHTML = '';\r\n                                //setImmediate(function () {\r\n                                try {\r\n                                    oldElement.parentElement.removeChild(oldElement);\r\n                                }\r\n                                catch (exception) {\r\n                                    console.log('cannot remove page, WTF ????????')\r\n                                }\r\n                                //});\r\n                            }\r\n                        });\r\n                    },\r\n\r\n                    // Responds to navigation by adding new pages to the DOM.\r\n                    _navigated: function (args) {\r\n                        var navigator = this;\r\n                        var systemNavigationManager = null;\r\n                        if (WinJSContrib.UI.enableSystemBackButton && window.Windows && window.Windows.UI && window.Windows.UI.Core && window.Windows.UI.Core.SystemNavigationManager) {\r\n                            systemNavigationManager = window.Windows.UI.Core.SystemNavigationManager.getForCurrentView();\r\n                        }\r\n                        if (navigator.global && systemNavigationManager && WinJSContrib.UI.enableSystemBackButton) {\r\n                            if (!WinJS.Navigation.canGoBack)\r\n                                systemNavigationManager.appViewBackButtonVisibility = window.Windows.UI.Core.AppViewBackButtonVisibility.collapsed;\r\n                            else\r\n                                systemNavigationManager.appViewBackButtonVisibility = window.Windows.UI.Core.AppViewBackButtonVisibility.visible;\r\n                        }\r\n\r\n                        args.detail.state = args.detail.state || {};\r\n                        var pagecontainer = navigator.element;\r\n                        var oldPage = this.pageControl;\r\n                        var oldElement = this.pageElement;\r\n                        var openStacked = navigator.stackNavigation == true || (args.detail.state && args.detail.state.navigateStacked);\r\n\r\n                        if (this._lastNavigationPromise) {\r\n                            this._lastNavigationPromise.cancel();\r\n\r\n                            if (WinJSContrib.UI.Application.progress)\r\n                                WinJSContrib.UI.Application.progress.hide();\r\n                        }\r\n\r\n                        if (oldPage && oldPage.stackedOn && args.detail.state.mcnNavigationDetails) {//back en nav stacked\r\n                            var closeOldPagePromise = navigator.closePage(oldElement, args);\r\n                            this._lastNavigationPromise = closeOldPagePromise;\r\n                            args.detail.setPromise(closeOldPagePromise);\r\n                            if (WinJSContrib.UI.Application.progress)\r\n                                WinJSContrib.UI.Application.progress.hide();\r\n                            return;\r\n                        }\r\n                        else if (openStacked) {\r\n                            if (!navigator.global && !navigator.disableHistory && oldElement && oldElement.winControl && oldElement.winControl.navigationState && !args.skipHistory) {\r\n                                navigator._history.backstack.push(oldElement.winControl.navigationState);\r\n                            }\r\n                            var closeOldPagePromise = WinJS.Promise.wrap();\r\n                        }\r\n                        else {\r\n                            var closeOldPagePromise = navigator.closePage(oldElement, args);\r\n                        }\r\n                        //if (this._handleSystemBackBtn && Windows && Windows.UI && Windows.UI.Core && Windows.UI.Core.SystemNavigationManager) {\r\n                        //    if (navigator.canGoBack)\r\n                        //        Windows.UI.Core.SystemNavigationManager.getForCurrentView().appViewBackButtonVisibility = Windows.UI.Core.AppViewBackButtonVisibility.visible;\r\n                        //    else\r\n                        //        Windows.UI.Core.SystemNavigationManager.getForCurrentView().appViewBackButtonVisibility = Windows.UI.Core.AppViewBackButtonVisibility.collapsed;\r\n                        //}\r\n                        args.detail.state.mcnNavigationDetails = {\r\n                            id: WinJSContrib.Utils.guid(),\r\n                            date: new Date()\r\n                        };\r\n\r\n                        //var newElement = null; //this._createPageElement();\r\n                        //var newElementCtrl = null;\r\n                        var parentedComplete;\r\n                        var parented = new WinJS.Promise(function (c) { parentedComplete = c; });\r\n                        //newElement.style.opacity = '0';\r\n                        var layoutCtrls = [];\r\n\r\n\r\n                        //if (navigator.animationWaitForPreviousPageClose) {\r\n                        //    var tempo = closeOldPagePromise.then(function () {\r\n                        //        return WinJS.Promise.timeout(navigator.delay);\r\n                        //    });\r\n                        //} else {\r\n                        //    var tempo = WinJS.Promise.timeout(navigator.delay);\r\n                        //}\r\n\r\n                        navigator.currentPageDetails = args.detail;\r\n\r\n                        var openNewPagePromise = WinJSContrib.UI.Pages.renderFragment(pagecontainer, args.detail.location, args.detail.state, {\r\n                            //delay: tempo,\r\n                            enterPage: navigator.animations.enterPage,\r\n\r\n                            //parented: closeOldPagePromise.then(function () {\r\n                            //\treturn parented;\r\n                            //}),\r\n\r\n                            closeOldPagePromise: closeOldPagePromise.then(function () { }, function () { }),\r\n\r\n                            oninit: function (element, options) {\r\n                                if (!element) return;\r\n                                var control = element.winControl;\r\n                                control.navigator = navigator;\r\n                                control.element.mcnPage = true;\r\n                                if (openStacked) {\r\n                                    control.stackedOn = oldPage;\r\n                                    if (oldPage) {\r\n                                        oldPage.stackedBy = control;\r\n                                    }\r\n                                }\r\n                                control.renderComplete = control.renderComplete.then(function () {\r\n                                    parentedComplete();\r\n                                });\r\n                            },\r\n\r\n                            onrender: function (element, options) {\r\n                                if (args.detail.state && args.detail.state.clearNavigationHistory) {\r\n                                    if (navigator.global) {\r\n                                        WinJS.Navigation.history.backStack = [];\r\n                                    } else {\r\n                                        navigator._history.backstack = [];\r\n                                    }\r\n                                }\r\n                                navigator._updateBackButton(element);\r\n                            },\r\n\r\n                            onready: function (element, options) {\r\n                                navigator.dispatchEvent('pageContentReady', { page: element.winControl });\r\n                                if (WinJSContrib.UI.Application.progress)\r\n                                    WinJSContrib.UI.Application.progress.hide();\r\n                            }\r\n                        }).then(function () {\r\n                            navigator._lastNavigationPromise = undefined;\r\n                        });\r\n\r\n                        this._lastNavigationPromise = openNewPagePromise;\r\n\r\n\r\n                        args.detail.setPromise(WinJS.Promise.join([closeOldPagePromise, openNewPagePromise]));\r\n                    },\r\n\r\n                    // Responds to resize events and call the updateLayout function\r\n                    // on the currently loaded page.\r\n                    _resized: function (args) {\r\n                        var navigator = this;\r\n                        if (this.pageControl && this.pageControl.element) {\r\n                            var navigator = this;\r\n                            var control = this.pageControl;\r\n                            var element = control.element;\r\n\r\n                            //navigator.pageControl.element.opacity = '0';\r\n                            cancelAnimationFrame(navigator.layoutProcess);\r\n                            navigator.layoutProcess = requestAnimationFrame(function () {\r\n                                var vw = appView ? appView.value : null;\r\n                                if (control.__checkLayout) {\r\n                                    control.__checkLayout(element, vw, navigator._lastViewstate);\r\n                                }\r\n                                else {\r\n                                    if (control.updateLayout) {\r\n                                        control.updateLayout.call(control, element, vw, navigator._lastViewstate);\r\n                                    }\r\n                                    var layoutCtrls = element.element.querySelectorAll('.mcn-layout-ctrl');\r\n                                    if (layoutCtrls && layoutCtrls.length) {\r\n                                        for (var i = 0 ; i < layoutCtrls.length; i++) {\r\n                                            var ctrl = layoutCtrls[i].winControl;\r\n                                            if (ctrl.updateLayout)\r\n                                                ctrl.updateLayout(ctrl.element, vw, navigator._lastViewstate);\r\n                                        }\r\n                                    }\r\n                                }\r\n                                //WinJS.UI.Animation.fadeIn(navigator.pageControl.element);\r\n                            });\r\n                        }\r\n                        this._lastViewstate = appView ? appView.value : null;\r\n                    },\r\n\r\n                    _handleBack: function () {\r\n                        nav.back();\r\n                    },\r\n\r\n                    // Updates the back button state. Called after navigation has\r\n                    // completed.\r\n                    _updateBackButton: function (element) {\r\n                        var ctrl = this;\r\n                        var backButtons = element.querySelectorAll(\".win-backbutton, .back-button, .win-navigation-backbutton\");\r\n                        //var backButton = this.pageElement.querySelector(\"header[role=banner] .win-backbutton\");\r\n\r\n                        if (backButtons && backButtons.length > 0) {\r\n                            var clearNav = false;\r\n                            //console.log('nav:' + JSON.stringify(args.detail.state))\r\n                            //if (args && args.detail && args.detail.state && args.detail.state.clearNavigationHistory)\r\n                            //    clearNav = args.detail.state.clearNavigationHistory;\r\n\r\n                            for (var i = 0, l = backButtons.length; i < l ; i++) {\r\n                                var btn = backButtons[i];\r\n                                if (ctrl.canGoBack && !clearNav) {\r\n                                    btn.classList.remove('disabled');\r\n                                    btn.disabled = false;\r\n                                } else {\r\n                                    btn.classList.add('disabled');\r\n                                    btn.disabled = true;\r\n                                }\r\n\r\n                                btn.onclick = function (arg) {\r\n                                    if (ctrl.global) {\r\n                                        nav.back();\r\n                                    }\r\n                                    else {\r\n                                        var navigator = WinJSContrib.UI.parentNavigator(arg.currentTarget);\r\n                                        navigator.back();\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            ), WinJS.Utilities.eventMixin)\r\n    });\r\n\r\n    if (WinJSContrib.UI.WebComponents) {\r\n        WinJSContrib.UI.WebComponents.register('mcn-navigator', WinJSContrib.UI.PageControlNavigator, {\r\n            properties: ['global'],\r\n            map: {\r\n                \"ENTERPAGEANIMATION\": {\r\n                    attribute: \"enterPageAnimation\",\r\n                    property: \"animations.enterPage\",\r\n                    resolve: true\r\n                },\r\n                \"EXITPAGEANIMATION\": {\r\n                    attribute: \"exitPageAnimation\",\r\n                    property: \"animations.exitPage\",\r\n                    resolve: true\r\n                }\r\n            }\r\n        });\r\n    }\r\n})();\r\n","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/**\n * @namespace WinJSContrib.UI.Animation\n */\n/**\n */\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var UI;\n    (function (UI) {\n        var Animation;\n        (function (Animation) {\n            /**\n             * @enum\n             * @memberof WinJSContrib.UI.Animation\n             */\n            Animation.Easings = {\n                /**\n                 * Quad ease in\n                 */\n                easeInQuad: 'cubic-bezier(0.550, 0.085, 0.680, 0.530)',\n                /**\n                 * Cubic ease in\n                 */\n                easeInCubic: 'cubic-bezier(0.550, 0.055, 0.675, 0.190)',\n                /**\n                 * Quart ease in\n                 */\n                easeInQuart: 'cubic-bezier(0.895, 0.030, 0.685, 0.220)',\n                /**\n                 * Quint ease in\n                 */\n                easeInQuint: 'cubic-bezier(0.755, 0.050, 0.855, 0.060)',\n                /**\n                 * Sine ease in\n                 */\n                easeInSine: 'cubic-bezier(0.470, 0.000, 0.745, 0.715)',\n                /**\n                 * Expo ease in\n                 */\n                easeInExpo: 'cubic-bezier(0.950, 0.050, 0.795, 0.035)',\n                /**\n                 * Circ ease in\n                 */\n                easeInCirc: 'cubic-bezier(0.600, 0.040, 0.980, 0.335)',\n                /**\n                 * Back ease in\n                 */\n                easeInBack: 'cubic-bezier(0.600, -0.280, 0.735, 0.045)',\n                /**\n                 * Quad ease out\n                 */\n                easeOutQuad: 'cubic-bezier(0.250, 0.460, 0.450, 0.940)',\n                /**\n                 * Cubic ease out\n                 */\n                easeOutCubic: 'cubic-bezier(0.215, 0.610, 0.355, 1.000)',\n                /**\n                 * Quart ease out\n                 */\n                easeOutQuart: 'cubic-bezier(0.165, 0.840, 0.440, 1.000)',\n                /**\n                 * Quint ease out\n                 */\n                easeOutQuint: 'cubic-bezier(0.230, 1.000, 0.320, 1.000)',\n                /**\n                 * Sine ease out\n                 */\n                easeOutSine: 'cubic-bezier(0.390, 0.575, 0.565, 1.000)',\n                /**\n                 * Expo ease out\n                 */\n                easeOutExpo: 'cubic-bezier(0.190, 1.000, 0.220, 1.000)',\n                /**\n                 * Circ ease out\n                 */\n                easeOutCirc: 'cubic-bezier(0.075, 0.820, 0.165, 1.000)',\n                /**\n                 * Back ease out\n                 */\n                easeOutBack: 'cubic-bezier(0.175, 0.885, 0.320, 1.275)',\n                /**\n                 * Quad ease in-out\n                 */\n                easeInOutQuad: 'cubic-bezier(0.455, 0.030, 0.515, 0.955)',\n                /**\n                 * Cubic ease in-out\n                 */\n                easeInOutCubic: 'cubic-bezier(0.645, 0.045, 0.355, 1.000)',\n                /**\n                 * Quart ease in-out\n                 */\n                easeInOutQuart: 'cubic-bezier(0.770, 0.000, 0.175, 1.000)',\n                /**\n                 * Quint ease in-out\n                 */\n                easeInOutQuint: 'cubic-bezier(0.860, 0.000, 0.070, 1.000)',\n                /**\n                 * Sine ease in-out\n                 */\n                easeInOutSine: 'cubic-bezier(0.445, 0.050, 0.550, 0.950)',\n                /**\n                 * Expo ease in-out\n                 */\n                easeInOutExpo: 'cubic-bezier(1.000, 0.000, 0.000, 1.000)',\n                /**\n                 * Circ ease in-out\n                 */\n                easeInOutCirc: 'cubic-bezier(0.785, 0.135, 0.150, 0.860)',\n                /**\n                 * Back ease in-out\n                 */\n                easeInOutBack: 'cubic-bezier(0.680, -0.550, 0.265, 1.550)',\n            };\n            var equivalents = WinJS.Utilities._browserStyleEquivalents || { transform: { cssName: 'transform' } };\n            function getOpt(options) {\n                if (options && typeof options == 'number')\n                    return { duration: options };\n                else\n                    return options || {};\n            }\n            /**\n             * configurable fade out\n             * @function WinJSContrib.UI.Animation.fadeOut\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function fadeOut(elements, options) {\n                options = getOpt(options);\n                var args = {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 167,\n                    timing: options.easing || \"ease-in-out\",\n                    to: 0\n                };\n                return WinJS.UI.executeTransition(elements, args);\n            }\n            Animation.fadeOut = fadeOut;\n            /**\n             * configurable fade in\n             * @function WinJSContrib.UI.Animation.fadeIn\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function fadeIn(elements, options) {\n                options = getOpt(options);\n                return WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 167,\n                    timing: options.easing || \"ease-in-out\",\n                    to: 1\n                });\n            }\n            Animation.fadeIn = fadeIn;\n            function staggerDelay(initialDelay, extraDelay, delayFactor, delayCap) {\n                return function (i) {\n                    var ret = initialDelay;\n                    for (var j = 0; j < i; j++) {\n                        extraDelay *= delayFactor;\n                        ret += extraDelay;\n                    }\n                    if (delayCap) {\n                        ret = Math.min(ret, delayCap);\n                    }\n                    return ret;\n                };\n            }\n            /**\n             * configurable page exit effect\n             * @function WinJSContrib.UI.Animation.pageExit\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function pageExit(elements, options) {\n                options = getOpt(options);\n                var args = {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 160,\n                    timing: options.easing || \"ease-in\",\n                    to: 0\n                };\n                return WinJS.UI.executeTransition(elements, args);\n            }\n            Animation.pageExit = pageExit;\n            /**\n             * configurable page enter effect\n             * @function WinJSContrib.UI.Animation.enterPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterPage(elements, options) {\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 120, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var animationParams = {\n                    keyframe: 'WinJSContrib-EnterPage',\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 600,\n                    timing: options.easing || \"cubic-bezier(0.1, 0.9, 0.2, 1)\"\n                };\n                var promise1 = WinJS.UI.executeAnimation(elements, animationParams);\n                var args = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 600,\n                    timing: options.easing || \"ease-out\",\n                    to: 1\n                };\n                var promise2 = WinJS.UI.executeTransition(elements, args);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterPage = enterPage;\n            function slideAnim(element, keyframeName, isIn, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var duration = options.duration || isIn ? 250 : 150;\n                var delay = options.delay || 5;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var easing = WinJSContrib.UI.Animation.Easings.easeInQuad;\n                if (isIn)\n                    easing = WinJSContrib.UI.Animation.Easings.easeOutQuad;\n                var animationParams = {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: duration,\n                    timing: options.easing || easing\n                };\n                var promise1 = WinJS.UI.executeAnimation(element, animationParams);\n                var transitionParams = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: duration / 2,\n                    timing: easing,\n                    from: 0,\n                    to: 1\n                };\n                if (!isIn) {\n                    transitionParams.from = 1;\n                    transitionParams.to = 0;\n                    if (transitionParams.delay < duration / 2)\n                        transitionParams.delay = duration / 2;\n                }\n                var promise2 = WinJS.UI.executeTransition(element, transitionParams);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromBottom\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromBottom(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromBottom', true, options);\n            }\n            Animation.slideFromBottom = slideFromBottom;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromTop\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromTop(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromTop', true, options);\n            }\n            Animation.slideFromTop = slideFromTop;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromLeft\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromLeft(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromLeft', true, options);\n            }\n            Animation.slideFromLeft = slideFromLeft;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromRight\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromRight(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromRight', true, options);\n            }\n            Animation.slideFromRight = slideFromRight;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToBottom\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToBottom(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToBottom', false, options);\n            }\n            Animation.slideToBottom = slideToBottom;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToTop\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToTop(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToTop', false, options);\n            }\n            Animation.slideToTop = slideToTop;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToLeft\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToLeft(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToLeft', false, options);\n            }\n            Animation.slideToLeft = slideToLeft;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToRight\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToRight(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToRight', false, options);\n            }\n            Animation.slideToRight = slideToRight;\n            /**\n             * animation for tab exit\n             * @function WinJSContrib.UI.Animation.tabExitPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function tabExitPage(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var animationParams = {\n                    keyframe: \"WinJSContrib-tabExitPage\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 160,\n                    timing: \"ease-in\"\n                };\n                var promise1 = WinJS.UI.executeAnimation(elements, animationParams);\n                var transitionParams = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 160,\n                    timing: \"linear\",\n                    from: 1,\n                    to: 0\n                };\n                var promise2 = WinJS.UI.executeTransition(elements, transitionParams);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.tabExitPage = tabExitPage;\n            /**\n             * animation for tab exit\n             * @function WinJSContrib.UI.Animation.tabEnterPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function tabEnterPage(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: \"WinJSContrib-tabEnterPage\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 250,\n                    timing: WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 250,\n                    timing: \"ease-out\",\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.tabEnterPage = tabEnterPage;\n            /**\n             * exit and grow animation\n             * @function WinJSContrib.UI.Animation.exitGrow\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function exitGrow(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-exitGrow\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var dur = options.duration || 250;\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuint,\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.exitGrow = exitGrow;\n            /**\n             * exit and shrink animation\n             * @function WinJSContrib.UI.Animation.exitShrink\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function exitShrink(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-exitShrink\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 250;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 10, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: WinJSContrib.UI.Animation.Easings.easeInQuint,\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.exitShrink = exitShrink;\n            /**\n             * shrink and fall animation\n             * @function WinJSContrib.UI.Animation.shrinkAndFall\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function shrinkAndFall(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var dur = options.duration || 250;\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: \"WinJSContrib-shrinkAndFall\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || \"ease-in\"\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: \"ease-in\",\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.shrinkAndFall = shrinkAndFall;\n            /**\n             * enter and shrink animation\n             * @function WinJSContrib.UI.Animation.enterShrink\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterShrink(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-enterShrink\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 350;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuint,\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterShrink = enterShrink;\n            /**\n             * enter and shrink animation\n             * @function WinJSContrib.UI.Animation.enterGrow\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterGrow(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-enterGrow\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 350;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: WinJSContrib.UI.Animation.Easings.easeOutQuint,\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterGrow = enterGrow;\n        })(Animation = UI.Animation || (UI.Animation = {}));\n    })(UI = WinJSContrib.UI || (WinJSContrib.UI = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=../../Sources/Common/winjscontrib.ui.animation.js.map","/// <reference path=\"winjscontrib.core.js\" />\r\n/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n//this control requires snap.svg\r\n\r\n(function () {\r\n\t'use strict';\r\n\tvar elasticbuttonkinds = {\r\n\t\trectangle : {\r\n\t\t\tmorphpath: 'M286,113c0,0-68.8,6-136,6c-78.2,0-137-6-137-6S6,97.198,6,62.5C6,33.999,13,12,13,12s59-7,137-7c85,0,136,7,136,7s8,17.598,8,52C294,96.398,286,113,286,113z',\r\n\t\t\tsvg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 125\" preserveAspectRatio=\"none\"><path d=\"M286.5,113c0,0-104,0-136.5,0c-35.75,0-136.5,0-136.5,0s0-39.417,0-52.5c0-12.167,0-48.5,0-48.5s101.833,0,136.5,0c33.583,0,136.5,0,136.5,0s0,35.917,0,48.5C286.5,73.167,286.5,113,286.5,113z\"/></svg>'\r\n\t\t},\r\n\t\troundedrectangle : {\r\n\t\t    morphpath: 'M287,95.25c0,11.046-5.954,19.75-17,19.75c0,0-90-4-120-4s-120,4-120,4c-11.046,0-17.25-9.5-17.25-20.5c0-8.715,0.25-10.75,0.25-34s-0.681-26.257-1-33.75C11.5,15,18.954,10,30,10c0,0,90,3,120,3s120-3,120-3c11.046,0,17.75,6.5,17,20c-0.402,7.239,0,6.75,0,30.5C287,83.5,287,84.75,287,95.25z',\r\n\t\t    svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 125\" preserveAspectRatio=\"none\"><path d=\"M290,95c0,11.046-8.954,20-20,20c0,0-90,0-120,0s-120,0-120,0c-11.046,0-20-9-20-20c0-8.715,0-25.875,0-34.5c0-7.625,0-22.774,0-30.5c0-11.625,8.954-20,20-20c0,0,90,0,120,0s120,0,120,0c11.046,0,20,8.954,20,20c0,7.25,0,22.875,0,30.5C290,69.125,290,84.5,290,95z\"/></svg>'\r\n\t\t},\r\n\t\tround : {\r\n\t\t    morphpath: 'M251,150c0,93.5-29.203,143-101,143S49,243.5,49,150C49,52.5,78.203,7,150,7S251,51.5,251,150z',\r\n\t\t\tsvg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 300\" preserveAspectRatio=\"none\"><path d=\"M281,150c0,71.797-59.203,131-131,131S19,221.797,19,150S78.203,19,150,19S281,78.203,281,150z\"/></svg>'\r\n\t\t},\r\n\t};\r\n\r\n\tWinJS.Namespace.define(\"WinJSContrib.UI\", {\t\r\n\t\tElasticButton : WinJS.Class.mix(WinJS.Class.define(function ctor(element, options){\r\n\t\t    this.element = element || document.createElement('DIV');\r\n\t\t    options = options || {};\r\n\t\t\tthis.element.winControl = this;\r\n\t\t\tthis.behavior = {\r\n\t\t\t    speed: { reset: 800, active: 150 },\r\n\t\t\t    easing: { reset: mina.elastic, active: mina.easein }\r\n\t\t\t};\r\n\r\n\t\t\tthis.element.classList.add('mcn-elasticbutton');\r\n\t\t\tthis.element.classList.add('win-disposable');\r\n\t\t\tWinJS.UI.setOptions(this, options);\r\n\t\t},{\r\n\t\t\tkind: {\r\n\t\t\t\tget: function(){\r\n\t\t\t\t\treturn this._kind;\r\n\t\t\t\t},\r\n\t\t\t\tset: function(val){\r\n\t\t\t\t\tthis._kind = val;\r\n\t\t\t\t\tthis.render();\r\n\t\t\t\t}\r\n\t\t\t},\t\t\t\r\n\r\n\t\t\trender: function(){\r\n\t\t\t    var ctrl = this;\r\n\t\t\t    this.element.classList.add('mcn-elasticbutton-'+  ctrl.kind);\r\n\t\t\t    var contentCreated = false;\r\n\t\t\t    if (!ctrl.contentElement) {\r\n\t\t\t        ctrl.contentElement = document.createElement('DIV');\r\n\t\t\t        ctrl.contentElement.className = 'mcn-elasticbutton-content';\r\n\t\t\t        WinJSContrib.Utils.moveChilds(ctrl.element, ctrl.contentElement);\r\n\t\t\t        contentCreated = true;\r\n\t\t\t    }\r\n\r\n\t\t\t\tif (!ctrl.bgElement){\r\n\t\t\t\t\tctrl.bgElement = document.createElement('DIV');\r\n\t\t\t\t\tctrl.bgElement.className = 'mcn-elasticbutton-bg';\r\n\t\t\t\t\tctrl.element.appendChild(ctrl.bgElement);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (contentCreated) {\r\n\t\t\t\t    ctrl.element.appendChild(ctrl.contentElement);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!ctrl.contentElement){\r\n\t\t\t\t\tctrl.contentElement = document.createElement('DIV');\r\n\t\t\t\t\tctrl.contentElement.className = 'mcn-elasticbutton-content';\r\n\t\t\t\t\twhile (ctrl.element.children.length > 0) {\r\n\t\t\t\t\t    ctrl.contentElement.appendChild(ctrl.element.children[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tctrl.element.appendChild(ctrl.contentElement);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tctrl.currentKind = elasticbuttonkinds[this.kind];\r\n\t\t\t\tif (ctrl.currentKind){\r\n\t\t\t\t    ctrl.bgElement.innerHTML = ctrl.currentKind.svg;\r\n\t\t\t\t    ctrl.snap = Snap(ctrl.bgElement.querySelector('svg'));\r\n\t\t\t\t    ctrl.pathEl = ctrl.snap.select('path');\r\n\t\t\t\t    ctrl.paths = {\r\n\t\t\t\t        reset: ctrl.pathEl.attr('d'),\r\n\t\t\t\t        active: ctrl.currentKind.morphpath\r\n\t\t\t\t    };\r\n\t\t\t\t    if (ctrl.eventTracker)\r\n\t\t\t\t            ctrl.eventTracker.dispose();\r\n\t\t\t\t    ctrl.eventTracker = new WinJSContrib.UI.EventTracker();\r\n\t\t\t\t    ctrl.eventTracker.addEvent(ctrl.element, 'pointerdown', function (arg) { ctrl._ptdown(arg); });\r\n\t\t\t\t    ctrl.eventTracker.addEvent(ctrl.element, 'pointerup', function (arg) { ctrl._ptup(arg); })\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t_ptdown: function (arg) {\r\n\t\t\t    this.pathEl.stop().animate({ 'path': this.paths.active }, this.behavior.speed.active, this.behavior.easing.active);\r\n\t\t\t},\r\n\r\n\t\t\t_ptup: function (arg) {\r\n\t\t\t    this.pathEl.stop().animate({ 'path': this.paths.reset }, this.behavior.speed.reset, this.behavior.easing.reset);\r\n\t\t\t},\r\n\r\n\t\t\tdispose: function () {\r\n\t\t\t    if (this.eventTracker) this.eventTracker.dispose();\r\n\t\t\t    WinJS.Utilities.disposeSubTree(this.element);\r\n\t\t\t    this.element = null;\r\n\t\t\t}\r\n\t\t}),\r\n\t\tWinJS.Utilities.eventMixin,\r\n\t\tWinJS.Utilities.createEventProperties(\"myevent\"))\r\n\t});\r\n})();","/// <reference path=\"winjscontrib.core.js\" />\r\n\r\n//this controls requires snap.svg\r\n\r\n(function () {\r\n    'use strict';\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        FOWrapper: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.element.classList.add('win-disposable');\r\n            WinJS.UI.setOptions(this, options);\r\n            this.render();\r\n        }, {\r\n            someProperty: {\r\n                get: function () {\r\n                    return this._someProperty;\r\n                },\r\n                set: function (val) {\r\n                    this._someProperty = val;\r\n                }\r\n            },\r\n\r\n            render: function () {\r\n                var ctrl = this;\r\n                var body = document.createElement(\"BODY\");\r\n                WinJSContrib.Utils.moveChilds(ctrl.element, body);\r\n                ctrl.element.innerHTML = '<svg class=\"mcn-fowrapper\" xmlns=\"http://www.w3.org/2000/svg\" style=\"width:100%; height: 100%\">' +\r\n\t\t            '<defs>' +\r\n\t\t                '<filter id=\"blur\" x=\"0\" y=\"0\"><feGaussianBlur class=\"gblur\" in=\"SourceGraphic\" stdDeviation=\"0\" /></filter>' +\r\n\t   \t            '</defs>' +\r\n\t\t            '<foreignObject id=\"fowrapper\" width=\"100%\" height=\"100%\" requiredExtensions=\"http://www.w3.org/1999/xhtml\" filter=\"url(#blur)\">' +\r\n\t\t            '</foreignObject>' +\r\n\t            '</svg>';\r\n                var container = ctrl.element.querySelector(\"#fowrapper\");\r\n                ctrl.blurFilter = ctrl.element.querySelector(\".gblur\");\r\n                ctrl.sblurFilter = Snap(ctrl.blurFilter);\r\n                container.appendChild(body);\r\n            },\r\n\r\n            blurTo: function (blur, duration, easing) {\r\n                var ctrl = this;\r\n\r\n                ctrl.sblurFilter.stop();\r\n                if (!duration) {\r\n                    ctrl.blurFilter.setAttribute(\"stdDeviation\", blur);                    \r\n                    return;\r\n                }\r\n\r\n                ctrl.sblurFilter.animate({ stdDeviation: blur }, duration, easing || mina.easeout);\r\n            },\r\n\r\n            dispose: function () {\r\n                WinJS.Utilities.disposeSubTree(this.element);\r\n                this.element = null;\r\n            }\r\n        }),\r\n\t\tWinJS.Utilities.eventMixin,\r\n\t\tWinJS.Utilities.createEventProperties(\"myevent\"))\r\n    });\r\n})();"],"sourceRoot":" "}